<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vite & Gourmand â€” Traiteur Gastronomique Bordeaux</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,900;1,400;1,600&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --burgundy: #7B1C2A;
    --burgundy-dark: #5a1420;
    --burgundy-light: #9c2535;
    --gold: #C49A3C;
    --gold-light: #d4ae5a;
    --cream: #FAF6F0;
    --cream-dark: #F0E8DC;
    --charcoal: #1a1a1a;
    --text: #2d2d2d;
    --text-light: #6b6b6b;
    --white: #fff;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  html { scroll-behavior: smooth; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--cream);
    color: var(--text);
    overflow-x: hidden;
  }

  /* â”€â”€â”€ NAV â”€â”€â”€ */
  nav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
    background: rgba(250,246,240,0.96);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(196,154,60,0.2);
    padding: 0 2rem;
    display: flex; align-items: center; justify-content: space-between;
    height: 68px;
    transition: box-shadow .3s;
  }
  nav.scrolled { box-shadow: 0 4px 30px rgba(123,28,42,0.08); }

  .nav-brand {
    font-family: 'Playfair Display', serif;
    font-size: 1.3rem; font-weight: 700;
    color: var(--burgundy);
    letter-spacing: .03em;
    cursor: pointer;
    text-decoration: none;
  }
  .nav-brand span { color: var(--gold); }

  .nav-links { display: flex; align-items: center; gap: 2rem; list-style: none; }
  .nav-links a {
    font-size: .875rem; font-weight: 500; letter-spacing: .06em; text-transform: uppercase;
    color: var(--text); text-decoration: none;
    transition: color .2s;
  }
  .nav-links a:hover { color: var(--burgundy); }

  .nav-actions { display: flex; align-items: center; gap: 1rem; }

  .nav-action-link {
    font-size: .8rem; font-weight: 500; letter-spacing: .06em; text-transform: uppercase;
    color: var(--text); text-decoration: none;
    transition: color .2s;
    white-space: nowrap;
  }
  .nav-action-link:hover { color: var(--burgundy); }

  .btn-nav {
    padding: .5rem 1.2rem; border-radius: 2px;
    font-size: .8rem; font-weight: 500; letter-spacing: .08em; text-transform: uppercase;
    cursor: pointer; transition: all .2s; border: none;
  }
  .btn-outline {
    background: transparent;
    border: 1.5px solid var(--burgundy);
    color: var(--burgundy);
  }
  .btn-outline:hover { background: var(--burgundy); color: var(--white); }
  .btn-solid {
    background: var(--burgundy);
    color: var(--white);
  }
  .btn-solid:hover { background: var(--burgundy-dark); }

  .cart-btn {
    position: relative; background: var(--gold); border: none;
    width: 42px; height: 42px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: transform .2s, background .2s;
  }
  .cart-btn:hover { background: var(--gold-light); transform: scale(1.05); }
  .cart-btn svg { width: 18px; height: 18px; stroke: white; fill: none; }
  .cart-count {
    position: absolute; top: -4px; right: -4px;
    background: var(--burgundy); color: white;
    font-size: .65rem; font-weight: 700;
    width: 18px; height: 18px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    display: none;
  }

  /* â”€â”€â”€ HERO â”€â”€â”€ */
  #hero {
    min-height: 100vh;
    display: grid; grid-template-columns: 1fr 1fr;
    align-items: center;
    padding: 100px 5vw 60px;
    position: relative;
    overflow: hidden;
  }

  .hero-bg {
    position: absolute; inset: 0;
    background: linear-gradient(135deg, var(--cream) 0%, #f5ece0 40%, var(--cream-dark) 100%);
    z-index: 0;
  }

  .hero-ornament {
    position: absolute;
    width: 600px; height: 600px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(196,154,60,0.08) 0%, transparent 70%);
    top: -100px; right: -100px;
    z-index: 0;
  }

  .hero-content { position: relative; z-index: 1; padding-right: 3rem; }

  .hero-badge {
    display: inline-flex; align-items: center; gap: .5rem;
    background: rgba(123,28,42,0.06);
    border: 1px solid rgba(123,28,42,0.15);
    padding: .4rem 1rem; border-radius: 100px;
    font-size: .75rem; letter-spacing: .12em; text-transform: uppercase;
    color: var(--burgundy); margin-bottom: 1.5rem;
    animation: fadeUp .8s ease both;
  }
  .hero-badge::before {
    content: ''; width: 6px; height: 6px; border-radius: 50%;
    background: var(--gold); flex-shrink: 0;
  }

  .hero-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2.8rem, 5vw, 4.5rem);
    line-height: 1.1; font-weight: 900;
    color: var(--charcoal);
    animation: fadeUp .8s ease .1s both;
  }
  .hero-title em {
    font-style: italic; color: var(--burgundy);
    display: block;
  }

  .hero-sub {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.2rem; font-weight: 300;
    color: var(--text-light); margin: 1.5rem 0 2.5rem;
    line-height: 1.7;
    animation: fadeUp .8s ease .2s both;
  }

  .hero-ctas { display: flex; gap: 1rem; flex-wrap: wrap; animation: fadeUp .8s ease .3s both; }

  .btn-primary {
    padding: .9rem 2.2rem;
    background: var(--burgundy); color: white;
    border: none; border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .85rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    cursor: pointer; transition: all .25s;
    box-shadow: 0 8px 30px rgba(123,28,42,0.3);
  }
  .btn-primary:hover { background: var(--burgundy-dark); transform: translateY(-2px); box-shadow: 0 12px 40px rgba(123,28,42,0.4); }

  .btn-secondary {
    padding: .9rem 2.2rem;
    background: transparent; color: var(--text);
    border: 1.5px solid rgba(45,45,45,0.25); border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .85rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    cursor: pointer; transition: all .25s;
    display: flex; align-items: center; gap: .5rem;
  }
  .btn-secondary:hover { border-color: var(--burgundy); color: var(--burgundy); }

  .hero-image {
    position: relative; z-index: 1;
    animation: fadeIn .9s ease .2s both;
  }

  .hero-img-frame {
    border-radius: 4px 120px 4px 120px;
    overflow: hidden;
    box-shadow: 0 30px 80px rgba(123,28,42,0.25), 0 0 0 8px rgba(196,154,60,0.15);
    aspect-ratio: 4/5;
    position: relative;
  }
  .hero-img-frame img {
    width: 100%; height: 100%; object-fit: cover;
    transition: transform .8s ease;
  }
  .hero-img-frame:hover img { transform: scale(1.04); }

  .hero-stats {
    position: absolute; bottom: -20px; left: -20px;
    background: white;
    border-radius: 4px;
    padding: 1.2rem 1.5rem;
    box-shadow: 0 10px 40px rgba(0,0,0,0.12);
    display: grid; grid-template-columns: 1fr 1fr; gap: .8rem 1.5rem;
  }
  .stat { text-align: center; }
  .stat-num {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem; font-weight: 700;
    color: var(--burgundy); display: block;
  }
  .stat-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .1em; color: var(--text-light); }

  /* â”€â”€â”€ STATS BAR â”€â”€â”€ */
  .stats-bar {
    background: var(--burgundy);
    padding: 2.5rem 5vw;
    display: grid; grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }
  .stat-item { text-align: center; }
  .stat-item .num {
    font-family: 'Playfair Display', serif;
    font-size: 2.5rem; font-weight: 700;
    color: var(--gold);
  }
  .stat-item .lbl {
    font-size: .8rem; text-transform: uppercase; letter-spacing: .12em;
    color: rgba(255,255,255,0.6); margin-top: .3rem;
  }

  /* â”€â”€â”€ SECTION COMMON â”€â”€â”€ */
  section { padding: 6rem 5vw; }

  .section-label {
    font-size: .75rem; text-transform: uppercase; letter-spacing: .2em;
    color: var(--gold); font-weight: 500;
    display: flex; align-items: center; gap: .8rem;
    margin-bottom: 1rem;
  }
  .section-label::after {
    content: ''; flex: 1; max-width: 40px;
    height: 1px; background: var(--gold); opacity: .5;
  }

  .section-title {
    font-family: 'Playfair Display', serif;
    font-size: clamp(2rem, 3.5vw, 3rem);
    font-weight: 700; line-height: 1.2;
    color: var(--charcoal);
  }
  .section-title em { font-style: italic; color: var(--burgundy); }

  .section-desc {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.15rem; font-weight: 300;
    color: var(--text-light); line-height: 1.7;
    max-width: 600px;
  }

  /* â”€â”€â”€ MENUS SECTION â”€â”€â”€ */
  #menus { background: var(--white); }

  .menus-header { margin-bottom: 3rem; }

  .filters {
    background: var(--cream);
    border-radius: 4px;
    padding: 1.5rem 2rem;
    display: flex; flex-wrap: wrap; gap: 1rem 2rem;
    align-items: flex-end;
    margin-bottom: 3rem;
    border: 1px solid rgba(196,154,60,0.2);
  }

  .filter-group { display: flex; flex-direction: column; gap: .4rem; min-width: 160px; }
  .filter-group label {
    font-size: .7rem; text-transform: uppercase; letter-spacing: .12em;
    color: var(--text-light); font-weight: 500;
  }
  .filter-group select, .filter-group input {
    padding: .55rem .9rem;
    border: 1.5px solid rgba(0,0,0,0.12);
    border-radius: 2px;
    background: white;
    font-family: 'DM Sans', sans-serif;
    font-size: .875rem;
    color: var(--text);
    outline: none;
    transition: border-color .2s;
    cursor: pointer;
  }
  .filter-group select:focus, .filter-group input:focus { border-color: var(--burgundy); }

  .btn-reset {
    padding: .55rem 1.4rem;
    background: transparent;
    border: 1.5px solid var(--burgundy);
    color: var(--burgundy);
    border-radius: 2px;
    font-size: .75rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    cursor: pointer; transition: all .2s;
    white-space: nowrap;
  }
  .btn-reset:hover { background: var(--burgundy); color: white; }

  .menus-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
  }

  .menu-card {
    background: white;
    border: 1px solid rgba(0,0,0,0.06);
    border-radius: 4px;
    overflow: hidden;
    transition: transform .3s, box-shadow .3s;
    display: flex; flex-direction: column;
  }
  .menu-card:hover { transform: translateY(-6px); box-shadow: 0 20px 60px rgba(123,28,42,0.12); }

  .card-img {
    height: 200px;
    overflow: hidden;
    position: relative;
  }
  .card-img img { width: 100%; height: 100%; object-fit: cover; transition: transform .5s; }
  .menu-card:hover .card-img img { transform: scale(1.08); }

  .card-badge {
    position: absolute; top: 12px; left: 12px;
    background: rgba(255,255,255,0.92);
    padding: .25rem .7rem; border-radius: 100px;
    font-size: .65rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    color: var(--burgundy);
    backdrop-filter: blur(4px);
  }
  .card-badge.vegan { color: #2d7a3a; border: 1px solid rgba(45,122,58,0.3); }
  .card-badge.vegetarien { color: #5a7a2d; border: 1px solid rgba(90,122,45,0.3); }
  .card-badge.classique { color: var(--burgundy); border: 1px solid rgba(123,28,42,0.3); }

  .card-body { padding: 1.5rem; flex: 1; display: flex; flex-direction: column; }
  .card-name {
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem; font-weight: 700;
    color: var(--charcoal); margin-bottom: .5rem;
  }
  .card-desc {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1rem; color: var(--text-light);
    line-height: 1.5; flex: 1; margin-bottom: 1rem;
  }
  .card-meta {
    font-size: .75rem; color: var(--text-light);
    margin-bottom: 1rem;
    display: flex; align-items: center; gap: .3rem;
  }
  .card-meta::before { content: 'ðŸ‘¥'; font-size: .8rem; }

  .card-footer { display: flex; align-items: center; justify-content: space-between; }
  .card-price {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem; font-weight: 700; color: var(--burgundy);
  }
  .card-price span { font-size: .75rem; font-family: 'DM Sans', sans-serif; font-weight: 400; color: var(--text-light); }

  .btn-add {
    padding: .6rem 1.3rem;
    background: var(--burgundy); color: white;
    border: none; border-radius: 2px;
    font-size: .75rem; font-weight: 500; letter-spacing: .08em; text-transform: uppercase;
    cursor: pointer; transition: all .2s;
    display: flex; align-items: center; gap: .4rem;
  }
  .btn-add:hover { background: var(--burgundy-dark); transform: scale(1.03); }
  .btn-add svg { width: 14px; height: 14px; }

  /* â”€â”€â”€ DETAIL MODAL â”€â”€â”€ */
  .modal-overlay {
    position: fixed; inset: 0; z-index: 2000;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
    display: flex; align-items: center; justify-content: center;
    padding: 2rem;
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
  }
  .modal-overlay.open { opacity: 1; pointer-events: all; }

  .modal {
    background: white; border-radius: 4px;
    max-width: 700px; width: 100%;
    max-height: 90vh; overflow-y: auto;
    transform: scale(.96) translateY(20px);
    transition: transform .3s;
    position: relative;
  }
  .modal-overlay.open .modal { transform: scale(1) translateY(0); }

  .modal-img { height: 280px; overflow: hidden; }
  .modal-img img { width: 100%; height: 100%; object-fit: cover; }

  .modal-content { padding: 2.5rem; }
  .modal-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 1.5rem; }
  .modal-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.8rem; font-weight: 700; color: var(--charcoal);
  }
  .modal-close {
    background: none; border: none; cursor: pointer;
    font-size: 1.5rem; color: var(--text-light);
    padding: .2rem; line-height: 1;
    transition: color .2s;
  }
  .modal-close:hover { color: var(--burgundy); }

  .modal-desc {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.15rem; color: var(--text-light);
    line-height: 1.7; margin-bottom: 2rem;
  }

  .modal-details {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 1rem; margin-bottom: 2rem;
  }
  .modal-detail-item {
    background: var(--cream);
    padding: 1rem; border-radius: 2px;
  }
  .modal-detail-label { font-size: .7rem; text-transform: uppercase; letter-spacing: .1em; color: var(--text-light); margin-bottom: .3rem; }
  .modal-detail-value { font-weight: 600; color: var(--charcoal); }

  .modal-order { display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap; }
  .qty-control { display: flex; align-items: center; gap: .8rem; }
  .qty-btn {
    width: 36px; height: 36px; border-radius: 50%;
    border: 1.5px solid rgba(0,0,0,0.15);
    background: white; font-size: 1.2rem; font-weight: 500;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all .2s;
  }
  .qty-btn:hover { border-color: var(--burgundy); color: var(--burgundy); }
  .qty-num { font-size: 1.1rem; font-weight: 600; min-width: 24px; text-align: center; }

  .modal-price {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem; font-weight: 700; color: var(--burgundy);
  }

  .btn-add-cart {
    flex: 1;
    padding: .9rem 2rem;
    background: var(--burgundy); color: white;
    border: none; border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .85rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    cursor: pointer; transition: all .25s;
  }
  .btn-add-cart:hover { background: var(--burgundy-dark); }

  /* â”€â”€â”€ CART PANEL â”€â”€â”€ */
  .cart-overlay {
    position: fixed; inset: 0; z-index: 3000;
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px);
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
  }
  .cart-overlay.open { opacity: 1; pointer-events: all; }

  .cart-panel {
    position: fixed; top: 0; right: 0; bottom: 0;
    width: min(420px, 100vw);
    background: white; z-index: 3001;
    display: flex; flex-direction: column;
    transform: translateX(100%);
    transition: transform .35s cubic-bezier(.4,0,.2,1);
    box-shadow: -10px 0 60px rgba(0,0,0,0.15);
  }
  .cart-overlay.open .cart-panel { transform: translateX(0); }

  .cart-header {
    padding: 1.5rem 2rem;
    border-bottom: 1px solid rgba(0,0,0,0.06);
    display: flex; align-items: center; justify-content: space-between;
  }
  .cart-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem; font-weight: 700; color: var(--charcoal);
  }
  .cart-close {
    background: none; border: none; cursor: pointer;
    font-size: 1.5rem; color: var(--text-light);
    transition: color .2s;
  }
  .cart-close:hover { color: var(--burgundy); }

  .cart-items { flex: 1; overflow-y: auto; padding: 1.5rem 2rem; }

  .cart-empty {
    text-align: center; padding: 4rem 2rem;
    color: var(--text-light);
  }
  .cart-empty-icon { font-size: 3rem; margin-bottom: 1rem; }
  .cart-empty p {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.1rem;
  }

  .cart-item {
    display: flex; gap: 1rem; align-items: center;
    padding: 1rem 0; border-bottom: 1px solid rgba(0,0,0,0.05);
  }
  .cart-item-img { width: 64px; height: 64px; border-radius: 2px; overflow: hidden; flex-shrink: 0; }
  .cart-item-img img { width: 100%; height: 100%; object-fit: cover; }
  .cart-item-info { flex: 1; }
  .cart-item-name { font-weight: 600; font-size: .9rem; color: var(--charcoal); margin-bottom: .2rem; }
  .cart-item-price { font-size: .8rem; color: var(--text-light); }
  .cart-item-qty { display: flex; align-items: center; gap: .5rem; }
  .cart-item-qty button {
    width: 26px; height: 26px; border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.12);
    background: none; cursor: pointer; font-size: .9rem;
    display: flex; align-items: center; justify-content: center;
    transition: all .15s;
  }
  .cart-item-qty button:hover { background: var(--burgundy); color: white; border-color: var(--burgundy); }
  .cart-item-qty span { font-size: .9rem; font-weight: 600; min-width: 20px; text-align: center; }
  .cart-item-total { font-family: 'Playfair Display', serif; font-weight: 700; color: var(--burgundy); font-size: 1rem; }

  .cart-footer {
    padding: 1.5rem 2rem;
    border-top: 1px solid rgba(0,0,0,0.06);
  }
  .cart-subtotal {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 1rem;
  }
  .cart-subtotal .label { color: var(--text-light); font-size: .875rem; }
  .cart-subtotal .amount {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem; font-weight: 700; color: var(--charcoal);
  }
  .btn-checkout {
    width: 100%; padding: 1rem;
    background: var(--burgundy); color: white;
    border: none; border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .875rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    cursor: pointer; transition: all .25s;
    margin-bottom: .75rem;
  }
  .btn-checkout:hover { background: var(--burgundy-dark); }
  .cart-note { font-size: .7rem; text-align: center; color: var(--text-light); }

  /* â”€â”€â”€ ABOUT â”€â”€â”€ */
  #about {
    background: var(--cream);
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 5rem; align-items: center;
  }

  .about-images { position: relative; height: 500px; }
  .about-img1 {
    position: absolute; top: 0; left: 0;
    width: 72%; height: 75%;
    border-radius: 4px 100px 4px 4px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0,0,0,0.12);
  }
  .about-img1 img { width: 100%; height: 100%; object-fit: cover; }
  .about-img2 {
    position: absolute; bottom: 0; right: 0;
    width: 55%; height: 55%;
    border-radius: 100px 4px 4px 4px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(123,28,42,0.2);
    border: 4px solid white;
  }
  .about-img2 img { width: 100%; height: 100%; object-fit: cover; }

  .about-content {}
  .about-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.1rem; font-weight: 300;
    line-height: 1.8; color: var(--text-light);
    margin: 1.5rem 0 2rem;
  }
  .about-features { display: flex; flex-direction: column; gap: 1rem; margin-top: 2rem; }
  .feature-item { display: flex; align-items: flex-start; gap: 1rem; }
  .feature-icon {
    width: 40px; height: 40px; border-radius: 50%;
    background: rgba(123,28,42,0.06);
    display: flex; align-items: center; justify-content: center;
    font-size: 1.1rem; flex-shrink: 0;
  }
  .feature-text h4 { font-size: .9rem; font-weight: 600; margin-bottom: .2rem; }
  .feature-text p { font-size: .8rem; color: var(--text-light); line-height: 1.5; }

  /* â”€â”€â”€ REVIEWS â”€â”€â”€ */
  #reviews { background: var(--white); }
  .reviews-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; margin-top: 3rem; }
  .review-card {
    background: var(--cream);
    padding: 2rem;
    border-radius: 4px;
    border-left: 3px solid var(--gold);
    transition: transform .2s;
  }
  .review-card:hover { transform: translateY(-3px); }
  .stars { color: var(--gold); font-size: 1rem; margin-bottom: 1rem; }
  .review-text {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.1rem; font-style: italic;
    line-height: 1.6; color: var(--text);
    margin-bottom: 1.2rem;
  }
  .reviewer { display: flex; align-items: center; gap: .8rem; }
  .reviewer-avatar {
    width: 38px; height: 38px; border-radius: 50%;
    background: var(--burgundy);
    display: flex; align-items: center; justify-content: center;
    font-size: .9rem; font-weight: 700; color: white;
  }
  .reviewer-name { font-weight: 600; font-size: .875rem; }
  .reviewer-date { font-size: .75rem; color: var(--text-light); }

  /* â”€â”€â”€ CONTACT â”€â”€â”€ */
  #contact { background: var(--cream); }
  .contact-grid { display: grid; grid-template-columns: 1fr 1.4fr; gap: 5rem; margin-top: 3rem; }
  .contact-info { display: flex; flex-direction: column; gap: 2rem; }
  .contact-item { display: flex; gap: 1rem; align-items: flex-start; }
  .contact-icon {
    width: 44px; height: 44px; border-radius: 50%;
    background: var(--burgundy);
    display: flex; align-items: center; justify-content: center;
    font-size: 1rem; flex-shrink: 0; color: white;
  }
  .contact-detail h4 { font-weight: 600; margin-bottom: .2rem; }
  .contact-detail p { font-size: .875rem; color: var(--text-light); line-height: 1.5; }

  .contact-form { display: flex; flex-direction: column; gap: 1.2rem; }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.2rem; }
  .form-group { display: flex; flex-direction: column; gap: .4rem; }
  .form-group label { font-size: .75rem; text-transform: uppercase; letter-spacing: .1em; color: var(--text-light); font-weight: 500; }
  .form-group input, .form-group select, .form-group textarea {
    padding: .75rem 1rem;
    border: 1.5px solid rgba(0,0,0,0.1);
    border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .9rem; color: var(--text);
    background: white; outline: none;
    transition: border-color .2s;
  }
  .form-group input:focus, .form-group select:focus, .form-group textarea:focus { border-color: var(--burgundy); }
  .form-group textarea { min-height: 100px; resize: vertical; }

  /* â”€â”€â”€ FOOTER â”€â”€â”€ */
  footer {
    background: var(--charcoal);
    color: rgba(255,255,255,0.5);
    padding: 3rem 5vw 2rem;
  }
  .footer-grid { display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 3rem; margin-bottom: 2.5rem; }
  .footer-brand {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem; font-weight: 700;
    color: white; margin-bottom: 1rem;
  }
  .footer-brand span { color: var(--gold); }
  .footer-desc { font-size: .85rem; line-height: 1.6; max-width: 280px; }
  .footer-col h5 { font-size: .75rem; text-transform: uppercase; letter-spacing: .15em; color: white; margin-bottom: 1rem; }
  .footer-col ul { list-style: none; display: flex; flex-direction: column; gap: .5rem; }
  .footer-col ul li a { font-size: .85rem; color: rgba(255,255,255,0.5); text-decoration: none; transition: color .2s; }
  .footer-col ul li a:hover { color: var(--gold); }
  .footer-hours { font-size: .85rem; line-height: 1.8; }
  .footer-bottom {
    border-top: 1px solid rgba(255,255,255,0.06);
    padding-top: 1.5rem;
    display: flex; justify-content: space-between; align-items: center;
    font-size: .8rem;
  }
  .footer-bottom a { color: rgba(255,255,255,0.4); text-decoration: none; }
  .footer-bottom a:hover { color: var(--gold); }

  /* â”€â”€â”€ CHECKOUT MODAL â”€â”€â”€ */
  .checkout-form { padding: 2.5rem; }
  .checkout-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem; font-weight: 700; margin-bottom: .5rem;
  }
  .checkout-subtitle { color: var(--text-light); font-size: .9rem; margin-bottom: 2rem; }
  .step-indicator { display: flex; gap: 1rem; margin-bottom: 2rem; align-items: center; }
  .step { display: flex; align-items: center; gap: .4rem; font-size: .8rem; }
  .step-num {
    width: 24px; height: 24px; border-radius: 50%;
    background: var(--cream); color: var(--text-light);
    display: flex; align-items: center; justify-content: center;
    font-size: .7rem; font-weight: 700;
    border: 1.5px solid rgba(0,0,0,0.15);
  }
  .step.active .step-num { background: var(--burgundy); color: white; border-color: var(--burgundy); }
  .step-divider { flex: 1; height: 1px; background: rgba(0,0,0,0.1); }

  /* â”€â”€â”€ SUCCESS TOAST â”€â”€â”€ */
  .toast {
    position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px);
    background: var(--charcoal); color: white;
    padding: 1rem 2rem; border-radius: 4px;
    font-size: .875rem; font-weight: 500;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    z-index: 5000;
    transition: transform .4s cubic-bezier(.4,0,.2,1);
    white-space: nowrap;
    display: flex; align-items: center; gap: .6rem;
  }
  .toast.show { transform: translateX(-50%) translateY(0); }
  .toast::before { content: 'âœ“'; color: var(--gold); font-weight: 700; }

  /* â”€â”€â”€ NO RESULTS â”€â”€â”€ */
  .no-results {
    grid-column: 1/-1; text-align: center; padding: 4rem;
    color: var(--text-light);
  }
  .no-results p { font-family: 'Cormorant Garamond', serif; font-size: 1.3rem; }

  /* â”€â”€â”€ ANIMATIONS â”€â”€â”€ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(24px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes fadeIn {
    from { opacity: 0; } to { opacity: 1; }
  }

  /* â”€â”€â”€ RESPONSIVE â”€â”€â”€ */
  @media (max-width: 900px) {
    #hero { grid-template-columns: 1fr; padding-bottom: 3rem; }
    .hero-image { display: none; }
    #about { grid-template-columns: 1fr; }
    .about-images { display: none; }
    .contact-grid { grid-template-columns: 1fr; gap: 2rem; }
    .footer-grid { grid-template-columns: 1fr; }
    .modal-details { grid-template-columns: 1fr; }
    .form-row { grid-template-columns: 1fr; }
    .stats-bar { grid-template-columns: 1fr 1fr; }
    .nav-links { display: none; }
  }

  @media (max-width: 600px) {
    .filters { flex-direction: column; }
    .filter-group { min-width: auto; }
  }

  /* Smooth scroll for anchor links */
  a[href^="#"] { text-decoration: none; color: inherit; }

  /* â”€â”€â”€ EMPLOYEE SPACE â”€â”€â”€ */
  .emp-overlay {
    position: fixed; inset: 0; z-index: 6000;
    background: #0f0f0f;
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
    display: flex; flex-direction: column;
    overflow: hidden;
  }
  .emp-overlay.open { opacity: 1; pointer-events: all; }

  .emp-topbar {
    background: #1a1a1a;
    border-bottom: 1px solid rgba(196,154,60,.2);
    padding: 0 2rem;
    height: 56px;
    display: flex; align-items: center; justify-content: space-between;
    flex-shrink: 0;
  }
  .emp-brand {
    font-family: 'Playfair Display', serif;
    font-size: 1rem; font-weight: 700; color: white;
    display: flex; align-items: center; gap: .6rem;
  }
  .emp-brand span { color: var(--gold); font-size: .7rem; text-transform: uppercase; letter-spacing: .12em; font-family: 'DM Sans', sans-serif; font-weight: 500; background: rgba(196,154,60,.15); padding: .2rem .6rem; border-radius: 100px; }
  .emp-topbar-right { display: flex; align-items: center; gap: 1rem; }
  .emp-user { font-size: .8rem; color: rgba(255,255,255,.5); }
  .emp-logout-btn {
    padding: .4rem 1rem; background: none;
    border: 1px solid rgba(255,255,255,.15); border-radius: 2px;
    color: rgba(255,255,255,.6); font-size: .75rem; font-weight: 500;
    letter-spacing: .06em; text-transform: uppercase; cursor: pointer;
    transition: all .2s;
  }
  .emp-logout-btn:hover { border-color: var(--burgundy); color: var(--burgundy); }

  .emp-layout {
    display: flex; flex: 1; overflow: hidden;
  }

  .emp-sidebar {
    width: 220px; flex-shrink: 0;
    background: #141414;
    border-right: 1px solid rgba(255,255,255,.06);
    display: flex; flex-direction: column;
    overflow-y: auto;
    padding: 1.2rem 0;
  }
  .emp-nav-label {
    font-size: .6rem; text-transform: uppercase; letter-spacing: .15em;
    color: rgba(255,255,255,.25); padding: .8rem 1.4rem .3rem;
    font-weight: 600;
  }
  .emp-nav-btn {
    display: flex; align-items: center; gap: .7rem;
    padding: .7rem 1.4rem;
    background: none; border: none; width: 100%;
    font-family: 'DM Sans', sans-serif;
    font-size: .82rem; font-weight: 500;
    color: rgba(255,255,255,.5);
    cursor: pointer; text-align: left;
    transition: all .2s; border-left: 3px solid transparent;
    position: relative;
  }
  .emp-nav-btn:hover { color: white; background: rgba(255,255,255,.04); }
  .emp-nav-btn.active { color: white; border-left-color: var(--gold); background: rgba(196,154,60,.07); }
  .emp-nav-btn .emp-badge {
    margin-left: auto; background: var(--burgundy); color: white;
    font-size: .62rem; font-weight: 700; padding: .15rem .45rem;
    border-radius: 100px; min-width: 18px; text-align: center;
  }

  .emp-main {
    flex: 1; overflow-y: auto;
    background: #0f0f0f;
    padding: 2rem;
  }

  .emp-section { display: none; }
  .emp-section.active { display: block; }

  .emp-page-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem; font-weight: 700; color: white;
    margin-bottom: .4rem;
  }
  .emp-page-sub { font-size: .82rem; color: rgba(255,255,255,.4); margin-bottom: 2rem; }

  /* Cards */
  .emp-card {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.4rem; margin-bottom: 1rem;
    transition: border-color .2s;
  }
  .emp-card:hover { border-color: rgba(196,154,60,.25); }

  .emp-card-header {
    display: flex; justify-content: space-between; align-items: flex-start;
    margin-bottom: .8rem;
  }
  .emp-card-title { font-size: .95rem; font-weight: 600; color: white; }
  .emp-card-sub { font-size: .78rem; color: rgba(255,255,255,.35); margin-top: .15rem; }
  .emp-card-actions { display: flex; gap: .5rem; flex-wrap: wrap; }

  .emp-btn {
    padding: .4rem .9rem; border-radius: 3px; font-size: .72rem;
    font-weight: 600; letter-spacing: .06em; text-transform: uppercase;
    cursor: pointer; transition: all .15s; border: 1px solid transparent;
    font-family: 'DM Sans', sans-serif;
  }
  .emp-btn-gold { background: var(--gold); color: #1a1a1a; border-color: var(--gold); }
  .emp-btn-gold:hover { background: var(--gold-light); }
  .emp-btn-outline { background: none; border-color: rgba(255,255,255,.2); color: rgba(255,255,255,.7); }
  .emp-btn-outline:hover { border-color: white; color: white; }
  .emp-btn-danger { background: none; border-color: rgba(229,57,53,.4); color: #ef5350; }
  .emp-btn-danger:hover { background: #ef5350; color: white; }
  .emp-btn-success { background: none; border-color: rgba(45,122,58,.5); color: #66bb6a; }
  .emp-btn-success:hover { background: #2d7a3a; color: white; }
  .emp-btn-sm { padding: .28rem .65rem; font-size: .68rem; }

  /* Status badge dark */
  .emp-status {
    display: inline-flex; align-items: center; gap: .3rem;
    font-size: .65rem; font-weight: 700; text-transform: uppercase;
    letter-spacing: .07em; padding: .22rem .65rem; border-radius: 100px;
  }
  .emp-s-pending        { background: rgba(196,154,60,.15);  color: #c9a84c; }
  .emp-s-accepted       { background: rgba(45,122,58,.15);   color: #66bb6a; }
  .emp-s-in_preparation { background: rgba(33,150,243,.15);  color: #64b5f6; }
  .emp-s-delivering     { background: rgba(156,39,176,.15);  color: #ce93d8; }
  .emp-s-delivered      { background: rgba(45,122,58,.2);    color: #81c784; }
  .emp-s-awaiting_return{ background: rgba(255,152,0,.15);   color: #ffb74d; }
  .emp-s-completed      { background: rgba(196,154,60,.2);   color: var(--gold); }
  .emp-s-cancelled      { background: rgba(255,255,255,.06); color: rgba(255,255,255,.3); }

  /* Filters bar */
  .emp-filters {
    display: flex; gap: .8rem; flex-wrap: wrap; margin-bottom: 1.5rem;
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1rem 1.2rem; align-items: flex-end;
  }
  .emp-filter-group { display: flex; flex-direction: column; gap: .3rem; min-width: 140px; }
  .emp-filter-group label { font-size: .65rem; text-transform: uppercase; letter-spacing: .1em; color: rgba(255,255,255,.3); font-weight: 600; }
  .emp-filter-group select,
  .emp-filter-group input {
    background: #0f0f0f; border: 1px solid rgba(255,255,255,.1);
    border-radius: 3px; color: rgba(255,255,255,.75);
    font-family: 'DM Sans', sans-serif; font-size: .82rem;
    padding: .45rem .7rem; outline: none;
    transition: border-color .2s; cursor: pointer;
  }
  .emp-filter-group select:focus,
  .emp-filter-group input:focus { border-color: var(--gold); }

  /* Dark form */
  .emp-form-group { display: flex; flex-direction: column; gap: .35rem; margin-bottom: .9rem; }
  .emp-form-group label { font-size: .7rem; text-transform: uppercase; letter-spacing: .09em; color: rgba(255,255,255,.4); font-weight: 600; }
  .emp-form-group input,
  .emp-form-group select,
  .emp-form-group textarea {
    background: #0f0f0f; border: 1px solid rgba(255,255,255,.1);
    border-radius: 4px; color: rgba(255,255,255,.85);
    font-family: 'DM Sans', sans-serif; font-size: .875rem;
    padding: .6rem .85rem; outline: none; transition: border-color .2s;
  }
  .emp-form-group input:focus,
  .emp-form-group select:focus,
  .emp-form-group textarea:focus { border-color: var(--gold); }
  .emp-form-group textarea { min-height: 80px; resize: vertical; }
  .emp-form-row { display: grid; grid-template-columns: 1fr 1fr; gap: .8rem; }
  .emp-form-full { grid-column: 1 / -1; }

  /* Modal inside employee space */
  .emp-modal-overlay {
    position: fixed; inset: 0; z-index: 7000;
    background: rgba(0,0,0,.8); backdrop-filter: blur(6px);
    display: flex; align-items: center; justify-content: center;
    padding: 1.5rem;
    opacity: 0; pointer-events: none; transition: opacity .25s;
  }
  .emp-modal-overlay.open { opacity: 1; pointer-events: all; }
  .emp-modal {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.1);
    border-radius: 8px; width: 100%; max-width: 520px;
    max-height: 88vh; overflow-y: auto;
    transform: scale(.96) translateY(16px); transition: transform .25s;
  }
  .emp-modal-overlay.open .emp-modal { transform: scale(1) translateY(0); }
  .emp-modal-header {
    padding: 1.4rem 1.6rem;
    border-bottom: 1px solid rgba(255,255,255,.07);
    display: flex; align-items: center; justify-content: space-between;
  }
  .emp-modal-title { font-family: 'Playfair Display', serif; font-size: 1.15rem; font-weight: 700; color: white; }
  .emp-modal-close {
    background: rgba(255,255,255,.08); border: none; width: 28px; height: 28px;
    border-radius: 50%; color: rgba(255,255,255,.5); cursor: pointer; font-size: .85rem;
    display: flex; align-items: center; justify-content: center; transition: background .2s;
  }
  .emp-modal-close:hover { background: rgba(255,255,255,.15); color: white; }
  .emp-modal-body { padding: 1.6rem; }
  .emp-modal-footer {
    padding: 1.1rem 1.6rem;
    border-top: 1px solid rgba(255,255,255,.07);
    display: flex; gap: .7rem; justify-content: flex-end;
  }
  .emp-save-btn {
    width: 100%; padding: .8rem; background: var(--gold); color: #1a1a1a;
    border: none; border-radius: 4px; font-family: 'DM Sans', sans-serif;
    font-size: .82rem; font-weight: 700; letter-spacing: .08em;
    text-transform: uppercase; cursor: pointer; transition: background .2s;
    margin-top: .5rem;
  }
  .emp-save-btn:hover { background: var(--gold-light); }

  /* Status timeline in employee view */
  .emp-timeline { display: flex; flex-direction: column; gap: 0; }
  .emp-tl-step {
    display: flex; gap: .8rem; position: relative; padding-bottom: .8rem;
  }
  .emp-tl-step:not(:last-child)::before {
    content: ''; position: absolute; left: 11px; top: 24px;
    width: 2px; height: calc(100% - 8px);
    background: rgba(255,255,255,.08);
  }
  .emp-tl-dot {
    width: 24px; height: 24px; border-radius: 50%; flex-shrink: 0;
    background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.12);
    display: flex; align-items: center; justify-content: center;
    font-size: .68rem; margin-top: 1px;
  }
  .emp-tl-dot.done { background: rgba(196,154,60,.2); border-color: var(--gold); color: var(--gold); }
  .emp-tl-dot.current { background: var(--gold); border-color: var(--gold); color: #1a1a1a; font-weight: 700; }
  .emp-tl-label { font-size: .82rem; font-weight: 500; color: rgba(255,255,255,.7); }
  .emp-tl-date { font-size: .72rem; color: rgba(255,255,255,.3); }

  /* Menu edit grid */
  .emp-menus-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
  }
  .emp-menu-card {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; overflow: hidden; transition: border-color .2s;
  }
  .emp-menu-card:hover { border-color: rgba(196,154,60,.3); }
  .emp-menu-card img { width: 100%; height: 140px; object-fit: cover; display: block; }
  .emp-menu-card-body { padding: 1rem; }
  .emp-menu-card-name { font-size: .9rem; font-weight: 600; color: white; margin-bottom: .25rem; }
  .emp-menu-card-meta { font-size: .75rem; color: rgba(255,255,255,.35); margin-bottom: .8rem; }
  .emp-menu-card-actions { display: flex; gap: .5rem; }

  /* Review moderation */
  .emp-review-card {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.2rem; margin-bottom: .8rem;
    display: flex; gap: 1rem; align-items: flex-start;
  }
  .emp-review-stars { color: var(--gold); font-size: 1rem; white-space: nowrap; }
  .emp-review-content { flex: 1; }
  .emp-review-author { font-size: .78rem; font-weight: 600; color: rgba(255,255,255,.7); }
  .emp-review-date { font-size: .7rem; color: rgba(255,255,255,.3); }
  .emp-review-text { font-size: .84rem; color: rgba(255,255,255,.55); margin: .4rem 0 .8rem; font-style: italic; line-height: 1.5; }
  .emp-review-order { font-size: .72rem; color: rgba(196,154,60,.7); margin-bottom: .6rem; }

  /* Horaires */
  .emp-schedule-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 1rem; }
  .emp-schedule-card {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.2rem;
  }
  .emp-schedule-day { font-size: .75rem; text-transform: uppercase; letter-spacing: .12em; color: var(--gold); font-weight: 600; margin-bottom: .5rem; }
  .emp-schedule-hours { font-size: .95rem; font-weight: 600; color: white; }
  .emp-schedule-closed { color: rgba(255,255,255,.3); font-style: italic; }

  /* Warning box */
  .emp-warning {
    background: rgba(255,152,0,.08); border: 1px solid rgba(255,152,0,.25);
    border-radius: 4px; padding: .9rem 1.1rem; margin-bottom: 1rem;
    font-size: .82rem; color: #ffb74d; line-height: 1.5;
  }
  .emp-info {
    background: rgba(33,150,243,.08); border: 1px solid rgba(33,150,243,.2);
    border-radius: 4px; padding: .9rem 1.1rem; margin-bottom: 1rem;
    font-size: .82rem; color: #64b5f6; line-height: 1.5;
  }

  /* Stats row */
  .emp-stats-row {
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem;
  }
  .emp-stat-card {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.2rem;
  }
  .emp-stat-num {
    font-family: 'Playfair Display', serif;
    font-size: 1.8rem; font-weight: 700; color: var(--gold);
  }
  .emp-stat-label { font-size: .72rem; text-transform: uppercase; letter-spacing: .1em; color: rgba(255,255,255,.3); margin-top: .2rem; }

  /* Nav button for employee / admin in main nav */
  .btn-emp   { background: #1a1a1a; color: var(--gold); border: 1px solid rgba(196,154,60,.3); }
  .btn-emp:hover { background: rgba(196,154,60,.1); }
  .btn-admin { background: #1a0a0a; color: #ef5350; border: 1px solid rgba(239,83,80,.35); }
  .btn-admin:hover { background: rgba(239,83,80,.1); }

  /* â”€â”€â”€ ADMIN SPACE â”€â”€â”€ */
  /* Admin uses emp- CSS + these overrides */
  .adm-overlay {
    position: fixed; inset: 0; z-index: 7500;
    background: #0a0a0a;
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
    display: flex; flex-direction: column;
    overflow: hidden;
  }
  .adm-overlay.open { opacity: 1; pointer-events: all; }

  .adm-topbar {
    background: #120808;
    border-bottom: 1px solid rgba(239,83,80,.2);
    padding: 0 2rem;
    height: 56px;
    display: flex; align-items: center; justify-content: space-between;
    flex-shrink: 0;
  }
  .adm-brand {
    font-family: 'Playfair Display', serif;
    font-size: 1rem; font-weight: 700; color: white;
    display: flex; align-items: center; gap: .6rem;
  }
  .adm-brand span { color: #ef5350; font-size: .7rem; text-transform: uppercase; letter-spacing: .12em; font-family: 'DM Sans', sans-serif; font-weight: 600; background: rgba(239,83,80,.12); padding: .2rem .6rem; border-radius: 100px; }

  .adm-sidebar {
    width: 230px; flex-shrink: 0;
    background: #0e0808;
    border-right: 1px solid rgba(255,255,255,.05);
    display: flex; flex-direction: column;
    overflow-y: auto;
    padding: 1.2rem 0;
  }
  .adm-nav-btn {
    display: flex; align-items: center; gap: .7rem;
    padding: .7rem 1.4rem;
    background: none; border: none; width: 100%;
    font-family: 'DM Sans', sans-serif;
    font-size: .82rem; font-weight: 500;
    color: rgba(255,255,255,.45);
    cursor: pointer; text-align: left;
    transition: all .2s; border-left: 3px solid transparent;
  }
  .adm-nav-btn:hover { color: white; background: rgba(255,255,255,.04); }
  .adm-nav-btn.active { color: white; border-left-color: #ef5350; background: rgba(239,83,80,.07); }

  .adm-main {
    flex: 1; overflow-y: auto;
    background: #0a0a0a;
    padding: 2rem;
  }
  .adm-section { display: none; }
  .adm-section.active { display: block; }

  .adm-page-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem; font-weight: 700; color: white;
    margin-bottom: .4rem;
  }
  .adm-page-sub { font-size: .82rem; color: rgba(255,255,255,.35); margin-bottom: 2rem; }

  /* Employee account cards */
  .adm-emp-card {
    background: #161616; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.2rem 1.4rem;
    display: flex; align-items: center; gap: 1.2rem;
    margin-bottom: .8rem; transition: border-color .2s;
  }
  .adm-emp-card:hover { border-color: rgba(196,154,60,.2); }
  .adm-emp-avatar {
    width: 44px; height: 44px; border-radius: 50%;
    background: rgba(196,154,60,.15); border: 1px solid rgba(196,154,60,.25);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700;
    color: var(--gold); flex-shrink: 0;
  }
  .adm-emp-info { flex: 1; }
  .adm-emp-name { font-size: .92rem; font-weight: 600; color: white; }
  .adm-emp-email { font-size: .76rem; color: rgba(255,255,255,.35); margin-top: .1rem; }
  .adm-emp-meta { font-size: .7rem; color: rgba(255,255,255,.25); margin-top: .2rem; }
  .adm-emp-disabled { opacity: .4; }
  .adm-emp-disabled .adm-emp-avatar { background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.1); color: rgba(255,255,255,.3); }

  .adm-badge-active   { background: rgba(45,122,58,.15);  color: #66bb6a; }
  .adm-badge-disabled { background: rgba(255,255,255,.06); color: rgba(255,255,255,.3); }

  /* Chart container */
  .adm-chart-wrap {
    background: #161616; border: 1px solid rgba(255,255,255,.07);
    border-radius: 6px; padding: 1.6rem;
    margin-bottom: 1.5rem; position: relative;
  }
  .adm-chart-title {
    font-size: .8rem; text-transform: uppercase; letter-spacing: .12em;
    color: rgba(255,255,255,.35); font-weight: 600; margin-bottom: 1.2rem;
  }
  canvas#admChart { width: 100% !important; }

  /* Revenue table */
  .adm-revenue-table { width: 100%; border-collapse: collapse; }
  .adm-revenue-table th {
    font-size: .65rem; text-transform: uppercase; letter-spacing: .1em;
    color: rgba(255,255,255,.3); font-weight: 600;
    padding: .6rem .8rem; text-align: left;
    border-bottom: 1px solid rgba(255,255,255,.07);
  }
  .adm-revenue-table td {
    font-size: .84rem; color: rgba(255,255,255,.7);
    padding: .7rem .8rem;
    border-bottom: 1px solid rgba(255,255,255,.05);
  }
  .adm-revenue-table tr:last-child td { border-bottom: none; }
  .adm-revenue-table .adm-rev-total {
    font-weight: 700; color: var(--gold);
  }
  .adm-revenue-table tr:hover td { background: rgba(255,255,255,.03); }

  /* Progress bar for chart legend */
  .adm-bar-row { display: flex; align-items: center; gap: .8rem; margin-bottom: .5rem; }
  .adm-bar-label { font-size: .78rem; color: rgba(255,255,255,.6); width: 160px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-shrink: 0; }
  .adm-bar-track { flex: 1; height: 8px; background: rgba(255,255,255,.07); border-radius: 100px; overflow: hidden; }
  .adm-bar-fill  { height: 100%; border-radius: 100px; transition: width .6s ease; }
  .adm-bar-count { font-size: .78rem; color: rgba(255,255,255,.4); width: 40px; text-align: right; flex-shrink: 0; }

  /* Admin modal reuses emp-modal styles */
  .adm-modal-overlay {
    position: fixed; inset: 0; z-index: 8000;
    background: rgba(0,0,0,.85); backdrop-filter: blur(6px);
    display: flex; align-items: center; justify-content: center;
    padding: 1.5rem;
    opacity: 0; pointer-events: none; transition: opacity .25s;
  }
  .adm-modal-overlay.open { opacity: 1; pointer-events: all; }
  .adm-modal {
    background: #1a1a1a; border: 1px solid rgba(255,255,255,.1);
    border-radius: 8px; width: 100%; max-width: 460px;
    transform: scale(.96) translateY(16px); transition: transform .25s;
  }
  .adm-modal-overlay.open .adm-modal { transform: scale(1) translateY(0); }
  .adm-modal-header {
    padding: 1.3rem 1.5rem;
    border-bottom: 1px solid rgba(255,255,255,.07);
    display: flex; align-items: center; justify-content: space-between;
  }
  .adm-modal-title { font-family: 'Playfair Display', serif; font-size: 1.1rem; font-weight: 700; color: white; }
  .adm-modal-close {
    background: rgba(255,255,255,.08); border: none; width: 28px; height: 28px;
    border-radius: 50%; color: rgba(255,255,255,.5); cursor: pointer; font-size: .85rem;
    display: flex; align-items: center; justify-content: center; transition: background .2s;
  }
  .adm-modal-close:hover { background: rgba(255,255,255,.15); color: white; }
  .adm-modal-body { padding: 1.5rem; }
  .adm-save-btn {
    width: 100%; padding: .8rem; background: #ef5350; color: white;
    border: none; border-radius: 4px; font-family: 'DM Sans', sans-serif;
    font-size: .82rem; font-weight: 700; letter-spacing: .08em;
    text-transform: uppercase; cursor: pointer; transition: background .2s;
    margin-top: .5rem;
  }
  .adm-save-btn:hover { background: #e53935; }

  /* Simulate email notification box */
  .adm-email-preview {
    background: #0f0f0f; border: 1px solid rgba(196,154,60,.2);
    border-radius: 4px; padding: 1rem 1.1rem; margin-top: .8rem;
    font-size: .78rem; color: rgba(255,255,255,.5); line-height: 1.6;
  }
  .adm-email-preview strong { color: rgba(255,255,255,.75); }

  /* â”€â”€â”€ MENTIONS LÃ‰GALES â”€â”€â”€ */
  .mentions-section {
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid rgba(0,0,0,.06);
  }
  .mentions-h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.1rem; font-weight: 700;
    color: var(--burgundy);
    margin-bottom: 1rem;
  }
  .mentions-subtitle {
    font-size: .78rem; text-transform: uppercase; letter-spacing: .1em;
    color: var(--gold); font-weight: 600;
    margin-bottom: .5rem; margin-top: .8rem;
  }
  .mentions-text {
    font-size: .9rem; line-height: 1.7;
    color: var(--text); margin-bottom: .6rem;
  }
  .mentions-list {
    list-style: none; display: flex; flex-direction: column; gap: .4rem;
    margin: .5rem 0 .8rem 0;
  }
  .mentions-list li {
    font-size: .875rem; color: var(--text);
    padding-left: 1.2rem; position: relative; line-height: 1.5;
  }
  .mentions-list li::before {
    content: 'â€”'; position: absolute; left: 0;
    color: var(--gold); font-weight: 700;
  }
  .mentions-table {
    width: 100%; border-collapse: collapse; margin-top: .5rem;
    font-size: .875rem;
  }
  .mentions-table tr { border-bottom: 1px solid rgba(0,0,0,.05); }
  .mentions-table tr:last-child { border-bottom: none; }
  .mentions-table td {
    padding: .6rem .8rem; vertical-align: top;
  }
  .mentions-table td:first-child {
    font-weight: 600; color: var(--text-light);
    width: 45%; background: var(--cream); border-radius: 2px;
  }
  .mentions-table td:last-child { color: var(--charcoal); }

  /* â”€â”€â”€ DASHBOARD â”€â”€â”€ */
  .dashboard-overlay {
    position: fixed; inset: 0; z-index: 4000;
    background: rgba(0,0,0,0.55);
    backdrop-filter: blur(6px);
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
    display: flex; justify-content: flex-end;
  }
  .dashboard-overlay.open { opacity: 1; pointer-events: all; }

  .dashboard-panel {
    width: min(520px, 100vw);
    background: var(--cream);
    height: 100%;
    overflow-y: auto;
    display: flex; flex-direction: column;
    transform: translateX(100%);
    transition: transform .35s cubic-bezier(.4,0,.2,1);
    box-shadow: -10px 0 60px rgba(0,0,0,0.15);
  }
  .dashboard-overlay.open .dashboard-panel { transform: translateX(0); }

  .dash-header {
    background: var(--burgundy);
    padding: 2rem 2rem 1.5rem;
    position: relative;
  }
  .dash-close {
    position: absolute; top: 1rem; right: 1rem;
    background: rgba(255,255,255,0.15); border: none;
    width: 32px; height: 32px; border-radius: 50%;
    color: white; font-size: 1rem; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: background .2s;
  }
  .dash-close:hover { background: rgba(255,255,255,0.25); }

  .dash-avatar {
    width: 64px; height: 64px; border-radius: 50%;
    background: var(--gold);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem; font-weight: 700; color: white;
    margin-bottom: 1rem;
    border: 3px solid rgba(255,255,255,0.3);
  }
  .dash-name {
    font-family: 'Playfair Display', serif;
    font-size: 1.3rem; font-weight: 700; color: white;
  }
  .dash-email { font-size: .8rem; color: rgba(255,255,255,0.65); margin-top: .2rem; }

  .dash-tabs {
    display: flex; background: white;
    border-bottom: 1px solid rgba(0,0,0,.07);
    overflow-x: auto;
  }
  .dash-tab {
    flex: 1; min-width: 80px;
    padding: .9rem .5rem;
    background: none; border: none;
    font-family: 'DM Sans', sans-serif;
    font-size: .75rem; font-weight: 600;
    letter-spacing: .05em; text-transform: uppercase;
    color: var(--text-light); cursor: pointer;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
    transition: all .2s;
    white-space: nowrap;
  }
  .dash-tab.active { color: var(--burgundy); border-bottom-color: var(--burgundy); }

  .dash-body { flex: 1; padding: 1.5rem 2rem; }
  .dash-section { display: none; }
  .dash-section.active { display: block; }

  .dash-section-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.2rem; font-weight: 700; color: var(--charcoal);
    margin-bottom: 1.2rem;
    display: flex; align-items: center; gap: .6rem;
  }

  /* Orders */
  .order-card {
    background: white; border-radius: 4px;
    border: 1px solid rgba(0,0,0,.06);
    padding: 1.2rem; margin-bottom: 1rem;
    transition: box-shadow .2s;
  }
  .order-card:hover { box-shadow: 0 4px 20px rgba(0,0,0,.08); }
  .order-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: .8rem; }
  .order-id { font-size: .7rem; text-transform: uppercase; letter-spacing: .1em; color: var(--text-light); }
  .order-status {
    font-size: .65rem; font-weight: 700; text-transform: uppercase; letter-spacing: .08em;
    padding: .25rem .7rem; border-radius: 100px;
  }
  .status-confirmed { background: rgba(45,122,58,0.1); color: #2d7a3a; }
  .status-pending   { background: rgba(196,154,60,0.15); color: #7a5c00; }
  .status-delivered { background: rgba(123,28,42,0.1); color: var(--burgundy); }
  .status-cancelled { background: rgba(0,0,0,0.06); color: var(--text-light); }

  .order-menu { font-weight: 600; font-size: .9rem; color: var(--charcoal); margin-bottom: .3rem; }
  .order-meta { font-size: .8rem; color: var(--text-light); display: flex; gap: 1rem; flex-wrap: wrap; }
  .order-footer { display: flex; justify-content: space-between; align-items: center; margin-top: .8rem; padding-top: .8rem; border-top: 1px solid rgba(0,0,0,.05); }
  .order-total { font-family: 'Playfair Display', serif; font-weight: 700; color: var(--burgundy); }
  .btn-order-action {
    font-size: .72rem; font-weight: 500; letter-spacing: .06em; text-transform: uppercase;
    padding: .35rem .9rem; border-radius: 2px; cursor: pointer;
    border: 1.5px solid rgba(123,28,42,0.25); background: none; color: var(--burgundy);
    transition: all .15s;
  }
  .btn-order-action:hover { background: var(--burgundy); color: white; }

  /* Profile form */
  .profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  .profile-full { grid-column: 1/-1; }
  .dash-save-btn {
    width: 100%; padding: .9rem;
    background: var(--burgundy); color: white; border: none;
    font-family: 'DM Sans', sans-serif;
    font-size: .85rem; font-weight: 500; letter-spacing: .1em; text-transform: uppercase;
    border-radius: 2px; cursor: pointer; margin-top: .5rem;
    transition: background .2s;
  }
  .dash-save-btn:hover { background: var(--burgundy-dark); }

  /* Addresses */
  .address-card {
    background: white; border-radius: 4px;
    border: 1px solid rgba(0,0,0,.06);
    padding: 1.2rem; margin-bottom: 1rem;
    display: flex; justify-content: space-between; align-items: flex-start;
    gap: 1rem;
    transition: box-shadow .2s;
  }
  .address-card:hover { box-shadow: 0 4px 20px rgba(0,0,0,.08); }
  .address-badge {
    font-size: .65rem; text-transform: uppercase; letter-spacing: .08em;
    padding: .2rem .6rem; border-radius: 100px;
    background: rgba(196,154,60,0.15); color: #7a5c00;
    font-weight: 700; margin-bottom: .4rem; display: inline-block;
  }
  .address-text { font-size: .875rem; color: var(--text); line-height: 1.5; }
  .address-actions { display: flex; flex-direction: column; gap: .4rem; flex-shrink: 0; }
  .btn-icon {
    background: none; border: 1px solid rgba(0,0,0,.1); border-radius: 2px;
    font-size: .8rem; padding: .3rem .7rem; cursor: pointer; color: var(--text-light);
    transition: all .15s; white-space: nowrap;
  }
  .btn-icon:hover { border-color: var(--burgundy); color: var(--burgundy); }
  .btn-icon.danger:hover { border-color: #e53935; color: #e53935; }
  .btn-add-address {
    width: 100%; padding: .8rem; margin-top: .5rem;
    background: none; border: 1.5px dashed rgba(123,28,42,0.25); border-radius: 4px;
    color: var(--burgundy); font-size: .85rem; font-weight: 500;
    cursor: pointer; transition: all .2s;
  }
  .btn-add-address:hover { background: rgba(123,28,42,0.04); border-style: solid; }

  /* Security */
  .security-item {
    background: white; border-radius: 4px; border: 1px solid rgba(0,0,0,.06);
    padding: 1.2rem; margin-bottom: 1rem;
  }
  .security-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: .3rem; }
  .security-item-title { font-weight: 600; font-size: .9rem; }
  .security-item-desc { font-size: .8rem; color: var(--text-light); }

  /* Preferences */
  .pref-toggle {
    display: flex; justify-content: space-between; align-items: center;
    background: white; border-radius: 4px; border: 1px solid rgba(0,0,0,.06);
    padding: 1rem 1.2rem; margin-bottom: .8rem;
  }
  .pref-toggle-info h4 { font-size: .875rem; font-weight: 600; margin-bottom: .2rem; }
  .pref-toggle-info p { font-size: .78rem; color: var(--text-light); }
  .toggle-switch {
    position: relative; width: 44px; height: 24px; flex-shrink: 0;
  }
  .toggle-switch input { opacity: 0; width: 0; height: 0; }
  .toggle-slider {
    position: absolute; inset: 0; border-radius: 100px;
    background: #ddd; cursor: pointer; transition: background .2s;
  }
  .toggle-slider::before {
    content: ''; position: absolute;
    width: 18px; height: 18px; border-radius: 50%;
    background: white; left: 3px; top: 3px;
    transition: transform .2s;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
  }
  .toggle-switch input:checked + .toggle-slider { background: var(--burgundy); }
  .toggle-switch input:checked + .toggle-slider::before { transform: translateX(20px); }

  /* Empty state */
  .dash-empty {
    text-align: center; padding: 3rem 1rem; color: var(--text-light);
  }
  .dash-empty .icon { font-size: 2.5rem; margin-bottom: .8rem; }
  .dash-empty p { font-family: 'Cormorant Garamond', serif; font-size: 1.1rem; }

  /* â”€â”€â”€ ORDER DETAIL MODAL â”€â”€â”€ */
  .order-detail-overlay {
    position: fixed; inset: 0; z-index: 5000;
    background: rgba(0,0,0,0.65);
    backdrop-filter: blur(8px);
    display: flex; align-items: center; justify-content: center;
    padding: 1.5rem;
    opacity: 0; pointer-events: none;
    transition: opacity .3s;
  }
  .order-detail-overlay.open { opacity: 1; pointer-events: all; }
  .order-detail-panel {
    background: white; border-radius: 6px;
    width: 100%; max-width: 560px;
    max-height: 88vh; overflow-y: auto;
    transform: scale(.96) translateY(20px);
    transition: transform .3s;
    position: relative;
  }
  .order-detail-overlay.open .order-detail-panel { transform: scale(1) translateY(0); }

  .odp-header {
    background: var(--burgundy); padding: 1.8rem 2rem 1.4rem;
    position: sticky; top: 0; z-index: 1;
  }
  .odp-close {
    position: absolute; top: 1rem; right: 1rem;
    background: rgba(255,255,255,0.15); border: none;
    width: 30px; height: 30px; border-radius: 50%;
    color: white; font-size: .9rem; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    transition: background .2s;
  }
  .odp-close:hover { background: rgba(255,255,255,0.28); }
  .odp-ref { font-size: .7rem; text-transform: uppercase; letter-spacing: .12em; color: rgba(255,255,255,.55); margin-bottom: .3rem; }
  .odp-menu-name { font-family: 'Playfair Display', serif; font-size: 1.3rem; font-weight: 700; color: white; }

  .odp-body { padding: 1.8rem 2rem; }

  .odp-info-grid {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: .8rem; margin-bottom: 1.5rem;
  }
  .odp-info-item {
    background: var(--cream); border-radius: 4px; padding: .9rem 1rem;
  }
  .odp-info-label { font-size: .65rem; text-transform: uppercase; letter-spacing: .1em; color: var(--text-light); margin-bottom: .25rem; }
  .odp-info-value { font-weight: 600; font-size: .875rem; color: var(--charcoal); }

  /* Tracking timeline */
  .tracking-title {
    font-family: 'Playfair Display', serif;
    font-size: 1rem; font-weight: 700; color: var(--charcoal);
    margin-bottom: 1rem; display: flex; align-items: center; gap: .5rem;
  }
  .timeline { display: flex; flex-direction: column; gap: 0; margin-bottom: 1.5rem; }
  .timeline-step {
    display: flex; gap: 1rem; position: relative;
  }
  .timeline-step:not(:last-child)::before {
    content: '';
    position: absolute; left: 13px; top: 28px;
    width: 2px; height: calc(100% - 2px);
    background: rgba(0,0,0,.08);
  }
  .timeline-step.done::before { background: rgba(196,154,60,.35); }
  .tl-dot {
    width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
    border: 2px solid rgba(0,0,0,.1);
    background: var(--cream);
    display: flex; align-items: center; justify-content: center;
    font-size: .75rem; margin-top: 2px;
  }
  .tl-dot.done { background: var(--gold); border-color: var(--gold); color: white; font-weight: 700; }
  .tl-dot.current { background: var(--burgundy); border-color: var(--burgundy); color: white; }
  .tl-content { padding-bottom: 1.2rem; }
  .tl-label { font-size: .875rem; font-weight: 600; color: var(--charcoal); }
  .tl-date { font-size: .75rem; color: var(--text-light); margin-top: .15rem; }
  .tl-date.pending { color: #b0b0b0; font-style: italic; }

  /* Edit order form */
  .edit-order-section {
    background: var(--cream); border-radius: 4px; padding: 1.2rem;
    margin-bottom: 1.2rem; border: 1px solid rgba(196,154,60,.2);
  }
  .edit-order-title {
    font-size: .75rem; text-transform: uppercase; letter-spacing: .1em;
    color: var(--gold); font-weight: 600; margin-bottom: 1rem;
  }

  /* Star rating */
  .star-rating { display: flex; gap: .3rem; margin: .8rem 0; }
  .star-rating .star {
    font-size: 1.8rem; cursor: pointer; color: #ddd;
    transition: color .15s, transform .15s;
    line-height: 1;
  }
  .star-rating .star.active,
  .star-rating .star.hovered { color: var(--gold); }
  .star-rating .star:hover { transform: scale(1.15); }

  .review-submitted-badge {
    display: inline-flex; align-items: center; gap: .4rem;
    background: rgba(45,122,58,.08); border: 1px solid rgba(45,122,58,.25);
    color: #2d7a3a; padding: .35rem .9rem; border-radius: 100px;
    font-size: .75rem; font-weight: 600; margin-top: .5rem;
  }

  /* Logout btn */
  .btn-logout {
    width: 100%; padding: .8rem;
    background: none; border: 1.5px solid rgba(123,28,42,0.2);
    color: var(--burgundy); border-radius: 2px;
    font-family: 'DM Sans', sans-serif;
    font-size: .8rem; font-weight: 500; letter-spacing: .08em; text-transform: uppercase;
    cursor: pointer; margin-top: 1rem;
    transition: all .2s;
  }
  .btn-logout:hover { background: var(--burgundy); color: white; }


    text-align: center; padding: 2rem;
  }
  .confirmed-msg .icon { font-size: 3rem; margin-bottom: 1rem; }
  .confirmed-msg h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem; color: var(--charcoal); margin-bottom: .5rem;
  }
  .confirmed-msg p { color: var(--text-light); line-height: 1.6; }
</style>
</head>
<body>

<!-- NAV -->
<nav id="navbar">
  <a class="nav-brand" href="#hero">Vite <span>&</span> Gourmand</a>
  <ul class="nav-links">
    <li><a href="#hero">Accueil</a></li>
    <li><a href="#menus">Menus</a></li>
    <li><a href="#about">Ã€ propos</a></li>
    <li><a href="#reviews">Avis</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
  <div class="nav-actions">
    <button class="btn-nav btn-outline" id="navConnexion" onclick="showLogin('login')">Connexion</button>
    <button class="btn-nav btn-solid" id="navInscrire" onclick="showLogin('register')">S'inscrire</button>
    <button class="btn-nav btn-solid" id="navUser" style="display:none;gap:.4rem;align-items:center" onclick="openDashboard()">ðŸ‘¤ <span id="navUserName"></span></button>
    <button class="btn-nav btn-emp"   id="navEmployee" style="display:none" onclick="openEmployeeSpace()">ðŸ›  Espace employÃ©</button>
    <button class="btn-nav btn-admin" id="navAdmin"    style="display:none" onclick="openAdminSpace()">âš™ï¸ Admin</button>
    <button class="cart-btn" onclick="toggleCart()">
      <svg viewBox="0 0 24 24" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
      <span class="cart-count" id="cartCount">0</span>
    </button>
  </div>
</nav>

<!-- HERO -->
<section id="hero">
  <div class="hero-bg"></div>
  <div class="hero-ornament"></div>
  <div class="hero-content">
    <div class="hero-badge">Traiteur gastronomique Â· Bordeaux</div>
    <h1 class="hero-title">Cuisine maison,<em>pour toutes vos occasions.</em></h1>
    <p class="hero-sub">Julie & JosÃ©, 25 ans de savoir-faire traiteur Ã  Bordeaux. Nous allions authenticitÃ© des recettes du terroir et crÃ©ativitÃ© pour sublimer vos Ã©vÃ©nements.</p>
    <div class="hero-ctas">
      <button class="btn-primary" onclick="document.getElementById('menus').scrollIntoView({behavior:'smooth'})">
        ðŸ½ DÃ©couvrir nos menus
      </button>
      <button class="btn-secondary" onclick="document.getElementById('contact').scrollIntoView({behavior:'smooth'})">
        Nous contacter â†’
      </button>
    </div>
  </div>
  <div class="hero-image">
    <div class="hero-img-frame">
      <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80" alt="Cuisine gastronomique">
    </div>
    <div class="hero-stats">
      <div class="stat"><span class="stat-num">25+</span><div class="stat-label">AnnÃ©es</div></div>
      <div class="stat"><span class="stat-num">500+</span><div class="stat-label">Ã‰vÃ©nements</div></div>
      <div class="stat"><span class="stat-num">98%</span><div class="stat-label">Satisfaits</div></div>
      <div class="stat"><span class="stat-num">24h</span><div class="stat-label">DÃ©lai</div></div>
    </div>
  </div>
</section>

<!-- STATS BAR -->
<div class="stats-bar">
  <div class="stat-item"><div class="num">25+</div><div class="lbl">AnnÃ©es d'expÃ©rience</div></div>
  <div class="stat-item"><div class="num">500+</div><div class="lbl">Ã‰vÃ©nements rÃ©alisÃ©s</div></div>
  <div class="stat-item"><div class="num">98%</div><div class="lbl">Utilisateurs satisfaits</div></div>
  <div class="stat-item"><div class="num">24h</div><div class="lbl">DÃ©lai de commande</div></div>
</div>

<!-- MENUS -->
<section id="menus">
  <div class="menus-header">
    <div class="section-label">Notre carte</div>
    <h2 class="section-title">Nos <em>Menus</em></h2>
    <p class="section-desc" style="margin-top:.8rem">Des compositions pensÃ©es pour chaque occasion, de l'intime au grandiose.</p>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label>Type de menu</label>
      <select id="filterType" onchange="filterMenus()">
        <option value="">Tous les rÃ©gimes</option>
        <option value="classique">Classique</option>
        <option value="vegan">Vegan</option>
        <option value="vegetarien">VÃ©gÃ©tarien</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Nombre de personnes</label>
      <select id="filterPersons" onchange="filterMenus()">
        <option value="">Tous les nombres</option>
        <option value="2">2+</option>
        <option value="4">4+</option>
        <option value="6">6+</option>
        <option value="8">8+</option>
        <option value="10">10+</option>
        <option value="15">15+</option>
      </select>
    </div>
    <div class="filter-group">
      <label>ThÃ¨me</label>
      <select id="filterTheme" onchange="filterMenus()">
        <option value="">Tous les thÃ¨mes</option>
        <option value="NoÃ«l">NoÃ«l</option>
        <option value="PÃ¢ques">PÃ¢ques</option>
        <option value="Cocktail">Cocktail</option>
        <option value="Buffet">Buffet</option>
        <option value="Gastronomique">Gastronomique</option>
        <option value="Terroir">Terroir</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Prix min (â‚¬/pers.)</label>
      <input type="number" id="filterPriceMin" placeholder="Ex: 20" oninput="filterMenus()">
    </div>
    <div class="filter-group">
      <label>Prix max (â‚¬/pers.)</label>
      <input type="number" id="filterPriceMax" placeholder="Ex: 65" oninput="filterMenus()">
    </div>
    <button class="btn-reset" onclick="resetFilters()">âŸ³ RÃ©initialiser</button>
  </div>

  <div class="menus-grid" id="menusGrid"></div>
</section>

<!-- ABOUT -->
<section id="about">
  <div class="about-images">
    <div class="about-img1">
      <img src="https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=700&q=80" alt="Cuisine">
    </div>
    <div class="about-img2">
      <img src="https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=500&q=80" alt="Chef">
    </div>
  </div>
  <div class="about-content">
    <div class="section-label">Notre histoire</div>
    <h2 class="section-title">Julie & JosÃ©,<em>25 ans de passion</em></h2>
    <p class="about-text">Depuis 1999, nous mettons notre passion pour la cuisine du terroir au service de vos Ã©vÃ©nements les plus prÃ©cieux. InstallÃ©s au cÅ“ur de Bordeaux, nous sÃ©lectionnons les meilleurs producteurs locaux pour vous offrir une expÃ©rience culinaire authentique et mÃ©morable.</p>
    <div class="about-features">
      <div class="feature-item">
        <div class="feature-icon">ðŸŒ¿</div>
        <div class="feature-text">
          <h4>Produits frais & locaux</h4>
          <p>SÃ©lection rigoureuse auprÃ¨s de producteurs girondins de confiance.</p>
        </div>
      </div>
      <div class="feature-item">
        <div class="feature-icon">ðŸ‘¨â€ðŸ³</div>
        <div class="feature-text">
          <h4>Cuisine maison</h4>
          <p>Toutes nos recettes sont prÃ©parÃ©es le jour mÃªme dans notre atelier.</p>
        </div>
      </div>
      <div class="feature-item">
        <div class="feature-icon">ðŸšš</div>
        <div class="feature-text">
          <h4>Livraison & installation</h4>
          <p>Nous livrons et installons vos buffets dans toute la Gironde.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- REVIEWS -->
<section id="reviews">
  <div style="max-width:600px">
    <div class="section-label">TÃ©moignages</div>
    <h2 class="section-title">Ils nous ont <em>fait confiance</em></h2>
  </div>
  <div class="reviews-grid" id="reviewsGrid"></div>
</section>

<!-- CONTACT -->
<section id="contact">
  <div style="max-width:600px; margin-bottom:3rem">
    <div class="section-label">Nous joindre</div>
    <h2 class="section-title">Demande de <em>devis</em></h2>
    <p class="section-desc" style="margin-top:.8rem">Parlez-nous de votre projet et nous vous rÃ©pondrons dans les 24 heures.</p>
  </div>
  <div class="contact-grid">
    <div class="contact-info">
      <div class="contact-item">
        <div class="contact-icon">ðŸ“</div>
        <div class="contact-detail">
          <h4>Notre adresse</h4>
          <p>12 Rue de la Brasserie<br>33000 Bordeaux, Gironde</p>
        </div>
      </div>
      <div class="contact-item">
        <div class="contact-icon">ðŸ•</div>
        <div class="contact-detail">
          <h4>Horaires d'ouverture</h4>
          <p>Lunâ€“Ven : 09h00â€“18h00<br>Samedi : 10h00â€“16h00<br>Dimanche : FermÃ©</p>
        </div>
      </div>
      <div class="contact-item">
        <div class="contact-icon">ðŸ“ž</div>
        <div class="contact-detail">
          <h4>TÃ©lÃ©phone</h4>
          <p>+33 5 56 00 12 34</p>
        </div>
      </div>
      <div class="contact-item">
        <div class="contact-icon">âœ‰ï¸</div>
        <div class="contact-detail">
          <h4>Email</h4>
          <p><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="781b17160c191b0c380e110c1d551d0c551f170d0a1519161c561e0a">[<span class="__cf_email__" data-cfemail="b7d4d8d9c3d6d4c3f7c1dec3d29ad2c39ad0d8c2c5dad6d9d399d1c5">[email&#160;protected]</span>&#160;]</a></p>
        </div>
      </div>
    </div>
    <form class="contact-form" onsubmit="submitContact(event)">
      <div class="form-row">
        <div class="form-group"><label>PrÃ©nom</label><input type="text" placeholder="Julie" required></div>
        <div class="form-group"><label>Nom</label><input type="text" placeholder="Dupont" required></div>
      </div>
      <div class="form-row">
        <div class="form-group"><label>Email</label><input type="email" placeholder="julie@email.fr" required></div>
        <div class="form-group"><label>TÃ©lÃ©phone</label><input type="tel" placeholder="06 00 00 00 00"></div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Type d'Ã©vÃ©nement</label>
          <select>
            <option>Mariage</option><option>Anniversaire</option>
            <option>SÃ©minaire</option><option>Cocktail</option>
            <option>Autre</option>
          </select>
        </div>
        <div class="form-group"><label>Nombre de personnes</label><input type="number" placeholder="50"></div>
      </div>
      <div class="form-group"><label>Date souhaitÃ©e</label><input type="date"></div>
      <div class="form-group"><label>Message</label><textarea placeholder="DÃ©crivez votre Ã©vÃ©nement..."></textarea></div>
      <button type="submit" class="btn-primary" style="align-self:flex-start; padding:.9rem 2.5rem">Envoyer ma demande â†’</button>
    </form>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-grid">
    <div>
      <div class="footer-brand">Vite <span>&</span> Gourmand</div>
      <p class="footer-desc">Traiteur gastronomique Ã  Bordeaux depuis 1999. Julie & JosÃ©, une passion partagÃ©e pour la cuisine du terroir.</p>
    </div>
    <div class="footer-col">
      <h5>Navigation</h5>
      <ul>
        <li><a href="#hero">Accueil</a></li>
        <li><a href="#menus">Nos menus</a></li>
        <li><a href="#about">Ã€ propos</a></li>
        <li><a href="#reviews">Avis clients</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h5>Horaires</h5>
      <div class="footer-hours">
        Lunâ€“Ven : 09h00â€“18h00<br>
        Samedi : 10h00â€“16h00<br>
        Dimanche : FermÃ©
      </div>
    </div>
  </div>
  <div class="footer-bottom">
    <span>Â© 2026 Vite &amp; Gourmand. Tous droits rÃ©servÃ©s.</span>
    <span>
      <a href="#" onclick="openMentions(event)">Mentions lÃ©gales</a> Â· <a href="#" onclick="openCGV(event)">CGV</a> Â· <a href="#">Politique de confidentialitÃ©</a>
    </span>
  </div>
</footer>

<!-- ADMIN SPACE -->
<div class="adm-overlay" id="admOverlay">

  <div class="adm-topbar">
    <div class="adm-brand">Vite &amp; Gourmand <span>âš™ï¸ Administration</span></div>
    <div class="emp-topbar-right">
      <span class="emp-user" id="admUserLabel">Administrateur</span>
      <button class="emp-logout-btn" onclick="closeAdminSpace()">âœ• Quitter</button>
    </div>
  </div>

  <div class="emp-layout">
    <aside class="adm-sidebar">
      <div class="emp-nav-label">Tableau de bord</div>
      <button class="adm-nav-btn active" onclick="admSwitchTab('dashboard', this)">ðŸ“Š Vue d'ensemble</button>

      <div class="emp-nav-label">Ressources humaines</div>
      <button class="adm-nav-btn" onclick="admSwitchTab('employees', this)">ðŸ‘¥ Comptes employÃ©s</button>

      <div class="emp-nav-label">Analytique</div>
      <button class="adm-nav-btn" onclick="admSwitchTab('analytics', this)">ðŸ“ˆ Commandes / Menus</button>
      <button class="adm-nav-btn" onclick="admSwitchTab('revenue', this)">ðŸ’¶ Chiffre d'affaires</button>

      <div class="emp-nav-label" style="margin-top:.8rem;border-top:1px solid rgba(255,255,255,.06);padding-top:.8rem">Espace employÃ©</div>
      <button class="adm-nav-btn" onclick="admOpenEmployeeSection('orders')">ðŸ“¦ Commandes</button>
      <button class="adm-nav-btn" onclick="admOpenEmployeeSection('menus')">ðŸ½ Menus &amp; Plats</button>
      <button class="adm-nav-btn" onclick="admOpenEmployeeSection('schedule')">ðŸ• Horaires</button>
      <button class="adm-nav-btn" onclick="admOpenEmployeeSection('reviews')">â­ Avis clients</button>
    </aside>

    <main class="adm-main">

      <!-- â”€ DASHBOARD â”€ -->
      <div class="adm-section active" id="adm-dashboard">
        <div class="adm-page-title">Administration</div>
        <div class="adm-page-sub">Bienvenue dans l'espace administrateur. Vue d'ensemble du systÃ¨me.</div>
        <div class="emp-stats-row" id="admStatsRow"></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-top:.5rem">
          <div>
            <div class="adm-page-title" style="font-size:1rem;margin-bottom:1rem">ðŸ‘¥ Comptes employÃ©s</div>
            <div id="admDashEmployees"></div>
          </div>
          <div>
            <div class="adm-page-title" style="font-size:1rem;margin-bottom:1rem">â³ Commandes rÃ©centes</div>
            <div id="admDashOrders"></div>
          </div>
        </div>
      </div>

      <!-- â”€ EMPLOYEES â”€ -->
      <div class="adm-section" id="adm-employees">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:.4rem">
          <div class="adm-page-title">Comptes employÃ©s</div>
          <button class="emp-btn emp-btn-gold" onclick="admOpenCreateEmployee()">+ CrÃ©er un compte</button>
        </div>
        <div class="adm-page-sub">GÃ©rez les accÃ¨s des membres de l'Ã©quipe.</div>
        <div id="admEmployeeList"></div>
      </div>

      <!-- â”€ ANALYTICS â”€ -->
      <div class="adm-section" id="adm-analytics">
        <div class="adm-page-title">Commandes par menu</div>
        <div class="adm-page-sub">Comparaison du volume de commandes pour chaque menu (donnÃ©es NoSQL simulÃ©es).</div>

        <div class="emp-filters" style="margin-bottom:1.5rem">
          <div class="emp-filter-group">
            <label>PÃ©riode</label>
            <select id="admAnalyticsPeriod" onchange="admRenderAnalytics()">
              <option value="all">Toutes les commandes</option>
              <option value="30">30 derniers jours</option>
              <option value="90">3 derniers mois</option>
              <option value="365">12 derniers mois</option>
            </select>
          </div>
          <div class="emp-filter-group">
            <label>Type de graphique</label>
            <select id="admChartType" onchange="admRenderAnalytics()">
              <option value="bar">Barres</option>
              <option value="horizontalBar">Barres horizontales</option>
              <option value="pie">Camembert</option>
            </select>
          </div>
        </div>

        <div class="adm-chart-wrap">
          <div class="adm-chart-title">Volume de commandes par menu</div>
          <canvas id="admChart" height="320"></canvas>
        </div>

        <div class="adm-chart-wrap">
          <div class="adm-chart-title">Classement par popularitÃ©</div>
          <div id="admBarChart"></div>
        </div>
      </div>

      <!-- â”€ REVENUE â”€ -->
      <div class="adm-section" id="adm-revenue">
        <div class="adm-page-title">Chiffre d'affaires</div>
        <div class="adm-page-sub">Analyse du CA par menu et par pÃ©riode.</div>

        <div class="emp-filters" style="margin-bottom:1.5rem">
          <div class="emp-filter-group">
            <label>Menu</label>
            <select id="admRevMenu" onchange="admRenderRevenue()">
              <option value="">Tous les menus</option>
            </select>
          </div>
          <div class="emp-filter-group">
            <label>Statut</label>
            <select id="admRevStatus" onchange="admRenderRevenue()">
              <option value="">Tous</option>
              <option value="completed">TerminÃ©es</option>
              <option value="delivered">LivrÃ©es</option>
              <option value="in_preparation">En prÃ©paration</option>
              <option value="accepted">AcceptÃ©es</option>
            </select>
          </div>
          <div class="emp-filter-group">
            <label>Date dÃ©but</label>
            <input type="date" id="admRevDateFrom" onchange="admRenderRevenue()">
          </div>
          <div class="emp-filter-group">
            <label>Date fin</label>
            <input type="date" id="admRevDateTo" onchange="admRenderRevenue()">
          </div>
          <div style="align-self:flex-end">
            <button class="emp-btn emp-btn-outline" onclick="admResetRevFilters()">â†º Reset</button>
          </div>
        </div>

        <div class="emp-stats-row" id="admRevStatsRow" style="grid-template-columns:repeat(3,1fr)"></div>

        <div class="adm-chart-wrap" style="margin-top:1.2rem">
          <div class="adm-chart-title">CA par menu</div>
          <table class="adm-revenue-table" id="admRevenueTable"></table>
        </div>
      </div>

    </main>
  </div>
</div>

<!-- Admin: Create employee modal -->
<div class="adm-modal-overlay" id="admEmpModal" onclick="admCloseEmpModalOutside(event)">
  <div class="adm-modal">
    <div class="adm-modal-header">
      <div class="adm-modal-title" id="admEmpModalTitle">CrÃ©er un compte employÃ©</div>
      <button class="adm-modal-close" onclick="admCloseEmpModal()">âœ•</button>
    </div>
    <div class="adm-modal-body">
      <div class="emp-form-group"><label>PrÃ©nom *</label><input type="text" id="admEmpPrenom" placeholder="Julie"></div>
      <div class="emp-form-group"><label>Nom *</label><input type="text" id="admEmpNom" placeholder="Dupont"></div>
      <div class="emp-form-group"><label>Email (identifiant) *</label><input type="email" id="admEmpEmail" placeholder="julie.dupont@vitegourmand.fr"></div>
      <div class="emp-form-group"><label>Mot de passe *</label><input type="password" id="admEmpPassword" placeholder="Minimum 10 caractÃ¨res, maj, chiffre, spÃ©cial"></div>
      <div class="emp-form-group"><label>RÃ´le</label>
        <select id="admEmpRole">
          <option value="employee">EmployÃ©(e)</option>
          <option value="manager">Manager</option>
        </select>
      </div>
      <div class="adm-email-preview" id="admEmailPreview" style="display:none">
        <strong>ðŸ“§ Email de notification simulÃ© :</strong><br><br>
        <span id="admEmailContent"></span>
      </div>
      <button class="adm-save-btn" onclick="admCreateEmployee()">âœ“ CrÃ©er le compte &amp; notifier</button>
    </div>
  </div>
</div>

<!-- EMPLOYEE SPACE -->
<div class="emp-overlay" id="empOverlay">

  <!-- Topbar -->
  <div class="emp-topbar">
    <div class="emp-brand">Vite &amp; Gourmand <span>Espace EmployÃ©</span></div>
    <div class="emp-topbar-right">
      <span class="emp-user" id="empUserLabel"></span>
      <button class="emp-logout-btn" onclick="closeEmployeeSpace()">âœ• Quitter</button>
    </div>
  </div>

  <div class="emp-layout">
    <!-- Sidebar -->
    <aside class="emp-sidebar">
      <div class="emp-nav-label">Tableau de bord</div>
      <button class="emp-nav-btn active" onclick="empSwitchTab('dashboard', this)">ðŸ“Š Vue d'ensemble</button>

      <div class="emp-nav-label">Commandes</div>
      <button class="emp-nav-btn" onclick="empSwitchTab('orders', this)">ðŸ“¦ Commandes <span class="emp-badge" id="empBadgeOrders">0</span></button>

      <div class="emp-nav-label">Catalogue</div>
      <button class="emp-nav-btn" onclick="empSwitchTab('menus', this)">ðŸ½ Menus &amp; Plats</button>
      <button class="emp-nav-btn" onclick="empSwitchTab('schedule', this)">ðŸ• Horaires</button>

      <div class="emp-nav-label">ModÃ©ration</div>
      <button class="emp-nav-btn" onclick="empSwitchTab('reviews', this)">â­ Avis clients <span class="emp-badge" id="empBadgeReviews">0</span></button>
    </aside>

    <!-- Main -->
    <main class="emp-main">

      <!-- â”€ DASHBOARD â”€ -->
      <div class="emp-section active" id="emp-dashboard">
        <div class="emp-page-title">Vue d'ensemble</div>
        <div class="emp-page-sub">Bonjour ! Voici un rÃ©sumÃ© de l'activitÃ© en cours.</div>
        <div class="emp-stats-row" id="empStatsRow"></div>
        <div class="emp-page-title" style="font-size:1.1rem;margin-bottom:1rem">â³ Commandes urgentes</div>
        <div id="empUrgentOrders"></div>
      </div>

      <!-- â”€ COMMANDES â”€ -->
      <div class="emp-section" id="emp-orders">
        <div class="emp-page-title">Gestion des commandes</div>
        <div class="emp-page-sub">Filtrez, consultez et mettez Ã  jour les commandes clients.</div>

        <div class="emp-filters">
          <div class="emp-filter-group">
            <label>Statut</label>
            <select id="empFilterStatus" onchange="empFilterOrders()">
              <option value="">Tous</option>
              <option value="pending">En attente</option>
              <option value="accepted">AcceptÃ©e</option>
              <option value="in_preparation">En prÃ©paration</option>
              <option value="delivering">En livraison</option>
              <option value="delivered">LivrÃ©e</option>
              <option value="awaiting_return">Retour matÃ©riel</option>
              <option value="completed">TerminÃ©e</option>
              <option value="cancelled">AnnulÃ©e</option>
            </select>
          </div>
          <div class="emp-filter-group">
            <label>Client (nom / rÃ©f)</label>
            <input type="text" id="empFilterClient" placeholder="Dupont, VG-2026â€¦" oninput="empFilterOrders()">
          </div>
          <div class="emp-filter-group">
            <label>Menu</label>
            <input type="text" id="empFilterMenu" placeholder="Gastronomiqueâ€¦" oninput="empFilterOrders()">
          </div>
          <div style="align-self:flex-end">
            <button class="emp-btn emp-btn-outline" onclick="empResetFilters()">â†º RÃ©initialiser</button>
          </div>
        </div>

        <div id="empOrdersList"></div>
      </div>

      <!-- â”€ MENUS â”€ -->
      <div class="emp-section" id="emp-menus">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:.4rem">
          <div class="emp-page-title">Menus &amp; Plats</div>
          <button class="emp-btn emp-btn-gold" onclick="empOpenMenuModal(null)">+ Nouveau menu</button>
        </div>
        <div class="emp-page-sub">Modifiez ou supprimez les menus du catalogue.</div>
        <div class="emp-menus-grid" id="empMenusGrid"></div>
      </div>

      <!-- â”€ HORAIRES â”€ -->
      <div class="emp-section" id="emp-schedule">
        <div class="emp-page-title">Horaires d'ouverture</div>
        <div class="emp-page-sub">Modifiez les horaires affichÃ©s sur le site.</div>
        <div class="emp-schedule-grid" id="empScheduleGrid"></div>
      </div>

      <!-- â”€ AVIS â”€ -->
      <div class="emp-section" id="emp-reviews">
        <div class="emp-page-title">ModÃ©ration des avis</div>
        <div class="emp-page-sub">Validez ou refusez les avis dÃ©posÃ©s par les clients.</div>

        <div style="display:flex;gap:.8rem;margin-bottom:1.5rem;flex-wrap:wrap">
          <button class="emp-btn emp-btn-outline" id="empRevTabPending" onclick="empSwitchRevTab('pending')" style="border-color:var(--gold);color:var(--gold)">â³ En attente <span id="empRevPendingCount"></span></button>
          <button class="emp-btn emp-btn-outline" id="empRevTabApproved" onclick="empSwitchRevTab('approved')">âœ… ApprouvÃ©s</button>
          <button class="emp-btn emp-btn-outline" id="empRevTabRejected" onclick="empSwitchRevTab('rejected')">âŒ RefusÃ©s</button>
        </div>

        <div id="empReviewsList"></div>
      </div>

    </main>
  </div>
</div>

<!-- EMP: Order action modal (status update / cancel) -->
<div class="emp-modal-overlay" id="empOrderModal" onclick="empCloseOrderModalOutside(event)">
  <div class="emp-modal" style="max-width:560px">
    <div class="emp-modal-header">
      <div class="emp-modal-title" id="empOrderModalTitle">Commande</div>
      <button class="emp-modal-close" onclick="empCloseOrderModal()">âœ•</button>
    </div>
    <div class="emp-modal-body" id="empOrderModalBody"></div>
  </div>
</div>

<!-- EMP: Menu edit modal -->
<div class="emp-modal-overlay" id="empMenuModal" onclick="empCloseMenuModalOutside(event)">
  <div class="emp-modal" style="max-width:600px">
    <div class="emp-modal-header">
      <div class="emp-modal-title" id="empMenuModalTitle">Menu</div>
      <button class="emp-modal-close" onclick="empCloseMenuModal()">âœ•</button>
    </div>
    <div class="emp-modal-body">
      <input type="hidden" id="empMenuId">
      <div class="emp-form-row">
        <div class="emp-form-group"><label>Nom du menu</label><input type="text" id="empMenuName" placeholder="Menu Gastronomique"></div>
        <div class="emp-form-group"><label>Type</label>
          <select id="empMenuType">
            <option value="classique">Classique</option>
            <option value="vegan">Vegan</option>
            <option value="vegetarien">VÃ©gÃ©tarien</option>
          </select>
        </div>
      </div>
      <div class="emp-form-row">
        <div class="emp-form-group"><label>ThÃ¨me</label><input type="text" id="empMenuTheme" placeholder="NoÃ«l, Mariageâ€¦"></div>
        <div class="emp-form-group"><label>Prix / pers. (â‚¬)</label><input type="number" id="empMenuPrice" placeholder="45" min="0" step="0.5"></div>
      </div>
      <div class="emp-form-row">
        <div class="emp-form-group"><label>Min. personnes</label><input type="number" id="empMenuMinPersons" placeholder="4" min="1"></div>
        <div class="emp-form-group"><label>URL image</label><input type="text" id="empMenuImg" placeholder="https://â€¦"></div>
      </div>
      <div class="emp-form-group emp-form-full"><label>Description courte</label><textarea id="empMenuDesc" placeholder="Description affichÃ©e sur la carteâ€¦"></textarea></div>
      <div class="emp-form-group emp-form-full"><label>Description complÃ¨te</label><textarea id="empMenuFullDesc" placeholder="Description dÃ©taillÃ©e du menuâ€¦" style="min-height:100px"></textarea></div>
      <div class="emp-form-group emp-form-full"><label>Composition (une ligne par plat)</label><textarea id="empMenuComposition" placeholder="EntrÃ©e 1&#10;Plat principal&#10;Dessertâ€¦" style="min-height:90px"></textarea></div>
      <div class="emp-form-group emp-form-full"><label>AllergÃ¨nes</label><input type="text" id="empMenuAllergens" placeholder="Gluten, Lait, Å’ufsâ€¦"></div>
      <button class="emp-save-btn" onclick="empSaveMenu()">âœ“ Enregistrer le menu</button>
    </div>
  </div>
</div>

<!-- EMP: Schedule edit modal -->
<div class="emp-modal-overlay" id="empScheduleModal" onclick="empCloseScheduleModalOutside(event)">
  <div class="emp-modal" style="max-width:400px">
    <div class="emp-modal-header">
      <div class="emp-modal-title" id="empScheduleModalTitle">Modifier les horaires</div>
      <button class="emp-modal-close" onclick="empCloseScheduleModal()">âœ•</button>
    </div>
    <div class="emp-modal-body">
      <input type="hidden" id="empScheduleIdx">
      <div class="emp-form-group"><label>Jour</label><input type="text" id="empScheduleDay" readonly style="opacity:.5"></div>
      <div class="emp-form-group">
        <label>Statut</label>
        <select id="empScheduleClosed" onchange="empToggleScheduleHours()">
          <option value="0">Ouvert</option>
          <option value="1">FermÃ©</option>
        </select>
      </div>
      <div id="empScheduleHoursFields">
        <div class="emp-form-row">
          <div class="emp-form-group"><label>Ouverture</label><input type="time" id="empScheduleOpen" value="09:00"></div>
          <div class="emp-form-group"><label>Fermeture</label><input type="time" id="empScheduleClose" value="18:00"></div>
        </div>
      </div>
      <button class="emp-save-btn" onclick="empSaveSchedule()">âœ“ Enregistrer</button>
    </div>
  </div>
</div>

<!-- ORDER DETAIL MODAL -->
<div class="order-detail-overlay" id="orderDetailOverlay" onclick="closeOrderDetailOutside(event)">
  <div class="order-detail-panel" id="orderDetailPanel">
    <!-- Filled dynamically -->
  </div>
</div>

<!-- CGV MODAL -->
<div class="modal-overlay" id="cgvOverlay" onclick="closeCGVOutside(event)" style="align-items:flex-start;padding-top:4rem;overflow-y:auto">
  <div class="modal" style="max-width:780px">
    <div style="padding:2.5rem 3rem">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:2rem;padding-bottom:1.2rem;border-bottom:1px solid rgba(0,0,0,.08)">
        <div>
          <div style="font-size:.7rem;text-transform:uppercase;letter-spacing:.2em;color:var(--gold);margin-bottom:.4rem">Contractuel</div>
          <h2 style="font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;color:var(--charcoal)">Conditions GÃ©nÃ©rales de Vente</h2>
          <p style="font-size:.8rem;color:var(--text-light);margin-top:.3rem">DerniÃ¨re mise Ã  jour : 03/01/2026</p>
        </div>
        <button class="modal-close" onclick="closeCGV()">âœ•</button>
      </div>

      <div style="background:rgba(123,28,42,0.06);border-left:3px solid var(--burgundy);padding:1rem 1.2rem;border-radius:0 4px 4px 0;margin-bottom:2rem">
        <p style="font-size:.875rem;color:var(--burgundy);font-weight:500">âš ï¸ En passant commande sur notre site, vous acceptez sans rÃ©serve les prÃ©sentes Conditions GÃ©nÃ©rales de Vente.</p>
      </div>

      <!-- IdentitÃ© -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ¢ IdentitÃ© du Prestataire</h3>
        <table class="mentions-table">
          <tr><td>SociÃ©tÃ©</td><td>Vite &amp; Gourmand</td></tr>
          <tr><td>Forme juridique</td><td>SAS (SociÃ©tÃ© par Actions SimplifiÃ©e)</td></tr>
          <tr><td>Capital social</td><td>15 000 â‚¬</td></tr>
          <tr><td>SIRET</td><td>156 456 789 00012</td></tr>
          <tr><td>TVA intracommunautaire</td><td>FR 12 156456789</td></tr>
          <tr><td>Adresse</td><td>12 Rue de la Brasserie, 33000 Bordeaux, France</td></tr>
          <tr><td>Email</td><td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="31525e5f4550524571475845541c54451c565e44435c505f551f5743">[<span class="__cf_email__" data-cfemail="7b1814150f1a180f3b0d120f1e561e0f561c140e09161a151f551d09">[email&#160;protected]</span>&#160;]</a></td></tr>
          <tr><td>TÃ©lÃ©phone</td><td>+33 5 56 00 12 34</td></tr>
        </table>
      </div>

      <!-- Art. 1 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ“œ Article 1 â€“ Objet</h3>
        <p class="mentions-text">Les prÃ©sentes Conditions GÃ©nÃ©rales de Vente (CGV) rÃ©gissent les relations contractuelles entre Vite &amp; Gourmand, ci-aprÃ¨s dÃ©nommÃ©e "le Prestataire", et toute personne physique ou morale, ci-aprÃ¨s dÃ©nommÃ©e "l'Utilisateur", souhaitant effectuer une commande de prestation traiteur via le site internet.</p>
      </div>

      <!-- Art. 2 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ½ï¸ Article 2 â€“ Prestations proposÃ©es</h3>
        <p class="mentions-text">Vite &amp; Gourmand propose des prestations de traiteur comprenant :</p>
        <ul class="mentions-list">
          <li>La prÃ©paration de menus pour Ã©vÃ©nements (repas de fÃªtes, Ã©vÃ©nements professionnels, etc.)</li>
          <li>La livraison des plats commandÃ©s</li>
          <li>Le prÃªt de matÃ©riel (selon disponibilitÃ©)</li>
        </ul>
        <p class="mentions-text">Les menus proposÃ©s sont dÃ©crits avec prÃ©cision sur le site. Les photos et descriptions sont fournies Ã  titre indicatif.</p>
      </div>

      <!-- Art. 3 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ“ Article 3 â€“ Commandes</h3>

        <p class="mentions-subtitle">3.1. Passation de commande</p>
        <p class="mentions-text">Pour passer commande, l'utilisateur doit :</p>
        <ul class="mentions-list">
          <li>CrÃ©er un compte utilisateur sur le site</li>
          <li>SÃ©lectionner le menu souhaitÃ©</li>
          <li>Indiquer le nombre de personnes (minimum selon le menu choisi)</li>
          <li>PrÃ©ciser la date et l'heure de prestation souhaitÃ©es</li>
          <li>Renseigner l'adresse de livraison</li>
          <li>Valider la commande</li>
        </ul>

        <p class="mentions-subtitle">3.2. DÃ©lai de commande</p>
        <p class="mentions-text">Les commandes doivent Ãªtre passÃ©es au minimum <strong>7 jours ouvrÃ©s</strong> avant la date de prestation souhaitÃ©e. Certains menus peuvent nÃ©cessiter un dÃ©lai plus long (indiquÃ© dans les conditions du menu).</p>

        <p class="mentions-subtitle">3.3. Confirmation de commande</p>
        <p class="mentions-text">Une fois la commande passÃ©e, l'utilisateur reÃ§oit un email de confirmation automatique. La commande n'est dÃ©finitive qu'aprÃ¨s acceptation par Vite &amp; Gourmand (statut "acceptÃ©e").</p>

        <p class="mentions-subtitle">3.4. Modification de commande</p>
        <p class="mentions-text">L'utilisateur peut modifier sa commande tant qu'elle n'a pas Ã©tÃ© acceptÃ©e par le prestataire. Une fois acceptÃ©e, toute modification doit faire l'objet d'une demande par email Ã  <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="45262a2b3124263105332c312068203168222a303728242b216b2337">[<span class="__cf_email__" data-cfemail="f794989983969483b7819e8392da9283da909882859a969993d99185">[email&#160;protected]</span>&#160;]</a></strong> et sera soumise Ã  l'accord du prestataire.</p>

        <p class="mentions-subtitle">3.5. Annulation de commande</p>
        <p class="mentions-text">L'utilisateur peut annuler sa commande :</p>
        <ul class="mentions-list">
          <li><strong>Gratuitement :</strong> jusqu'Ã  48h aprÃ¨s la passation de commande (si la commande n'a pas encore Ã©tÃ© acceptÃ©e)</li>
          <li><strong>Avec frais :</strong> aprÃ¨s acceptation, sous rÃ©serve de contacter le prestataire. Des frais d'annulation de 30% du montant total peuvent s'appliquer.</li>
        </ul>
      </div>

      <!-- Art. 4 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ’¶ Article 4 â€“ Prix et Paiement</h3>

        <p class="mentions-subtitle">4.1. Prix</p>
        <p class="mentions-text">Les prix sont indiquÃ©s en euros (â‚¬) TTC (Toutes Taxes Comprises) et incluent la TVA au taux en vigueur. Le prix comprend : le prix du menu par personne Ã— nombre de personnes, les frais de livraison et la TVA.</p>

        <p class="mentions-subtitle">4.2. RÃ©duction</p>
        <p class="mentions-text">Une rÃ©duction de <strong>10%</strong> est automatiquement appliquÃ©e pour toute commande comportant 5 personnes de plus que le nombre minimum indiquÃ© dans le menu.</p>

        <p class="mentions-subtitle">4.3. ModalitÃ©s de paiement</p>
        <ul class="mentions-list">
          <li>Par carte bancaire (Visa, Mastercard)</li>
          <li>Par virement bancaire (pour les commandes professionnelles)</li>
        </ul>
        <p class="mentions-text">Un acompte de <strong>30%</strong> est demandÃ© lors de la commande. Le solde est Ã  rÃ©gler <strong>48h avant</strong> la prestation.</p>

        <p class="mentions-subtitle">4.4. PÃ©nalitÃ©s de retard</p>
        <div style="background:rgba(123,28,42,0.05);border-left:3px solid var(--burgundy);padding:1rem 1.2rem;border-radius:0 4px 4px 0;margin:.5rem 0">
          <p style="font-size:.85rem;color:var(--text);line-height:1.6">âš ï¸ ConformÃ©ment aux dispositions lÃ©gales, tout retard de paiement entraÃ®nera de plein droit et sans mise en demeure prÃ©alable :</p>
          <ul class="mentions-list" style="margin-top:.5rem">
            <li>L'application de pÃ©nalitÃ©s de retard calculÃ©es au taux directeur de la BCE majorÃ© de 10 points</li>
            <li>Le paiement d'une indemnitÃ© forfaitaire de <strong>40 â‚¬</strong> pour frais de recouvrement</li>
            <li>Si les frais de recouvrement sont supÃ©rieurs Ã  40 â‚¬, une indemnisation complÃ©mentaire pourra Ãªtre demandÃ©e</li>
          </ul>
        </div>
      </div>

      <!-- Art. 5 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸšš Article 5 â€“ Livraison</h3>

        <p class="mentions-subtitle">5.1. Zone de livraison</p>
        <p class="mentions-text">Vite &amp; Gourmand livre dans un rayon de <strong>50 km</strong> autour de Bordeaux.</p>

        <p class="mentions-subtitle">5.2. Frais de livraison</p>
        <table class="mentions-table">
          <tr><td>Ã€ Bordeaux</td><td><strong>5,00 â‚¬</strong> forfaitaire</td></tr>
          <tr><td>Hors Bordeaux</td><td><strong>5,00 â‚¬</strong> + <strong>0,59 â‚¬</strong> par kilomÃ¨tre parcouru</td></tr>
        </table>

        <p class="mentions-subtitle">5.3. Horaires de livraison</p>
        <p class="mentions-text">Les livraisons sont effectuÃ©es du <strong>lundi au dimanche</strong>, de <strong>10h Ã  22h</strong>.</p>

        <p class="mentions-subtitle">5.4. Force majeure</p>
        <p class="mentions-text">Le prestataire ne saurait Ãªtre tenu pour responsable en cas de retard rÃ©sultant d'un Ã©vÃ©nement de force majeure (conditions mÃ©tÃ©orologiques exceptionnelles, grÃ¨ve, catastrophe naturelle, etc.).</p>
      </div>

      <!-- Art. 6 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ½ï¸ Article 6 â€“ PrÃªt de matÃ©riel</h3>

        <p class="mentions-subtitle">6.1. Conditions de prÃªt</p>
        <p class="mentions-text">Sur demande et selon disponibilitÃ©, Vite &amp; Gourmand peut prÃªter du matÃ©riel (vaisselle, couverts, plateaux, etc.).</p>

        <p class="mentions-subtitle">6.2. Restitution du matÃ©riel</p>
        <p class="mentions-text">Le matÃ©riel doit Ãªtre restituÃ© dans un dÃ©lai de <strong>10 jours ouvrÃ©s</strong> suivant la livraison.</p>

        <p class="mentions-subtitle">6.3. Non-restitution</p>
        <div style="background:rgba(123,28,42,0.05);border-left:3px solid var(--burgundy);padding:1rem 1.2rem;border-radius:0 4px 4px 0;margin:.5rem 0">
          <p style="font-size:.875rem;color:var(--burgundy);font-weight:500">âš ï¸ En cas de non-restitution dans les 10 jours ouvrÃ©s, des frais de <strong>600,00 â‚¬</strong> seront automatiquement facturÃ©s pour compenser le coÃ»t du matÃ©riel non restituÃ©.</p>
        </div>
      </div>

      <!-- Art. 7 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">âš ï¸ Article 7 â€“ AllergÃ¨nes et RÃ©gimes alimentaires</h3>
        <p class="mentions-text">Les informations sur les allergÃ¨nes sont fournies Ã  titre indicatif. Il est de la responsabilitÃ© de l'utilisateur de vÃ©rifier ces informations et de nous informer de toute allergie avant de passer commande.</p>
      </div>

      <!-- Art. 10 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸš« Article 10 â€“ Droit de rÃ©tractation</h3>
        <p class="mentions-text"><strong>Base lÃ©gale :</strong> ConformÃ©ment Ã  l'article L221-28 du Code de la consommation, le droit de rÃ©tractation de 14 jours ne s'applique pas aux contrats de restauration avec une date de prestation dÃ©terminÃ©e.</p>
        <div style="background:rgba(123,28,42,0.05);border-left:3px solid var(--burgundy);padding:1rem 1.2rem;border-radius:0 4px 4px 0;margin:.5rem 0">
          <p style="font-size:.875rem;color:var(--burgundy);font-weight:500">Aucun droit de rÃ©tractation ne peut Ãªtre exercÃ© pour les commandes de prestations traiteur comportant une date de prestation dÃ©terminÃ©e.</p>
        </div>
      </div>

      <!-- Art. 11 -->
      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ”’ Article 11 â€“ Protection des donnÃ©es personnelles (RGPD)</h3>

        <p class="mentions-subtitle">11.1. Responsable du traitement</p>
        <p class="mentions-text">Vite &amp; Gourmand SAS â€” Email : <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a5c6cacbd1c4c6d1e5d3ccd1c088c0d188c2cad0d7c8c4cbc18bc3d7">[<span class="__cf_email__" data-cfemail="c6a5a9a8b2a7a5b286b0afb2a3eba3b2eba1a9b3b4aba7a8a2e8a0b4">[email&#160;protected]</span>&#160;]</a></strong></p>

        <p class="mentions-subtitle">11.2. DonnÃ©es collectÃ©es</p>
        <ul class="mentions-list">
          <li><strong>DonnÃ©es d'identification :</strong> nom, prÃ©nom, email, tÃ©lÃ©phone</li>
          <li><strong>DonnÃ©es de livraison :</strong> adresse, instructions</li>
          <li><strong>DonnÃ©es de commande :</strong> historique, prÃ©fÃ©rences, allergies</li>
          <li><strong>DonnÃ©es de paiement :</strong> informations de facturation</li>
        </ul>

        <p class="mentions-subtitle">11.3. Vos droits</p>
        <ul class="mentions-list">
          <li>Droit d'accÃ¨s Ã  vos donnÃ©es</li>
          <li>Droit de rectification</li>
          <li>Droit Ã  l'effacement</li>
          <li>Droit Ã  la portabilitÃ©</li>
          <li>Droit d'opposition</li>
        </ul>
        <p class="mentions-text">Pour exercer vos droits : <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6d0e0203190c0e192d1b041908400819400a02181f000c0309430b1f">[<span class="__cf_email__" data-cfemail="03606c6d7762607743756a77662e66772e646c76716e626d672d6571">[email&#160;protected]</span>&#160;]</a></strong></p>
      </div>

      <!-- Art. 12 -->
      <div class="mentions-section" style="border-bottom:none;margin-bottom:0">
        <h3 class="mentions-h3">âš–ï¸ Article 12 â€“ Litiges</h3>

        <p class="mentions-subtitle">12.1. MÃ©diation</p>
        <p class="mentions-text">En cas de litige, l'utilisateur peut recourir Ã  :</p>
        <div style="background:var(--cream);padding:1rem 1.2rem;border-radius:4px;font-size:.875rem;line-height:1.7">
          <strong>CNPM â€“ MÃ‰DIATION DE LA CONSOMMATION</strong><br>
          23 rue de la Paix â€” 75002 Paris<br>
          Site : www.cnpm-mediation-consommation.eu
        </div>

        <p class="mentions-subtitle" style="margin-top:1.2rem">12.2. Droit applicable</p>
        <p class="mentions-text">Les prÃ©sentes CGV sont soumises au droit franÃ§ais. En cas de litige, les <strong>tribunaux de Bordeaux</strong> seront seuls compÃ©tents.</p>
      </div>

      <div style="margin-top:2rem;text-align:center">
        <button class="btn-primary" onclick="closeCGV()" style="padding:.8rem 2.5rem">Fermer</button>
      </div>
    </div>
  </div>
</div>

<!-- MENTIONS LÃ‰GALES MODAL -->
<div class="modal-overlay" id="mentionsOverlay" onclick="closeMentionsOutside(event)" style="align-items:flex-start;padding-top:4rem;overflow-y:auto">
  <div class="modal" style="max-width:780px">
    <div style="padding:2.5rem 3rem">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:2rem;padding-bottom:1.2rem;border-bottom:1px solid rgba(0,0,0,.08)">
        <div>
          <div style="font-size:.7rem;text-transform:uppercase;letter-spacing:.2em;color:var(--gold);margin-bottom:.4rem">Informations lÃ©gales</div>
          <h2 style="font-family:'Playfair Display',serif;font-size:1.8rem;font-weight:700;color:var(--charcoal)">Mentions LÃ©gales</h2>
          <p style="font-size:.8rem;color:var(--text-light);margin-top:.3rem">DerniÃ¨re mise Ã  jour : 03/01/2026</p>
        </div>
        <button class="modal-close" onclick="closeMentions()">âœ•</button>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ¢ 1. PrÃ©sentation du site</h3>
        <p class="mentions-subtitle">âœ¨ Nature du site</p>
        <p class="mentions-text">Site de vente en ligne de prestations de traiteur et livraison de repas pour Ã©vÃ©nements privÃ©s et professionnels.</p>
        <p class="mentions-subtitle" style="margin-top:1.2rem">ðŸ“œ Informations lÃ©gales</p>
        <table class="mentions-table">
          <tr><td>Raison sociale</td><td>Vite &amp; Gourmand</td></tr>
          <tr><td>Forme juridique</td><td>SAS (SociÃ©tÃ© par Actions SimplifiÃ©e)</td></tr>
          <tr><td>Capital social</td><td>15 000 â‚¬</td></tr>
          <tr><td>SIRET</td><td>156 456 789 00012</td></tr>
          <tr><td>RCS</td><td>Bordeaux B 156 456 789</td></tr>
          <tr><td>Code APE</td><td>5621Z (Services des traiteurs)</td></tr>
          <tr><td>TVA intracommunautaire</td><td>FR 12 156456789</td></tr>
          <tr><td>SiÃ¨ge social</td><td>12 Rue de la Brasserie, 33000 Bordeaux, France</td></tr>
          <tr><td>TÃ©lÃ©phone</td><td>+33 5 56 00 12 34</td></tr>
          <tr><td>Email</td><td><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aac9c5c4decbc9deeadcc3decf87cfde87cdc5dfd8c7cbc4ce84ccd8">[<span class="__cf_email__" data-cfemail="25464a4b5144465165534c514008405108424a505748444b410b4357">[email&#160;protected]</span>&#160;]</a></td></tr>
        </table>
        <p class="mentions-subtitle" style="margin-top:1.2rem">ðŸ‘¤ Directeur de publication</p>
        <p class="mentions-text">JosÃ© Lebon, Directeur GÃ©nÃ©ral</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ–¥ï¸ 2. HÃ©bergeur du site</h3>
        <p class="mentions-text"><strong>Nom :</strong> Netlify<br><strong>Site web :</strong> https://app.netlify.com</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">Â© 3. PropriÃ©tÃ© intellectuelle</h3>
        <p class="mentions-text">L'ensemble du contenu de ce site (textes, images, logos, graphismes, vidÃ©os) est la propriÃ©tÃ© exclusive de Vite &amp; Gourmand ou de ses partenaires. Toute reproduction, distribution, modification, adaptation, retransmission ou publication de ces diffÃ©rents Ã©lÃ©ments est strictement interdite sans l'accord Ã©crit prÃ©alable de Vite &amp; Gourmand.</p>
        <p class="mentions-text">Les marques et logos prÃ©sents sur le site sont des marques dÃ©posÃ©es. Toute reproduction totale ou partielle de ces marques sans autorisation expresse est prohibÃ©e.</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ”’ 4. Protection des donnÃ©es personnelles (RGPD)</h3>
        <p class="mentions-subtitle">4.1. Responsable du traitement</p>
        <p class="mentions-text">Le responsable du traitement des donnÃ©es personnelles est Vite &amp; Gourmand, reprÃ©sentÃ©e par JosÃ© LEBON, Directeur GÃ©nÃ©ral. <strong>Contact DPO :</strong> <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="dbb8b4b5afbab8af9badb2afbef6beaff6bcb4aea9b6bab5bff5bda9">[<span class="__cf_email__" data-cfemail="284b47465c494b5c685e415c4d054d5c054f475d5a4549464c064e5a">[email&#160;protected]</span>&#160;]</a></p>
        <p class="mentions-subtitle">4.2. DonnÃ©es collectÃ©es</p>
        <ul class="mentions-list">
          <li>Nom et prÃ©nom</li><li>Adresse email</li><li>NumÃ©ro de tÃ©lÃ©phone</li>
          <li>Adresse postale</li><li>Informations de commande</li><li>Avis et commentaires</li>
        </ul>
        <p class="mentions-subtitle">4.3. FinalitÃ©s du traitement</p>
        <ul class="mentions-list">
          <li>La gestion des commandes</li>
          <li>La crÃ©ation et la gestion de votre compte utilisateur</li>
          <li>L'envoi de communications relatives Ã  vos commandes</li>
          <li>L'amÃ©lioration de nos services</li>
          <li>Le respect de nos obligations lÃ©gales</li>
        </ul>
        <p class="mentions-subtitle">4.4. DurÃ©e de conservation</p>
        <ul class="mentions-list">
          <li>DonnÃ©es de compte : durÃ©e de la relation commerciale + 3 ans</li>
          <li>DonnÃ©es de commande : 10 ans (obligations comptables et fiscales)</li>
          <li>DonnÃ©es de prospection : 3 ans Ã  compter du dernier contact</li>
        </ul>
        <p class="mentions-subtitle">4.5. Vos droits</p>
        <ul class="mentions-list">
          <li><strong>Droit d'accÃ¨s :</strong> demander une copie de vos donnÃ©es</li>
          <li><strong>Droit de rectification :</strong> corriger vos donnÃ©es inexactes</li>
          <li><strong>Droit Ã  l'effacement :</strong> demander la suppression de vos donnÃ©es</li>
          <li><strong>Droit Ã  la portabilitÃ© :</strong> rÃ©cupÃ©rer vos donnÃ©es dans un format structurÃ©</li>
          <li><strong>Droit d'opposition :</strong> vous opposer au traitement</li>
          <li><strong>Droit Ã  la limitation :</strong> demander la limitation du traitement</li>
        </ul>
        <p class="mentions-text">Pour exercer ces droits : <strong><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="593a36372d383a2d192f302d3c743c2d743e362c2b3438373d773f2b">[<span class="__cf_email__" data-cfemail="7f1c10110b1e1c0b3f09160b1a521a0b5218100a0d121e111b51190d">[email&#160;protected]</span>&#160;]</a></strong> ou par courrier au siÃ¨ge social. Vous pouvez Ã©galement introduire une rÃ©clamation auprÃ¨s de la CNIL (www.cnil.fr).</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸª 5. Cookies</h3>
        <p class="mentions-text">Le site utilise des cookies pour amÃ©liorer votre expÃ©rience de navigation et assurer le bon fonctionnement du site.</p>
        <p class="mentions-subtitle">Types de cookies utilisÃ©s :</p>
        <ul class="mentions-list">
          <li><strong>Cookies essentiels :</strong> nÃ©cessaires au fonctionnement du site (session, authentification)</li>
          <li><strong>Cookies de performance :</strong> permettent d'amÃ©liorer les fonctionnalitÃ©s du site</li>
        </ul>
        <p class="mentions-text">ConformÃ©ment Ã  la rÃ©glementation RGPD et aux recommandations de la CNIL, un bandeau de consentement permet Ã  l'utilisateur d'accepter ou de refuser les cookies non essentiels lors de sa premiÃ¨re visite.</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ”— 6. Liens hypertextes</h3>
        <p class="mentions-text">Le site peut contenir des liens vers d'autres sites internet. Vite &amp; Gourmand ne saurait Ãªtre tenu responsable du contenu de ces sites externes.</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸ”’ 7. SÃ©curitÃ© et protection des Ã©changes</h3>
        <p class="mentions-text">Le site utilise le protocole HTTPS (SSL/TLS) garantissant la confidentialitÃ©, l'intÃ©gritÃ© et l'authentification des donnÃ©es Ã©changÃ©es. Les donnÃ©es de paiement sont traitÃ©es par des prestataires certifiÃ©s PCI DSS et ne sont jamais stockÃ©es sur nos serveurs.</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">ðŸŽ¨ 8. CrÃ©dits et propriÃ©tÃ© intellectuelle</h3>
        <p class="mentions-text">Site conÃ§u et dÃ©veloppÃ© par l'Ã©quipe Vite &amp; Gourmand.</p>
      </div>

      <div class="mentions-section">
        <h3 class="mentions-h3">âš ï¸ 9. Limitation de responsabilitÃ©</h3>
        <p class="mentions-text">Vite &amp; Gourmand s'efforce d'assurer l'exactitude et la mise Ã  jour des informations diffusÃ©es sur ce site. Toutefois, l'utilisateur reconnaÃ®t utiliser ces informations sous sa responsabilitÃ© exclusive.</p>
      </div>

      <div class="mentions-section" style="border-bottom:none;margin-bottom:0">
        <h3 class="mentions-h3">âš–ï¸ 10. Droit applicable</h3>
        <p class="mentions-text">Les prÃ©sentes mentions lÃ©gales sont rÃ©gies par le droit franÃ§ais. En cas de litige, les tribunaux franÃ§ais seront seuls compÃ©tents.</p>
      </div>

      <div style="margin-top:2rem;text-align:center">
        <button class="btn-primary" onclick="closeMentions()" style="padding:.8rem 2.5rem">Fermer</button>
      </div>
    </div>
  </div>
</div>

<!-- MENU DETAIL MODAL -->
<div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
  <div class="modal" id="modal">
    <div class="modal-img"><img id="modalImg" src="" alt=""></div>
    <div class="modal-content">
      <div class="modal-header">
        <div>
          <div id="modalBadge" class="card-badge" style="margin-bottom:.5rem"></div>
          <h2 class="modal-title" id="modalTitle"></h2>
        </div>
        <button class="modal-close" onclick="closeModalBtn()">âœ•</button>
      </div>
      <p class="modal-desc" id="modalDesc"></p>
      <div class="modal-details" id="modalDetails"></div>
      <div class="modal-order">
        <div class="qty-control">
          <button class="qty-btn" onclick="changeModalQty(-1)">âˆ’</button>
          <span class="qty-num" id="modalQty">1</span>
          <button class="qty-btn" onclick="changeModalQty(1)">+</button>
        </div>
        <span class="modal-price" id="modalPriceDisplay"></span>
        <button class="btn-add-cart" onclick="addFromModal()">Ajouter au panier</button>
      </div>
    </div>
  </div>
</div>

<!-- CART PANEL -->
<div class="cart-overlay" id="cartOverlay" onclick="closeCartOutside(event)">
  <div class="cart-panel">
    <div class="cart-header">
      <h2 class="cart-title">ðŸ› Mon panier</h2>
      <button class="cart-close" onclick="toggleCart()">âœ•</button>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <div class="cart-footer" id="cartFooter" style="display:none">
      <div class="cart-subtotal">
        <span class="label">Total</span>
        <span class="amount" id="cartTotal">0,00 â‚¬</span>
      </div>
      <button class="btn-checkout" onclick="openCheckout()">Commander maintenant â†’</button>
      <p class="cart-note">Livraison offerte Ã  partir de 150â‚¬ Â· Paiement sÃ©curisÃ©</p>
    </div>
  </div>
</div>

<!-- CHECKOUT MODAL -->
<div class="modal-overlay" id="checkoutOverlay" onclick="closeCheckoutOutside(event)">
  <div class="modal" id="checkoutModal" style="max-width:580px">
    <div class="checkout-form">
      <div class="modal-header" style="margin-bottom:1rem">
        <div>
          <h2 class="checkout-title">Finaliser ma commande</h2>
          <p class="checkout-subtitle">Ã‰tape 1 sur 2 â€” Informations de livraison</p>
        </div>
        <button class="modal-close" onclick="closeCheckout()">âœ•</button>
      </div>
      <div class="step-indicator">
        <div class="step active"><div class="step-num">1</div><span style="font-size:.8rem;color:var(--burgundy);font-weight:600">Livraison</span></div>
        <div class="step-divider"></div>
        <div class="step" id="step2"><div class="step-num">2</div><span style="font-size:.8rem;color:var(--text-light)">Paiement</span></div>
      </div>
      <div id="checkoutStep1">
        <div style="display:flex;flex-direction:column;gap:1rem">
          <div class="form-row">
            <div class="form-group"><label>PrÃ©nom</label><input type="text" id="co_prenom" placeholder="Julie" required></div>
            <div class="form-group"><label>Nom</label><input type="text" id="co_nom" placeholder="Dupont" required></div>
          </div>
          <div class="form-group"><label>Email</label><input type="email" id="co_email" placeholder="julie@email.fr" required></div>
          <div class="form-group"><label>TÃ©lÃ©phone</label><input type="tel" id="co_tel" placeholder="06 00 00 00 00"></div>
          <div class="form-group"><label>Adresse de livraison</label><input type="text" id="co_addr" placeholder="12 rue des Fleurs, 33000 Bordeaux"></div>
          <div class="form-group"><label>Date de l'Ã©vÃ©nement</label><input type="date" id="co_date"></div>
          <div class="form-group"><label>Heure souhaitÃ©e</label><input type="time" id="co_heure" value="12:00"></div>
          <div class="form-group"><label>Notes (optionnel)</label><textarea placeholder="Allergies, instructions particuliÃ¨res..."></textarea></div>
          <button class="btn-primary" style="align-self:flex-start;padding:.9rem 2.5rem" onclick="goToPayment()">Continuer â†’ Paiement</button>
        </div>
      </div>
      <div id="checkoutStep2" style="display:none">
        <div style="display:flex;flex-direction:column;gap:1rem">
          <div class="form-group"><label>NumÃ©ro de carte</label><input type="text" placeholder="1234 5678 9012 3456" maxlength="19" oninput="formatCard(this)"></div>
          <div class="form-row">
            <div class="form-group"><label>Expiration</label><input type="text" placeholder="MM/AA" maxlength="5" oninput="formatExpiry(this)"></div>
            <div class="form-group"><label>CVV</label><input type="text" placeholder="123" maxlength="3"></div>
          </div>
          <div class="form-group"><label>Nom sur la carte</label><input type="text" placeholder="Julie Dupont"></div>
          <div style="background:var(--cream);padding:1.2rem;border-radius:4px;margin:1rem 0">
            <div style="display:flex;justify-content:space-between;font-size:.9rem;margin-bottom:.5rem">
              <span>Sous-total</span><span id="co_subtotal" style="font-weight:600"></span>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:.9rem;margin-bottom:.5rem">
              <span>Livraison</span><span style="font-weight:600;color:#2d7a3a">Gratuite</span>
            </div>
            <div style="display:flex;justify-content:space-between;font-size:1.1rem;font-weight:700;border-top:1px solid rgba(0,0,0,.1);padding-top:.7rem">
              <span>Total</span><span style="color:var(--burgundy)" id="co_total"></span>
            </div>
          </div>
          <button class="btn-primary" style="padding:1rem;text-align:center;width:100%" onclick="confirmOrder()">âœ“ Confirmer et payer</button>
          <button onclick="backToDelivery()" style="background:none;border:none;color:var(--text-light);cursor:pointer;font-size:.85rem;text-align:center">â† Retour Ã  la livraison</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- DASHBOARD -->
<div class="dashboard-overlay" id="dashOverlay" onclick="closeDashOutside(event)">
  <div class="dashboard-panel">

    <!-- Header -->
    <div class="dash-header">
      <button class="dash-close" onclick="closeDashboard()">âœ•</button>
      <div class="dash-avatar" id="dashAvatar"></div>
      <div class="dash-name" id="dashName">Mon compte</div>
      <div class="dash-email" id="dashEmail"></div>
    </div>

    <!-- Tabs -->
    <div class="dash-tabs">
      <button class="dash-tab active" onclick="switchDashTab('orders', this)">ðŸ“¦ Commandes</button>
      <button class="dash-tab" onclick="switchDashTab('profile', this)">ðŸ‘¤ Profil</button>
      <button class="dash-tab" onclick="switchDashTab('addresses', this)">ðŸ“ Adresses</button>
      <button class="dash-tab" onclick="switchDashTab('security', this)">ðŸ”’ SÃ©curitÃ©</button>
      <button class="dash-tab" onclick="switchDashTab('prefs', this)">âš™ï¸ PrÃ©fÃ©rences</button>
    </div>

    <!-- Body -->
    <div class="dash-body">

      <!-- â”€ COMMANDES â”€ -->
      <div class="dash-section active" id="dash-orders">
        <div class="dash-section-title">ðŸ“¦ Mes commandes</div>
        <div id="ordersList"></div>
      </div>

      <!-- â”€ PROFIL â”€ -->
      <div class="dash-section" id="dash-profile">
        <div class="dash-section-title">ðŸ‘¤ Mon profil</div>
        <div class="profile-grid">
          <div class="form-group"><label>PrÃ©nom</label><input type="text" id="prof_prenom"></div>
          <div class="form-group"><label>Nom</label><input type="text" id="prof_nom"></div>
          <div class="form-group profile-full"><label>Email</label><input type="email" id="prof_email"></div>
          <div class="form-group"><label>TÃ©lÃ©phone</label><input type="tel" id="prof_tel" placeholder="06 00 00 00 00"></div>
          <div class="form-group"><label>Date de naissance</label><input type="date" id="prof_birth"></div>
          <div class="form-group profile-full">
            <label>RÃ©gime alimentaire</label>
            <select id="prof_diet">
              <option value="">Aucun</option>
              <option value="vegan">Vegan</option>
              <option value="vegetarien">VÃ©gÃ©tarien</option>
              <option value="sans-gluten">Sans gluten</option>
              <option value="halal">Halal</option>
              <option value="kasher">Kasher</option>
            </select>
          </div>
          <div class="form-group profile-full"><label>Allergies / Notes</label><textarea id="prof_allergies" placeholder="Indiquez vos allergies ou restrictions alimentaires..." style="min-height:80px;resize:vertical"></textarea></div>
        </div>
        <button class="dash-save-btn" onclick="saveProfile()">âœ“ Enregistrer les modifications</button>
      </div>

      <!-- â”€ ADRESSES â”€ -->
      <div class="dash-section" id="dash-addresses">
        <div class="dash-section-title">ðŸ“ Mes adresses</div>
        <div id="addressesList"></div>
        <button class="btn-add-address" onclick="showAddAddressForm()">+ Ajouter une adresse</button>
        <div id="addAddressForm" style="display:none;margin-top:1rem;background:white;padding:1.2rem;border-radius:4px;border:1px solid rgba(0,0,0,.06)">
          <div class="profile-grid">
            <div class="form-group profile-full">
              <label>IntitulÃ© (ex: Domicile, Bureau)</label>
              <input type="text" id="addr_label" placeholder="Domicile">
            </div>
            <div class="form-group profile-full"><label>Adresse</label><input type="text" id="addr_street" placeholder="12 rue des Fleurs"></div>
            <div class="form-group"><label>Code postal</label><input type="text" id="addr_zip" placeholder="33000" maxlength="5"></div>
            <div class="form-group"><label>Ville</label><input type="text" id="addr_city" placeholder="Bordeaux"></div>
            <div class="form-group profile-full"><label>ComplÃ©ment</label><input type="text" id="addr_extra" placeholder="BÃ¢timent, Ã©tage, digicode..."></div>
          </div>
          <div style="display:flex;gap:.8rem;margin-top:.8rem">
            <button class="dash-save-btn" style="flex:1;margin-top:0" onclick="saveAddress()">âœ“ Enregistrer</button>
            <button onclick="document.getElementById('addAddressForm').style.display='none'" style="flex:1;padding:.9rem;background:none;border:1.5px solid rgba(0,0,0,.12);border-radius:2px;cursor:pointer;font-size:.8rem;font-weight:500">Annuler</button>
          </div>
        </div>
      </div>

      <!-- â”€ SÃ‰CURITÃ‰ â”€ -->
      <div class="dash-section" id="dash-security">
        <div class="dash-section-title">ðŸ”’ SÃ©curitÃ© du compte</div>

        <div class="security-item">
          <div class="security-item-header">
            <span class="security-item-title">Changer le mot de passe</span>
          </div>
          <div class="security-item-desc" style="margin-bottom:1rem">DerniÃ¨re modification : jamais</div>
          <div style="display:flex;flex-direction:column;gap:.8rem">
            <div class="form-group"><label>Mot de passe actuel</label><input type="password" id="sec_current" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
            <div class="form-group">
              <label>Nouveau mot de passe</label>
              <input type="password" id="sec_new" placeholder="10 caractÃ¨res minimum" oninput="updateSecPasswordUI()">
              <div style="margin-top:.4rem">
                <div style="height:3px;background:#e0e0e0;border-radius:2px;overflow:hidden">
                  <div id="secPwdBar" style="height:100%;width:0%;transition:width .3s,background .3s;border-radius:2px"></div>
                </div>
              </div>
              <div style="display:flex;flex-direction:column;gap:.2rem;margin-top:.4rem">
                <div id="srule_len"     style="font-size:.72rem;color:var(--text-light);display:flex;align-items:center;gap:.35rem"><span class="rule-icon">â—‹</span> 10 caractÃ¨res minimum</div>
                <div id="srule_upper"   style="font-size:.72rem;color:var(--text-light);display:flex;align-items:center;gap:.35rem"><span class="rule-icon">â—‹</span> Une majuscule</div>
                <div id="srule_lower"   style="font-size:.72rem;color:var(--text-light);display:flex;align-items:center;gap:.35rem"><span class="rule-icon">â—‹</span> Une minuscule</div>
                <div id="srule_digit"   style="font-size:.72rem;color:var(--text-light);display:flex;align-items:center;gap:.35rem"><span class="rule-icon">â—‹</span> Un chiffre</div>
                <div id="srule_special" style="font-size:.72rem;color:var(--text-light);display:flex;align-items:center;gap:.35rem"><span class="rule-icon">â—‹</span> Un caractÃ¨re spÃ©cial</div>
              </div>
            </div>
            <div class="form-group"><label>Confirmer le nouveau mot de passe</label><input type="password" id="sec_confirm" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
            <button class="dash-save-btn" onclick="changePassword()">âœ“ Mettre Ã  jour le mot de passe</button>
          </div>
        </div>

        <div class="security-item">
          <div class="security-item-header">
            <span class="security-item-title">Supprimer mon compte</span>
          </div>
          <p class="security-item-desc" style="margin-bottom:1rem">Cette action est irrÃ©versible. Toutes vos donnÃ©es et commandes seront supprimÃ©es dÃ©finitivement.</p>
          <button onclick="confirmDeleteAccount()" style="padding:.7rem 1.4rem;background:none;border:1.5px solid #e53935;color:#e53935;border-radius:2px;font-size:.8rem;font-weight:600;letter-spacing:.06em;text-transform:uppercase;cursor:pointer;transition:all .2s" onmouseover="this.style.background='#e53935';this.style.color='white'" onmouseout="this.style.background='none';this.style.color='#e53935'">
            Supprimer mon compte
          </button>
        </div>
      </div>

      <!-- â”€ PRÃ‰FÃ‰RENCES â”€ -->
      <div class="dash-section" id="dash-prefs">
        <div class="dash-section-title">âš™ï¸ PrÃ©fÃ©rences</div>

        <div class="pref-toggle">
          <div class="pref-toggle-info">
            <h4>Emails de confirmation</h4>
            <p>Recevoir un email Ã  chaque commande</p>
          </div>
          <label class="toggle-switch"><input type="checkbox" id="pref_email_confirm" checked><span class="toggle-slider"></span></label>
        </div>
        <div class="pref-toggle">
          <div class="pref-toggle-info">
            <h4>Offres et promotions</h4>
            <p>Recevoir nos offres exclusives par email</p>
          </div>
          <label class="toggle-switch"><input type="checkbox" id="pref_marketing"><span class="toggle-slider"></span></label>
        </div>
        <div class="pref-toggle">
          <div class="pref-toggle-info">
            <h4>SMS de livraison</h4>
            <p>ÃŠtre notifiÃ© par SMS lors de la livraison</p>
          </div>
          <label class="toggle-switch"><input type="checkbox" id="pref_sms" checked><span class="toggle-slider"></span></label>
        </div>
        <div class="pref-toggle">
          <div class="pref-toggle-info">
            <h4>Rappel de commande</h4>
            <p>Rappel 48h avant votre Ã©vÃ©nement</p>
          </div>
          <label class="toggle-switch"><input type="checkbox" id="pref_reminder" checked><span class="toggle-slider"></span></label>
        </div>
        <div class="pref-toggle">
          <div class="pref-toggle-info">
            <h4>Newsletter mensuelle</h4>
            <p>Nos menus du mois et actualitÃ©s</p>
          </div>
          <label class="toggle-switch"><input type="checkbox" id="pref_newsletter"><span class="toggle-slider"></span></label>
        </div>
        <button class="dash-save-btn" onclick="savePrefs()">âœ“ Enregistrer les prÃ©fÃ©rences</button>
      </div>

      <button class="btn-logout" onclick="handleLogout()">â¬¡ Se dÃ©connecter</button>
    </div>
  </div>
</div>

<!-- LOGIN / REGISTER MODAL -->
<div class="modal-overlay" id="loginOverlay" onclick="closeLoginOutside(event)">
  <div class="modal" style="max-width:440px">
    <div style="padding:2.5rem">
      <div class="modal-header" style="margin-bottom:1.5rem">
        <div>
          <div id="authModalBadge" style="font-size:.7rem;text-transform:uppercase;letter-spacing:.2em;color:var(--gold);margin-bottom:.4rem">Votre espace</div>
          <h2 class="checkout-title" id="authModalTitle">Connexion</h2>
        </div>
        <button class="modal-close" onclick="closeLogin()">âœ•</button>
      </div>

      <!-- Tabs -->
      <div style="display:flex;border-bottom:2px solid rgba(0,0,0,.07);margin-bottom:1.8rem">
        <button id="tabLogin" onclick="switchAuthTab('login')" style="flex:1;padding:.7rem;background:none;border:none;font-family:'DM Sans',sans-serif;font-size:.85rem;font-weight:600;letter-spacing:.06em;text-transform:uppercase;cursor:pointer;border-bottom:2px solid var(--burgundy);margin-bottom:-2px;color:var(--burgundy);transition:all .2s">Connexion</button>
        <button id="tabRegister" onclick="switchAuthTab('register')" style="flex:1;padding:.7rem;background:none;border:none;font-family:'DM Sans',sans-serif;font-size:.85rem;font-weight:600;letter-spacing:.06em;text-transform:uppercase;cursor:pointer;border-bottom:2px solid transparent;margin-bottom:-2px;color:var(--text-light);transition:all .2s">S'inscrire</button>
      </div>

      <!-- Login Form -->
      <div id="formLogin" style="display:flex;flex-direction:column;gap:1rem">
        <div class="form-group"><label>Email</label><input type="email" id="login_email" placeholder="votre@email.fr"></div>
        <div class="form-group"><label>Mot de passe</label><input type="password" id="login_password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
        <button class="btn-primary" style="padding:.9rem;margin-top:.3rem" onclick="handleLogin()">Se connecter â†’</button>
        <p style="text-align:center;font-size:.75rem;color:var(--text-light)"><a href="#" style="color:var(--burgundy);text-decoration:none" onclick="showForgotPassword(event)">Mot de passe oubliÃ© ?</a></p>
      </div>

      <!-- Forgot Password â€” Step 1 : saisie email -->
      <div id="formForgot1" style="display:none;flex-direction:column;gap:1.2rem">
        <div style="text-align:center;margin-bottom:.5rem">
          <div style="font-size:2.5rem;margin-bottom:.8rem">ðŸ“§</div>
          <p style="font-size:.9rem;color:var(--text-light);line-height:1.6">Saisissez votre adresse email. Nous vous enverrons un code de vÃ©rification Ã  6 chiffres.</p>
        </div>
        <div class="form-group"><label>Adresse email</label><input type="email" id="forgot_email" placeholder="votre@email.fr"></div>
        <button class="btn-primary" style="padding:.9rem" onclick="sendResetCode()">Envoyer le code â†’</button>
        <p style="text-align:center;font-size:.75rem;color:var(--text-light)"><a href="#" style="color:var(--burgundy);text-decoration:none" onclick="switchAuthTab('login')">â† Retour Ã  la connexion</a></p>
      </div>

      <!-- Forgot Password â€” Step 2 : code de vÃ©rification -->
      <div id="formForgot2" style="display:none;flex-direction:column;gap:1.2rem">
        <div style="text-align:center;margin-bottom:.5rem">
          <div style="font-size:2.5rem;margin-bottom:.8rem">ðŸ”‘</div>
          <p style="font-size:.9rem;color:var(--text-light);line-height:1.6">Un code Ã  6 chiffres a Ã©tÃ© envoyÃ© Ã  <strong id="forgot_email_display"></strong>. Saisissez-le ci-dessous.</p>
        </div>
        <div class="form-group">
          <label>Code de vÃ©rification</label>
          <input type="text" id="forgot_code" placeholder="123456" maxlength="6"
            style="text-align:center;font-size:1.5rem;font-weight:700;letter-spacing:.4em"
            oninput="this.value=this.value.replace(/\D/g,'')">
        </div>
        <div id="forgot_code_hint" style="display:none;background:rgba(196,154,60,0.1);border:1px solid rgba(196,154,60,0.3);border-radius:4px;padding:.8rem 1rem;font-size:.8rem;color:#7a5c00;text-align:center"></div>
        <button class="btn-primary" style="padding:.9rem" onclick="verifyResetCode()">VÃ©rifier le code â†’</button>
        <p style="text-align:center;font-size:.75rem;color:var(--text-light)">
          Pas reÃ§u le code ? <a href="#" style="color:var(--burgundy);text-decoration:none" onclick="resendCode(event)">Renvoyer</a>
          &nbsp;Â·&nbsp; <a href="#" style="color:var(--burgundy);text-decoration:none" onclick="showForgotStep(1)">Changer d'email</a>
        </p>
      </div>

      <!-- Forgot Password â€” Step 3 : nouveau mot de passe -->
      <div id="formForgot3" style="display:none;flex-direction:column;gap:1.2rem">
        <div style="text-align:center;margin-bottom:.5rem">
          <div style="font-size:2.5rem;margin-bottom:.8rem">ðŸ”’</div>
          <p style="font-size:.9rem;color:var(--text-light);line-height:1.6">Choisissez un nouveau mot de passe sÃ©curisÃ© pour votre compte.</p>
        </div>
        <div class="form-group">
          <label>Nouveau mot de passe</label>
          <input type="password" id="new_password" placeholder="10 caractÃ¨res minimum" oninput="updateNewPasswordUI()">
          <div style="margin-top:.5rem">
            <div style="height:4px;background:#e0e0e0;border-radius:2px;overflow:hidden">
              <div id="newPwdStrengthBar" style="height:100%;width:0%;transition:width .3s,background .3s;border-radius:2px"></div>
            </div>
            <div style="display:flex;justify-content:flex-end;margin-top:.2rem">
              <span id="newPwdStrengthLabel" style="font-size:.7rem;font-weight:600;transition:color .3s"></span>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:.25rem;margin-top:.5rem">
            <div id="nrule_len"     style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> 10 caractÃ¨res minimum</div>
            <div id="nrule_upper"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Une lettre majuscule (Aâ€“Z)</div>
            <div id="nrule_lower"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Une lettre minuscule (aâ€“z)</div>
            <div id="nrule_digit"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Un chiffre (0â€“9)</div>
            <div id="nrule_special" style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Un caractÃ¨re spÃ©cial (!@#$%...)</div>
          </div>
        </div>
        <div class="form-group"><label>Confirmer le nouveau mot de passe</label><input type="password" id="new_password2" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
        <button class="btn-primary" style="padding:.9rem" onclick="resetPassword()">RÃ©initialiser le mot de passe â†’</button>
      </div>

      <!-- Register Form -->
      <div id="formRegister" style="display:none;flex-direction:column;gap:1rem">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
          <div class="form-group"><label>PrÃ©nom</label><input type="text" id="reg_prenom" placeholder="Julie"></div>
          <div class="form-group"><label>Nom</label><input type="text" id="reg_nom" placeholder="Dupont"></div>
        </div>
        <div class="form-group"><label>Email</label><input type="email" id="reg_email" placeholder="votre@email.fr"></div>
        <div class="form-group"><label>TÃ©lÃ©phone</label><input type="tel" id="reg_tel" placeholder="06 00 00 00 00"></div>
        <div class="form-group">
          <label>Mot de passe</label>
          <input type="password" id="reg_password" placeholder="10 caractÃ¨res minimum" oninput="updatePasswordUI()">
          <div style="margin-top:.5rem">
            <div style="height:4px;background:#e0e0e0;border-radius:2px;overflow:hidden">
              <div id="pwdStrengthBar" style="height:100%;width:0%;transition:width .3s,background .3s;border-radius:2px"></div>
            </div>
            <div style="display:flex;justify-content:flex-end;margin-top:.2rem">
              <span id="pwdStrengthLabel" style="font-size:.7rem;font-weight:600;transition:color .3s"></span>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:.25rem;margin-top:.5rem">
            <div id="rule_len"     style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> 10 caractÃ¨res minimum</div>
            <div id="rule_upper"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Une lettre majuscule (Aâ€“Z)</div>
            <div id="rule_lower"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Une lettre minuscule (aâ€“z)</div>
            <div id="rule_digit"   style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Un chiffre (0â€“9)</div>
            <div id="rule_special" style="font-size:.75rem;color:var(--text-light);display:flex;align-items:center;gap:.4rem;transition:color .2s"><span class="rule-icon">â—‹</span> Un caractÃ¨re spÃ©cial (!@#$%...)</div>
          </div>
        </div>
        <div class="form-group"><label>Confirmer le mot de passe</label><input type="password" id="reg_password2" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"></div>
        <button class="btn-primary" style="padding:.9rem;margin-top:.3rem" onclick="handleRegister()">CrÃ©er mon compte â†’</button>
        <p style="text-align:center;font-size:.75rem;color:var(--text-light)">En vous inscrivant, vous acceptez nos <a href="#" onclick="closeCGV();openCGV(event)" style="color:var(--burgundy);text-decoration:none">CGV</a>.</p>
      </div>
    </div>
  </div>
</div>

<!-- AUTH REQUIRED MODAL -->
<div class="modal-overlay" id="authRequiredOverlay" onclick="closeAuthRequired(event)">
  <div class="modal" style="max-width:420px">
    <div style="padding:3rem 2.5rem;text-align:center">
      <div style="font-size:3rem;margin-bottom:1rem">ðŸ”’</div>
      <h2 style="font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;color:var(--charcoal);margin-bottom:.7rem">Connexion requise</h2>
      <p style="color:var(--text-light);font-size:.9rem;line-height:1.6;margin-bottom:2rem">Vous devez Ãªtre connectÃ© pour ajouter des articles Ã  votre panier ou passer commande.</p>
      <div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap">
        <button class="btn-primary" style="padding:.8rem 1.8rem" onclick="closeAuthRequired();showLogin('login')">Se connecter</button>
        <button class="btn-secondary" style="padding:.8rem 1.8rem" onclick="closeAuthRequired();showLogin('register')">S'inscrire</button>
      </div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
// â”€â”€â”€ DATA â”€â”€â”€
const menus = [
  {
    id: 1, name: "Menu Buffet Festif", type: "classique", theme: "Buffet",
    desc: "Grande variÃ©tÃ© d'entrÃ©es, de plats et de desserts pour satisfaire tous vos convives.",
    fullDesc: "Un buffet copieux et festif avec une sÃ©lection de tartines garnies, charcuteries fines, salades composÃ©es, viandes rÃ´ties, lÃ©gumes grillÃ©s et une belle variÃ©tÃ© de desserts maison. IdÃ©al pour les grandes tablÃ©es conviviales.",
    price: 38, minPersons: 15,
    img: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=700&q=80",
    composition: ["Plateau de charcuteries et fromages", "Salades composÃ©es (3 variÃ©tÃ©s)", "Viandes froides et rÃ´ties", "LÃ©gumes grillÃ©s marinÃ©s", "Assortiment de desserts maison"],
    allergens: "Gluten, Lait, Å’ufs"
  },
  {
    id: 2, name: "Menu RÃ©ception Chic", type: "classique", theme: "RÃ©ception",
    desc: "Foie gras, magret de canard et desserts assortis pour une rÃ©ception Ã©lÃ©gante.",
    fullDesc: "Un menu raffinÃ© pensÃ© pour vos rÃ©ceptions les plus Ã©lÃ©gantes. Du foie gras de canard des Landes en entrÃ©e, un magret de canard aux cerises en plat principal, et une sÃ©lection de mignardises pour finir sur une note sucrÃ©e.",
    price: 50, minPersons: 8,
    img: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=700&q=80",
    composition: ["Foie gras de canard des Landes", "VeloutÃ© de champignons truffÃ©", "Magret de canard aux cerises", "Gratin dauphinois", "Mignardises et cafÃ©"],
    allergens: "Lait, Å’ufs, CÃ©rÃ©ales"
  },
  {
    id: 3, name: "Menu Cocktail Prestige", type: "classique", theme: "Cocktail",
    desc: "Assortiment variÃ© de canapÃ©s et bouchÃ©es pour votre Ã©vÃ©nement professionnel.",
    fullDesc: "Un cocktail dinatoire d'exception avec un assortiment de 12 piÃ¨ces variÃ©es par personne : blinis au saumon, verrines de foie gras, tartines gastronomiques, brochettes de crevettes et bouchÃ©es sucrÃ©es.",
    price: 42, minPersons: 10,
    img: "https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=700&q=80",
    composition: ["12 piÃ¨ces cocktail/personne", "Blinis au saumon fumÃ©", "Verrines apÃ©ritives (3 variÃ©tÃ©s)", "Brochettes de crevettes citronnÃ©es", "Mini desserts (4 variÃ©tÃ©s)"],
    allergens: "Gluten, Poisson, CrustacÃ©s, Lait"
  },
  {
    id: 4, name: "Menu Vegan Gourmand", type: "vegan", theme: "Vegan",
    desc: "Tartare de tomates, curry de lÃ©gumes et pavlova aux fruits de saison.",
    fullDesc: "Un menu 100% vÃ©gÃ©talien qui prouve que la cuisine vegan peut Ãªtre gastronomique. Des produits frais et de saison, des associations de saveurs originales pour une expÃ©rience culinaire raffinÃ©e.",
    price: 34, minPersons: 4,
    img: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=700&q=80",
    composition: ["Tartare de tomates heirloom et basilic", "VeloutÃ© de courge au lait de coco", "Curry de lÃ©gumes du marchÃ©", "Riz basmati aux herbes fraÃ®ches", "Pavlova aux fruits de saison"],
    allergens: "Sans produits animaux"
  },
  {
    id: 5, name: "Menu Vegan Nature", type: "vegan", theme: "Vegan",
    desc: "Houmous aux lÃ©gumes, curry de lÃ©gumes et mousse au chocolat vÃ©gÃ©tale.",
    fullDesc: "Un menu vegan accessible et savoureux, avec des recettes Ã©purÃ©es qui subliment les lÃ©gumes. IdÃ©al pour vos dÃ©jeuners en semaine ou vos petits comitÃ©s.",
    price: 30, minPersons: 2,
    img: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?w=700&q=80",
    composition: ["Houmous maison et cruditÃ©s", "Soupe de lÃ©gumes du jour", "Curry de pois chiches et Ã©pinards", "Boulgour aux herbes", "Mousse au chocolat vÃ©gÃ©tale"],
    allergens: "SÃ©same, Gluten"
  },
  {
    id: 6, name: "Menu VÃ©gÃ©tarien RaffinÃ©", type: "vegetarien", theme: "VÃ©gÃ©tarien",
    desc: "VeloutÃ© de lÃ©gumes, lasagnes vÃ©gÃ©tales et pavlova aux fruits.",
    fullDesc: "La cuisine vÃ©gÃ©tarienne dans toute sa splendeur. Des recettes Ã©laborÃ©es avec les meilleurs lÃ©gumes de saison, des sauces onctueuses et des desserts lÃ©gers et fruitÃ©s.",
    price: 36, minPersons: 2,
    img: "https://images.unsplash.com/photo-1498579150354-977475b7ea0b?w=700&q=80",
    composition: ["VeloutÃ© de lÃ©gumes printaniers", "Cake de lÃ©gumes aux herbes", "Lasagnes vÃ©gÃ©tales ricotta-Ã©pinards", "Salade verte en accompagnement", "Pavlova aux fruits rouges"],
    allergens: "Gluten, Lait, Å’ufs"
  },
  {
    id: 8, name: "Menu DÃ©couverte", type: "classique", theme: "DÃ©couverte",
    desc: "Å’ufs mimosa, sole meuniÃ¨re et tarte tatin pour une dÃ©couverte gourmande.",
    fullDesc: "Notre menu d'initiation Ã  la gastronomie franÃ§aise. Des classiques revisitÃ©s avec soin, idÃ©al pour dÃ©couvrir notre savoir-faire ou pour vos dÃ©jeuners d'affaires.",
    price: 35, minPersons: 2,
    img: "https://images.unsplash.com/photo-1567620832903-9fc6debc209f?w=700&q=80",
    composition: ["Å’ufs mimosa Ã  la truffe", "Bisque de homard", "Sole meuniÃ¨re et ses lÃ©gumes", "Pommes de terre grenailles", "Tarte tatin et crÃ¨me fraÃ®che"],
    allergens: "Gluten, Poisson, Lait, Å’ufs, Mollusques"
  },
  {
    id: 9, name: "Menu Gastronomique", type: "classique", theme: "Gastronomique",
    desc: "Foie gras, magret de canard et bÃ»che de NoÃ«l pour une expÃ©rience inoubliable.",
    fullDesc: "Notre menu signature, pensÃ© pour les occasions exceptionnelles. Une succession de plats raffinÃ©s qui cÃ©lÃ¨bre le meilleur de la gastronomie bordelaise.",
    price: 45, minPersons: 2,
    img: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=700&q=80",
    composition: ["Amuse-bouches variÃ©s", "Foie gras mi-cuit et sa brioche", "Soupe de truffes VGE", "Magret de canard au jus de cÃ¨pes", "Plateau de fromages affinÃ©s", "BÃ»che de NoÃ«l artisanale"],
    allergens: "Gluten, Lait, Å’ufs, Sulfites"
  },
  {
    id: 10, name: "Menu Terroir", type: "classique", theme: "Terroir",
    desc: "Terrine maison, confit de canard girondin et crÃ¨me brÃ»lÃ©e Ã  la vanille.",
    fullDesc: "Un hommage sincÃ¨re aux saveurs du Sud-Ouest. Nos recettes familiales revisitÃ©es avec les produits du terroir bordelais pour vous transporter dans les saveurs de la Gascogne.",
    price: 38, minPersons: 2,
    img: "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=700&q=80",
    composition: ["Terrine de canard maison et cornichons", "Soupe Ã  l'oignon gratinÃ©e", "Confit de canard girondin", "Sarladaises aux cÃ¨pes", "CrÃ¨me brÃ»lÃ©e Ã  la vanille Bourbon"],
    allergens: "Gluten, Lait, Å’ufs, Sulfites"
  },
  {
    id: 11, name: "Menu PÃ¢ques RaffinÃ©", type: "classique", theme: "PÃ¢ques",
    desc: "Carpaccio de bÅ“uf, sole meuniÃ¨re et tiramisu pour fÃªter PÃ¢ques.",
    fullDesc: "Un menu de PÃ¢ques Ã©lÃ©gant et printanier, mettant Ã  l'honneur les produits de saison. Une composition lÃ©gÃ¨re et savoureuse pour dÃ©jeuner en famille.",
    price: 48, minPersons: 2,
    img: "https://images.unsplash.com/photo-1476224203421-9ac39bcb3327?w=700&q=80",
    composition: ["Carpaccio de bÅ“uf et roquette", "VeloutÃ© d'asperges blanches", "Sole meuniÃ¨re et ses lÃ©gumes de printemps", "Pommes de terre nouvelles au beurre", "Tiramisu aux fraises"],
    allergens: "Gluten, Poisson, Lait, Å’ufs"
  },
  {
    id: 12, name: "Menu PÃ¢ques Gourmand", type: "classique", theme: "PÃ¢ques",
    desc: "Saumon fumÃ©, gigot d'agneau pascal et tarte au citron meringuÃ©e.",
    fullDesc: "Le grand menu de PÃ¢ques pour les familles gourmandes. Un gigot d'agneau cuit Ã  la perfection, des accompagnements gÃ©nÃ©reux et une tarte au citron qui ravira les papilles.",
    price: 52, minPersons: 4,
    img: "https://images.unsplash.com/photo-1555126634-323283e090fa?w=700&q=80",
    composition: ["Saumon fumÃ© de l'Atlantique", "FeuilletÃ© d'asperges vertes", "Gigot d'agneau Ã  l'ail et romarin", "Gratin de pommes de terre", "LÃ©gumes printaniers", "Tarte au citron meringuÃ©e"],
    allergens: "Gluten, Poisson, Lait, Å’ufs"
  },
  {
    id: 13, name: "Menu NoÃ«l Tradition", type: "classique", theme: "NoÃ«l",
    desc: "Saumon fumÃ©, magret de canard et profiteroles pour NoÃ«l.",
    fullDesc: "Retrouvez la magie de NoÃ«l avec notre menu traditionnel : les incontournables de la table de fÃªte rÃ©interprÃ©tÃ©s avec l'excellence de notre cuisine maison.",
    price: 55, minPersons: 4,
    img: "https://images.unsplash.com/photo-1576402187878-974f70c890a5?w=700&q=80",
    composition: ["Saumon fumÃ© Ã©cossais", "VeloutÃ© de chÃ¢taignes", "Magret de canard au miel et Ã©pices", "Gratin dauphinois", "Haricots verts sautÃ©s", "Profiteroles au chocolat chaud"],
    allergens: "Gluten, Poisson, Lait, Å’ufs, Sulfites"
  },
  {
    id: 14, name: "Menu NoÃ«l Prestige", type: "classique", theme: "NoÃ«l",
    desc: "Foie gras, chapon farci aux truffes et bÃ»che de NoÃ«l artisanale.",
    fullDesc: "Notre menu de rÃ©veillon par excellence. Un festin gastronomique qui cÃ©lÃ¨bre les saveurs de fin d'annÃ©e avec les plus beaux produits de la saison. Inoubliable.",
    price: 65, minPersons: 6,
    img: "https://images.unsplash.com/photo-1608270586620-248524c67de9?w=700&q=80",
    composition: ["Foie gras entier mi-cuit et brioche", "VeloutÃ© de homard", "Chapon de Bresse farci aux truffes", "Gratin de pommes de terre sarladaises", "Plateau de fromages affinÃ©s", "BÃ»che de NoÃ«l artisanale au pralinÃ©"],
    allergens: "Gluten, CrustacÃ©s, Lait, Å’ufs, Sulfites"
  }
];

const reviews = [
  { name: "Anne-Sophie M.", date: "13/02/2026", stars: 5, text: "Une expÃ©rience culinaire incroyable ! Le menu Gastronomique pour notre mariage a enchantÃ© tous nos invitÃ©s. Julie et JosÃ© sont des professionnels d'exception." },
  { name: "Pierre D.", date: "28/01/2026", stars: 5, text: "Commande pour notre sÃ©minaire d'entreprise de 40 personnes. Service impeccable, livraison Ã  l'heure et des plats d'une qualitÃ© remarquable. Je recommande !" },
  { name: "Camille R.", date: "15/01/2026", stars: 5, text: "Le menu NoÃ«l Prestige Ã©tait tout simplement divin. Mon chapon farci aux truffes a fait l'unanimitÃ© Ã  table. On commandera Ã  nouveau sans hÃ©siter." },
  { name: "FranÃ§ois L.", date: "03/01/2026", stars: 4, text: "TrÃ¨s bonne prestation pour notre repas du rÃ©veillon. Produits frais, prÃ©sentation soignÃ©e. Un lÃ©ger retard sur la livraison mais rien de rÃ©dhibitoire." },
  { name: "Isabelle T.", date: "22/12/2025", stars: 5, text: "Le menu Vegan Gourmand Ã©tait une rÃ©vÃ©lation ! Jamais pensÃ© qu'un repas 100% vÃ©gÃ©talien pouvait Ãªtre aussi raffinÃ©. Toute la famille a adorÃ©." },
  { name: "Marc B.", date: "10/12/2025", stars: 5, text: "Vite & Gourmand accompagne tous nos Ã©vÃ©nements depuis 3 ans maintenant. FiabilitÃ©, qualitÃ© et passion â€” trois valeurs qui dÃ©finissent parfaitement Julie et JosÃ©." }
];

// â”€â”€â”€ STATE â”€â”€â”€
let cart = [];
let activeMenu = null;
let modalQty = 1;

// â”€â”€â”€ RENDER MENUS â”€â”€â”€
function renderMenus(data) {
  const grid = document.getElementById('menusGrid');
  if (data.length === 0) {
    grid.innerHTML = '<div class="no-results"><p>Aucun menu ne correspond Ã  vos critÃ¨res. Essayez d\'Ã©largir votre recherche.</p></div>';
    return;
  }
  grid.innerHTML = data.map(m => `
    <div class="menu-card">
      <div class="card-img">
        <img src="${m.img}" alt="${m.name}" loading="lazy">
        <div class="card-badge ${m.type}">${m.type === 'vegan' ? 'Vegan' : m.type === 'vegetarien' ? 'VÃ©gÃ©tarien' : 'Classique'}</div>
      </div>
      <div class="card-body">
        <h3 class="card-name">${m.name}</h3>
        <p class="card-desc">${m.desc}</p>
        <p class="card-meta">Minimum ${m.minPersons} personne${m.minPersons > 1 ? 's' : ''}</p>
        <div class="card-footer">
          <div class="card-price">${m.price.toFixed(2).replace('.', ',')} â‚¬<span>/pers.</span></div>
          <div style="display:flex;gap:.5rem">
            <button class="btn-add" style="background:var(--cream);color:var(--burgundy);border:1.5px solid rgba(123,28,42,0.2)" onclick="openModal(${m.id})">
              DÃ©tails
            </button>
            <button class="btn-add" onclick="quickAdd(${m.id})">
              <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none"><path d="M12 5v14M5 12h14"/></svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  `).join('');
}

// â”€â”€â”€ FILTERS â”€â”€â”€
function filterMenus() {
  const type = document.getElementById('filterType').value;
  const persons = parseInt(document.getElementById('filterPersons').value) || 0;
  const theme = document.getElementById('filterTheme').value;
  const priceMin = parseFloat(document.getElementById('filterPriceMin').value) || 0;
  const priceMax = parseFloat(document.getElementById('filterPriceMax').value) || Infinity;

  const filtered = menus.filter(m => {
    if (type && m.type !== type) return false;
    if (persons && m.minPersons > persons) return false;
    if (theme && !m.name.includes(theme) && !m.theme.includes(theme)) return false;
    if (m.price < priceMin || m.price > priceMax) return false;
    return true;
  });
  renderMenus(filtered);
}

function resetFilters() {
  document.getElementById('filterType').value = '';
  document.getElementById('filterPersons').value = '';
  document.getElementById('filterTheme').value = '';
  document.getElementById('filterPriceMin').value = '';
  document.getElementById('filterPriceMax').value = '';
  renderMenus(menus);
}

// â”€â”€â”€ MODAL â”€â”€â”€
function openModal(id) {
  const m = menus.find(x => x.id === id);
  activeMenu = m;
  modalQty = 1;
  document.getElementById('modalImg').src = m.img;
  document.getElementById('modalTitle').textContent = m.name;
  document.getElementById('modalBadge').textContent = m.type === 'vegan' ? 'Vegan' : m.type === 'vegetarien' ? 'VÃ©gÃ©tarien' : 'Classique';
  document.getElementById('modalBadge').className = 'card-badge ' + m.type;
  document.getElementById('modalDesc').textContent = m.fullDesc;
  document.getElementById('modalQty').textContent = '1';
  updateModalPrice();
  document.getElementById('modalDetails').innerHTML = `
    <div class="modal-detail-item"><div class="modal-detail-label">Prix</div><div class="modal-detail-value">${m.price.toFixed(2).replace('.', ',')} â‚¬/pers.</div></div>
    <div class="modal-detail-item"><div class="modal-detail-label">Min. personnes</div><div class="modal-detail-value">${m.minPersons} personnes</div></div>
    <div class="modal-detail-item"><div class="modal-detail-label">Composition</div><div class="modal-detail-value" style="font-size:.85rem;font-weight:400;color:var(--text-light)">${m.composition.join(' â€¢ ')}</div></div>
    <div class="modal-detail-item"><div class="modal-detail-label">AllergÃ¨nes</div><div class="modal-detail-value" style="font-size:.85rem;font-weight:400;color:var(--text-light)">${m.allergens}</div></div>
  `;
  document.getElementById('modalOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function updateModalPrice() {
  if (!activeMenu) return;
  document.getElementById('modalPriceDisplay').textContent = (activeMenu.price * modalQty).toFixed(2).replace('.', ',') + ' â‚¬';
}

function changeModalQty(delta) {
  modalQty = Math.max(1, modalQty + delta);
  document.getElementById('modalQty').textContent = modalQty;
  updateModalPrice();
}

function closeModal(e) {
  if (e.target === document.getElementById('modalOverlay')) closeModalBtn();
}
function closeModalBtn() {
  document.getElementById('modalOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

function addFromModal() {
  if (!activeMenu) return;
  requireAuth(() => {
    addToCart(activeMenu, modalQty);
    closeModalBtn();
    showToast(`${activeMenu.name} ajoutÃ© au panier !`);
  });
}

function quickAdd(id) {
  const m = menus.find(x => x.id === id);
  requireAuth(() => {
    addToCart(m, 1);
    showToast(`${m.name} ajoutÃ© au panier !`);
  });
}

// â”€â”€â”€ CART â”€â”€â”€
function addToCart(menu, qty) {
  const existing = cart.find(i => i.id === menu.id);
  if (existing) {
    existing.qty += qty;
  } else {
    cart.push({ ...menu, qty });
  }
  updateCart();
}

function updateCart() {
  const total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);
  const count = cart.reduce((sum, i) => sum + i.qty, 0);
  
  const countEl = document.getElementById('cartCount');
  countEl.textContent = count;
  countEl.style.display = count > 0 ? 'flex' : 'none';
  
  const itemsEl = document.getElementById('cartItems');
  const footerEl = document.getElementById('cartFooter');
  
  if (cart.length === 0) {
    itemsEl.innerHTML = `<div class="cart-empty"><div class="cart-empty-icon">ðŸ›</div><p>Votre panier est vide.<br>DÃ©couvrez nos menus pour commencer.</p></div>`;
    footerEl.style.display = 'none';
  } else {
    itemsEl.innerHTML = cart.map(i => `
      <div class="cart-item">
        <div class="cart-item-img"><img src="${i.img}" alt="${i.name}"></div>
        <div class="cart-item-info">
          <div class="cart-item-name">${i.name}</div>
          <div class="cart-item-price">${i.price.toFixed(2).replace('.', ',')} â‚¬/pers.</div>
        </div>
        <div class="cart-item-qty">
          <button onclick="changeCartQty(${i.id}, -1)">âˆ’</button>
          <span>${i.qty}</span>
          <button onclick="changeCartQty(${i.id}, 1)">+</button>
        </div>
        <div class="cart-item-total">${(i.price * i.qty).toFixed(2).replace('.', ',')} â‚¬</div>
      </div>
    `).join('');
    document.getElementById('cartTotal').textContent = total.toFixed(2).replace('.', ',') + ' â‚¬';
    footerEl.style.display = 'block';
  }
}

function changeCartQty(id, delta) {
  const idx = cart.findIndex(i => i.id === id);
  if (idx === -1) return;
  cart[idx].qty += delta;
  if (cart[idx].qty <= 0) cart.splice(idx, 1);
  updateCart();
}

function toggleCart() {
  document.getElementById('cartOverlay').classList.toggle('open');
  document.body.style.overflow = document.getElementById('cartOverlay').classList.contains('open') ? 'hidden' : '';
}

function closeCartOutside(e) {
  if (e.target === document.getElementById('cartOverlay')) toggleCart();
}

// â”€â”€â”€ CHECKOUT â”€â”€â”€
function openCheckout() {
  requireAuth(() => {
    toggleCart();
    const total = cart.reduce((sum, i) => sum + i.price * i.qty, 0);
    document.getElementById('co_subtotal').textContent = total.toFixed(2).replace('.', ',') + ' â‚¬';
    document.getElementById('co_total').textContent = total.toFixed(2).replace('.', ',') + ' â‚¬';
    document.getElementById('checkoutStep1').style.display = 'block';
    document.getElementById('checkoutStep2').style.display = 'none';
    document.getElementById('step2').classList.remove('active');
    // Pre-fill checkout with user data
    if (currentUser) {
      const el = document.getElementById('co_prenom');
      const el2 = document.getElementById('co_email');
      if (el) el.value = currentUser.prenom || '';
      if (el2) el2.value = currentUser.email || '';
    }
    document.getElementById('checkoutOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';
  });
}

function goToPayment() {
  document.getElementById('checkoutStep1').style.display = 'none';
  document.getElementById('checkoutStep2').style.display = 'block';
  document.getElementById('step2').classList.add('active');
}

function backToDelivery() {
  document.getElementById('checkoutStep1').style.display = 'block';
  document.getElementById('checkoutStep2').style.display = 'none';
  document.getElementById('step2').classList.remove('active');
}

function confirmOrder() {
  document.getElementById('checkoutModal').innerHTML = `
    <div class="confirmed-msg" style="padding:4rem 2rem">
      <div class="icon">ðŸŽ‰</div>
      <h3>Commande confirmÃ©e !</h3>
      <p style="margin-top:.8rem">Merci pour votre commande. Vous recevrez une confirmation par email dans quelques minutes.<br><br>Notre Ã©quipe vous contactera pour finaliser les dÃ©tails de votre Ã©vÃ©nement.</p>
      <button class="btn-primary" style="margin-top:2rem" onclick="closeCheckout();cart=[];updateCart();">Retour Ã  l'accueil</button>
    </div>
  `;
}

function closeCheckout() {
  document.getElementById('checkoutOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

function closeCheckoutOutside(e) {
  if (e.target === document.getElementById('checkoutOverlay')) closeCheckout();
}

// â”€â”€â”€ CARD FORMATTING â”€â”€â”€
function formatCard(input) {
  let v = input.value.replace(/\s/g, '').replace(/\D/g, '');
  let chunks = v.match(/.{1,4}/g);
  input.value = chunks ? chunks.join(' ') : v;
}
function formatExpiry(input) {
  let v = input.value.replace(/\D/g, '');
  if (v.length > 2) v = v.substring(0,2) + '/' + v.substring(2);
  input.value = v;
}

// â”€â”€â”€ AUTH STATE â”€â”€â”€
let isLoggedIn = false;
let currentUser = null;

function updateNavAuth() {
  const btnLogin = document.getElementById('navConnexion');
  const btnRegister = document.getElementById('navInscrire');
  const btnUser = document.getElementById('navUser');
  if (isLoggedIn && currentUser) {
    btnLogin.style.display = 'none';
    btnRegister.style.display = 'none';
    btnUser.style.display = 'flex';
    document.getElementById('navUserName').textContent = currentUser.prenom;
  } else {
    btnLogin.style.display = '';
    btnRegister.style.display = '';
    btnUser.style.display = 'none';
  }
}

function handleLogin() {
  const email = document.getElementById('login_email').value.trim();
  const password = document.getElementById('login_password').value;
  if (!email || !password) { showToast('Veuillez remplir tous les champs.'); return; }
  // Simulate login â€” in production this would call an API
  isLoggedIn = true;
  currentUser = { prenom: email.split('@')[0], email };
  closeLogin();
  updateNavAuth();
  showToast('Bienvenue ' + currentUser.prenom + ' !');
  // If a deferred action exists, execute it
  if (pendingAction) { pendingAction(); pendingAction = null; }
}

// â”€â”€â”€ PASSWORD VALIDATION â”€â”€â”€
function validatePassword(pwd) {
  if (pwd.length < 10)            return 'Le mot de passe doit contenir au moins 10 caractÃ¨res.';
  if (!/[A-Z]/.test(pwd))         return 'Le mot de passe doit contenir au moins une majuscule.';
  if (!/[a-z]/.test(pwd))         return 'Le mot de passe doit contenir au moins une minuscule.';
  if (!/[0-9]/.test(pwd))         return 'Le mot de passe doit contenir au moins un chiffre.';
  if (!/[^A-Za-z0-9]/.test(pwd))  return 'Le mot de passe doit contenir au moins un caractÃ¨re spÃ©cial (!@#$%...).';
  return null;
}

function checkPasswordStrength(pwd) {
  let score = 0;
  if (pwd.length >= 10)           score++;
  if (/[A-Z]/.test(pwd))          score++;
  if (/[a-z]/.test(pwd))          score++;
  if (/[0-9]/.test(pwd))          score++;
  if (/[^A-Za-z0-9]/.test(pwd))   score++;
  return score; // 0â€“5
}

function updatePasswordUI() {
  const pwd = document.getElementById('reg_password').value;
  const score = checkPasswordStrength(pwd);
  const bar = document.getElementById('pwdStrengthBar');
  const label = document.getElementById('pwdStrengthLabel');
  const rules = {
    rule_len:     pwd.length >= 10,
    rule_upper:   /[A-Z]/.test(pwd),
    rule_lower:   /[a-z]/.test(pwd),
    rule_digit:   /[0-9]/.test(pwd),
    rule_special: /[^A-Za-z0-9]/.test(pwd),
  };
  // Update rule checklist
  Object.entries(rules).forEach(([id, ok]) => {
    const el = document.getElementById(id);
    if (el) {
      el.style.color = ok ? '#2d7a3a' : 'var(--text-light)';
      el.querySelector('.rule-icon').textContent = ok ? 'âœ“' : 'â—‹';
    }
  });
  // Strength bar
  const colors = ['#e0e0e0','#e53935','#ff9800','#fdd835','#66bb6a','#2e7d32'];
  const labels = ['','TrÃ¨s faible','Faible','Moyen','Fort','TrÃ¨s fort'];
  if (bar) { bar.style.width = (score * 20) + '%'; bar.style.background = colors[score]; }
  if (label) { label.textContent = pwd.length ? labels[score] : ''; label.style.color = colors[score]; }
}

function handleRegister() {
  const prenom = document.getElementById('reg_prenom').value.trim();
  const nom = document.getElementById('reg_nom').value.trim();
  const email = document.getElementById('reg_email').value.trim();
  const password = document.getElementById('reg_password').value;
  const password2 = document.getElementById('reg_password2').value;
  if (!prenom || !nom || !email || !password) { showToast('Veuillez remplir tous les champs.'); return; }
  if (password !== password2) { showToast('Les mots de passe ne correspondent pas.'); return; }
  const pwdError = validatePassword(password);
  if (pwdError) { showToast(pwdError); return; }
  // Simulate registration
  isLoggedIn = true;
  currentUser = { prenom, nom, email };
  closeLogin();
  updateNavAuth();
  showToast('Compte crÃ©Ã© ! Bienvenue ' + prenom + ' ðŸŽ‰');
  if (pendingAction) { pendingAction(); pendingAction = null; }
}

function handleLogout() {
  isLoggedIn = false;
  currentUser = null;
  cart = [];
  updateCart();
  updateNavAuth();
  showToast('Vous Ãªtes dÃ©connectÃ©(e).');
}

// Pending action to execute after login
let pendingAction = null;

function requireAuth(action) {
  if (isLoggedIn) {
    action();
  } else {
    pendingAction = action;
    document.getElementById('authRequiredOverlay').classList.add('open');
    document.body.style.overflow = 'hidden';
  }
}

function closeAuthRequired(e) {
  if (!e || e.target === document.getElementById('authRequiredOverlay')) {
    document.getElementById('authRequiredOverlay').classList.remove('open');
    document.body.style.overflow = '';
  }
}

// â”€â”€â”€ DASHBOARD â”€â”€â”€
// Sample order history
// statuses: 'pending' | 'accepted' | 'in_preparation' | 'delivering' | 'delivered' | 'cancelled'
// 'pending' = en attente acceptation employÃ© â†’ user can cancel/edit
// 'accepted' and beyond â†’ suivi visible, no more cancel/edit
// 'delivered' = terminÃ©e â†’ user can leave review
const sampleOrders = [
  {
    id: 'VG-2026-001', menu: 'Menu Gastronomique', menuId: 9, persons: 8,
    date: '14/02/2026', event: '14/02/2026', eventTime: '13:00',
    addr: '15 allÃ©e des Roses, 33000 Bordeaux', notes: '',
    status: 'delivered', total: 360, review: null,
    history: [
      { status: 'pending',        label: 'Commande reÃ§ue',       date: '14/02/2026 09:12' },
      { status: 'accepted',       label: 'Commande acceptÃ©e',     date: '14/02/2026 10:30' },
      { status: 'in_preparation', label: 'En prÃ©paration',        date: '14/02/2026 11:00' },
      { status: 'delivering',     label: 'En cours de livraison', date: '14/02/2026 12:40' },
      { status: 'delivered',      label: 'LivrÃ©e â€” TerminÃ©e',     date: '14/02/2026 13:05' },
    ]
  },
  {
    id: 'VG-2026-002', menu: 'Menu NoÃ«l Prestige', menuId: 14, persons: 12,
    date: '28/01/2026', event: '31/12/2025', eventTime: '20:00',
    addr: '47 cours de l\'Intendance, 33000 Bordeaux', notes: 'EntrÃ©e par la cour',
    status: 'delivered', total: 780,
    review: { stars: 5, comment: 'Exceptionnel ! Toute la famille a adorÃ©.', date: '01/01/2026 10:15' },
    history: [
      { status: 'pending',        label: 'Commande reÃ§ue',       date: '28/01/2026 14:00' },
      { status: 'accepted',       label: 'Commande acceptÃ©e',     date: '28/01/2026 15:20' },
      { status: 'in_preparation', label: 'En prÃ©paration',        date: '31/12/2025 16:00' },
      { status: 'delivering',     label: 'En cours de livraison', date: '31/12/2025 19:30' },
      { status: 'delivered',      label: 'LivrÃ©e â€” TerminÃ©e',     date: '31/12/2025 19:58' },
    ]
  },
  {
    id: 'VG-2026-003', menu: 'Menu Buffet Festif', menuId: null, persons: 25,
    date: '05/02/2026', event: '22/02/2026', eventTime: '12:30',
    addr: '12 rue de la Brasserie, 33000 Bordeaux', notes: '',
    status: 'in_preparation', total: 950, review: null,
    history: [
      { status: 'pending',        label: 'Commande reÃ§ue',       date: '05/02/2026 10:00' },
      { status: 'accepted',       label: 'Commande acceptÃ©e',     date: '06/02/2026 09:15' },
      { status: 'in_preparation', label: 'En prÃ©paration',        date: '21/02/2026 08:00' },
    ]
  },
  {
    id: 'VG-2026-004', menu: 'Menu Cocktail Prestige', menuId: null, persons: 30,
    date: '10/02/2026', event: '01/03/2026', eventTime: '18:00',
    addr: '3 place de la Victoire, 33000 Bordeaux', notes: 'Sonner 2 fois',
    status: 'pending', total: 1260, review: null,
    history: [
      { status: 'pending', label: 'Commande reÃ§ue', date: '10/02/2026 16:45' },
    ]
  },
  {
    id: 'VG-2026-005', menu: 'Menu Vegan Gourmand', menuId: 5, persons: 6,
    date: '12/02/2026', event: '15/02/2026', eventTime: '19:30',
    addr: '22 rue Saint-Catherine, 33000 Bordeaux', notes: '',
    status: 'accepted', total: 180, review: null,
    history: [
      { status: 'pending',  label: 'Commande reÃ§ue',    date: '12/02/2026 11:00' },
      { status: 'accepted', label: 'Commande acceptÃ©e', date: '12/02/2026 14:30' },
    ]
  },
];

let userAddresses = [
  { id: 1, label: 'Domicile', street: '15 allÃ©e des Roses', zip: '33000', city: 'Bordeaux', extra: 'BÃ¢t. B, code 4521' },
  { id: 2, label: 'Bureau', street: '47 cours de l\'Intendance', zip: '33000', city: 'Bordeaux', extra: '' },
];

function openDashboard() {
  if (!isLoggedIn || !currentUser) { showLogin('login'); return; }
  const overlay = document.getElementById('dashOverlay');
  // Populate header
  document.getElementById('dashAvatar').textContent = (currentUser.prenom || '?')[0].toUpperCase();
  document.getElementById('dashName').textContent = (currentUser.prenom || '') + ' ' + (currentUser.nom || '');
  document.getElementById('dashEmail').textContent = currentUser.email || '';
  // Populate profile fields
  document.getElementById('prof_prenom').value = currentUser.prenom || '';
  document.getElementById('prof_nom').value = currentUser.nom || '';
  document.getElementById('prof_email').value = currentUser.email || '';
  document.getElementById('prof_tel').value = currentUser.tel || '';
  document.getElementById('prof_birth').value = currentUser.birth || '';
  document.getElementById('prof_diet').value = currentUser.diet || '';
  document.getElementById('prof_allergies').value = currentUser.allergies || '';
  // Render orders & addresses
  renderOrders();
  renderAddresses();
  // Switch to orders tab
  switchDashTab('orders', document.querySelector('.dash-tab'));
  overlay.classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeDashboard() {
  document.getElementById('dashOverlay').classList.remove('open');
  document.body.style.overflow = '';
}
function closeDashOutside(e) {
  if (e.target === document.getElementById('dashOverlay')) closeDashboard();
}

function switchDashTab(name, btn) {
  document.querySelectorAll('.dash-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.dash-tab').forEach(t => t.classList.remove('active'));
  document.getElementById('dash-' + name).classList.add('active');
  if (btn) btn.classList.add('active');
}

// Orders
const ORDER_STATUS_MAP = {
  pending:        { label: 'En attente',       cls: 'status-pending',   icon: 'â³' },
  accepted:       { label: 'AcceptÃ©e',         cls: 'status-confirmed', icon: 'âœ…' },
  in_preparation: { label: 'En prÃ©paration',   cls: 'status-confirmed', icon: 'ðŸ‘¨â€ðŸ³' },
  delivering:     { label: 'En livraison',     cls: 'status-confirmed', icon: 'ðŸš—' },
  delivered:      { label: 'TerminÃ©e',         cls: 'status-delivered', icon: 'ðŸŽ‰' },
  cancelled:      { label: 'AnnulÃ©e',          cls: 'status-cancelled', icon: 'âœ•'  },
};

function renderOrders() {
  const list = document.getElementById('ordersList');
  const active = sampleOrders.filter(o => o.status !== 'cancelled');
  const cancelled = sampleOrders.filter(o => o.status === 'cancelled');
  const all = [...active, ...cancelled];
  if (all.length === 0) {
    list.innerHTML = '<div class="dash-empty"><div class="icon">ðŸ“¦</div><p>Aucune commande pour le moment.</p></div>';
    return;
  }
  list.innerHTML = all.map(o => {
    const s = ORDER_STATUS_MAP[o.status] || ORDER_STATUS_MAP.pending;
    const canEdit = o.status === 'pending';
    const canTrack = o.status !== 'pending' && o.status !== 'cancelled';
    const canReview = o.status === 'delivered' && !o.review;
    const hasReview = o.status === 'delivered' && o.review;
    return `
      <div class="order-card" style="${o.status === 'cancelled' ? 'opacity:.6' : ''}">
        <div class="order-header">
          <div>
            <div class="order-id">RÃ©f. ${o.id}</div>
            <div class="order-menu">${o.menu}</div>
          </div>
          <span class="order-status ${s.cls}">${s.icon} ${s.label}</span>
        </div>
        <div class="order-meta">
          <span>ðŸ‘¥ ${o.persons} personnes</span>
          <span>ðŸ“… Ã‰vÃ©nement : ${o.event} Ã  ${o.eventTime || 'â€”'}</span>
          <span>ðŸ—“ CommandÃ© le ${o.date}</span>
        </div>
        <div class="order-footer">
          <span class="order-total">${o.total.toFixed(2).replace('.', ',')} â‚¬</span>
          <div style="display:flex;gap:.5rem;flex-wrap:wrap;justify-content:flex-end">
            ${canEdit ? `<button class="btn-order-action" style="border-color:rgba(229,57,53,0.3);color:#e53935" onclick="cancelOrder('${o.id}')">âœ• Annuler</button>` : ''}
            ${canEdit ? `<button class="btn-order-action" onclick="openOrderEdit('${o.id}')">âœï¸ Modifier</button>` : ''}
            ${canTrack ? `<button class="btn-order-action" onclick="openOrderDetail('${o.id}', 'track')">ðŸ“ Suivi</button>` : ''}
            ${canReview ? `<button class="btn-order-action" style="border-color:rgba(196,154,60,0.4);color:#7a5c00" onclick="openOrderDetail('${o.id}', 'review')">â­ Donner un avis</button>` : ''}
            ${hasReview ? `<span style="font-size:.72rem;color:#2d7a3a;font-weight:600">â­ Avis donnÃ©</span>` : ''}
            <button class="btn-order-action" onclick="openOrderDetail('${o.id}', 'detail')">ðŸ” DÃ©tail</button>
          </div>
        </div>
      </div>`;
  }).join('');
}

function cancelOrder(id) {
  if (!confirm('Annuler la commande ' + id + ' ?')) return;
  const o = sampleOrders.find(x => x.id === id);
  if (!o) return;
  o.status = 'cancelled';
  o.history.push({ status: 'cancelled', label: 'Commande annulÃ©e par l\'utilisateur', date: nowDateTime() });
  renderOrders();
  showToast('Commande ' + id + ' annulÃ©e.');
}

function nowDateTime() {
  const d = new Date();
  return d.toLocaleDateString('fr-FR') + ' ' + d.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
}

// â”€â”€â”€ ORDER DETAIL PANEL â”€â”€â”€
function openOrderDetail(id, tab) {
  const o = sampleOrders.find(x => x.id === id);
  if (!o) return;
  renderOrderDetailPanel(o, tab || 'detail');
  document.getElementById('orderDetailOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeOrderDetail() {
  document.getElementById('orderDetailOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

function closeOrderDetailOutside(e) {
  if (e.target === document.getElementById('orderDetailOverlay')) closeOrderDetail();
}

function openOrderEdit(id) {
  openOrderDetail(id, 'edit');
}

function renderOrderDetailPanel(o, activeTab) {
  const s = ORDER_STATUS_MAP[o.status] || ORDER_STATUS_MAP.pending;
  const canEdit = o.status === 'pending';
  const canTrack = o.status !== 'pending' && o.status !== 'cancelled';
  const canReview = o.status === 'delivered' && !o.review;

  // Build tabs
  const tabs = [{ id: 'detail', icon: 'ðŸ”', label: 'DÃ©tail' }];
  if (canTrack || o.status === 'delivered') tabs.push({ id: 'track', icon: 'ðŸ“', label: 'Suivi' });
  if (canEdit) tabs.push({ id: 'edit', icon: 'âœï¸', label: 'Modifier' });
  if (canReview) tabs.push({ id: 'review', icon: 'â­', label: 'Mon avis' });
  if (o.review) tabs.push({ id: 'review', icon: 'â­', label: 'Mon avis' });

  const tabHtml = tabs.map(t => `
    <button onclick="switchOrderTab('${t.id}', '${o.id}')"
      id="odp-tab-${t.id}"
      style="flex:1;padding:.65rem .4rem;background:none;border:none;font-family:'DM Sans',sans-serif;
             font-size:.73rem;font-weight:600;letter-spacing:.04em;text-transform:uppercase;cursor:pointer;
             border-bottom:2px solid ${t.id === activeTab ? 'var(--burgundy)' : 'transparent'};
             color:${t.id === activeTab ? 'var(--burgundy)' : 'var(--text-light)'};
             white-space:nowrap;transition:all .2s">
      ${t.icon} ${t.label}
    </button>`).join('');

  // Detail tab
  const detailContent = `
    <div class="odp-info-grid">
      <div class="odp-info-item"><div class="odp-info-label">Menu</div><div class="odp-info-value">${o.menu}</div></div>
      <div class="odp-info-item"><div class="odp-info-label">Statut</div><div class="odp-info-value">${s.icon} ${s.label}</div></div>
      <div class="odp-info-item"><div class="odp-info-label">Personnes</div><div class="odp-info-value">ðŸ‘¥ ${o.persons}</div></div>
      <div class="odp-info-item"><div class="odp-info-label">Total</div><div class="odp-info-value" style="color:var(--burgundy)">${o.total.toFixed(2).replace('.', ',')} â‚¬</div></div>
      <div class="odp-info-item"><div class="odp-info-label">Date Ã©vÃ©nement</div><div class="odp-info-value">ðŸ“… ${o.event} Ã  ${o.eventTime || 'â€”'}</div></div>
      <div class="odp-info-item"><div class="odp-info-label">CommandÃ© le</div><div class="odp-info-value">${o.date}</div></div>
      <div class="odp-info-item" style="grid-column:1/-1"><div class="odp-info-label">Adresse de livraison</div><div class="odp-info-value">ðŸ“ ${o.addr}</div></div>
      ${o.notes ? `<div class="odp-info-item" style="grid-column:1/-1"><div class="odp-info-label">Notes</div><div class="odp-info-value">${o.notes}</div></div>` : ''}
    </div>
    ${o.review ? `
    <div style="background:rgba(196,154,60,.08);border:1px solid rgba(196,154,60,.25);border-radius:4px;padding:1rem;margin-top:.5rem">
      <div style="font-size:.7rem;text-transform:uppercase;letter-spacing:.1em;color:var(--gold);font-weight:600;margin-bottom:.5rem">Votre avis</div>
      <div style="font-size:1.2rem;margin-bottom:.3rem">${'â˜…'.repeat(o.review.stars)}${'â˜†'.repeat(5 - o.review.stars)}</div>
      <div style="font-size:.875rem;color:var(--charcoal);font-style:italic">"${o.review.comment}"</div>
      <div style="font-size:.72rem;color:var(--text-light);margin-top:.4rem">PostÃ© le ${o.review.date}</div>
    </div>` : ''}`;

  // Track tab
  const allStatuses = ['pending','accepted','in_preparation','delivering','delivered'];
  const currentIdx = allStatuses.indexOf(o.status);
  const trackContent = `
    <div class="tracking-title">ðŸ“ Suivi de commande</div>
    <div class="timeline">
      ${allStatuses.map((st, i) => {
        const histEntry = o.history.find(h => h.status === st);
        const isDone = i < currentIdx;
        const isCurrent = i === currentIdx;
        const sm = ORDER_STATUS_MAP[st];
        const dotCls = isDone ? 'done' : (isCurrent ? 'current' : '');
        const stepCls = isDone ? 'done' : '';
        return `
          <div class="timeline-step ${stepCls}">
            <div class="tl-dot ${dotCls}">${isDone ? 'âœ“' : (isCurrent ? sm.icon : '')}</div>
            <div class="tl-content">
              <div class="tl-label" style="color:${isCurrent ? 'var(--burgundy)' : (isDone ? 'var(--charcoal)' : 'var(--text-light)')}">${histEntry ? histEntry.label : sm.label}</div>
              <div class="tl-date ${histEntry ? '' : 'pending'}">${histEntry ? histEntry.date : 'En attenteâ€¦'}</div>
            </div>
          </div>`;
      }).join('')}
    </div>`;

  // Edit tab
  const editContent = canEdit ? `
    <div class="edit-order-section">
      <div class="edit-order-title">âœï¸ Modifier la commande</div>
      <p style="font-size:.8rem;color:var(--text-light);margin-bottom:1rem">Le menu ne peut pas Ãªtre modifiÃ©. Vous pouvez changer les autres informations.</p>
      <div style="display:flex;flex-direction:column;gap:.9rem">
        <div class="form-group">
          <label>Nombre de personnes</label>
          <input type="number" id="edit_persons" value="${o.persons}" min="1">
        </div>
        <div class="form-row">
          <div class="form-group"><label>Date de l'Ã©vÃ©nement</label><input type="date" id="edit_event_date" value="${formatDateInput(o.event)}"></div>
          <div class="form-group"><label>Heure</label><input type="time" id="edit_event_time" value="${o.eventTime || '12:00'}"></div>
        </div>
        <div class="form-group">
          <label>Adresse de livraison</label>
          <input type="text" id="edit_addr" value="${o.addr}">
        </div>
        <div class="form-group">
          <label>Notes (optionnel)</label>
          <textarea style="min-height:70px;resize:vertical" id="edit_notes">${o.notes}</textarea>
        </div>
        <button class="dash-save-btn" style="margin-top:.3rem" onclick="saveOrderEdit('${o.id}')">âœ“ Enregistrer les modifications</button>
      </div>
    </div>` : `<div class="dash-empty"><div class="icon">ðŸ”’</div><p>La commande a Ã©tÃ© acceptÃ©e, elle n'est plus modifiable.</p></div>`;

  // Review tab
  let reviewContent = '';
  if (o.review) {
    reviewContent = `
      <div style="text-align:center;padding:1.5rem 0">
        <div style="font-size:2rem;margin-bottom:.5rem">â­</div>
        <div class="review-submitted-badge">âœ“ Avis envoyÃ©</div>
        <div style="margin-top:1.2rem;font-size:1.3rem">${'â˜…'.repeat(o.review.stars)}${'â˜†'.repeat(5 - o.review.stars)}</div>
        <p style="margin-top:.6rem;font-size:.875rem;font-style:italic;color:var(--text)">"${o.review.comment}"</p>
        <p style="font-size:.72rem;color:var(--text-light);margin-top:.4rem">PostÃ© le ${o.review.date}</p>
      </div>`;
  } else if (canReview) {
    reviewContent = `
      <p style="font-size:.875rem;color:var(--text-light);margin-bottom:1rem">Votre commande est terminÃ©e ðŸŽ‰ Partagez votre expÃ©rience !</p>
      <div style="margin-bottom:.5rem;font-weight:600;font-size:.875rem">Note</div>
      <div class="star-rating" id="starRating" data-selected="0">
        ${[1,2,3,4,5].map(n => `<span class="star" data-val="${n}" onclick="selectStar(${n})" onmouseover="hoverStars(${n})" onmouseout="resetStarsHover()">â˜…</span>`).join('')}
      </div>
      <div id="starLabel" style="font-size:.78rem;color:var(--text-light);min-height:1.2em;margin-bottom:.8rem"></div>
      <div class="form-group">
        <label>Commentaire</label>
        <textarea id="reviewComment" placeholder="DÃ©crivez votre expÃ©rienceâ€¦" style="min-height:90px;resize:vertical"></textarea>
      </div>
      <button class="dash-save-btn" style="margin-top:.5rem" onclick="submitReview('${o.id}')">âœ“ Envoyer mon avis</button>`;
  } else {
    reviewContent = `<div class="dash-empty"><div class="icon">â³</div><p>L'avis sera disponible une fois la commande terminÃ©e.</p></div>`;
  }

  // Tab content map
  const tabContent = { detail: detailContent, track: trackContent, edit: editContent, review: reviewContent };

  document.getElementById('orderDetailPanel').innerHTML = `
    <div class="odp-header">
      <button class="odp-close" onclick="closeOrderDetail()">âœ•</button>
      <div class="odp-ref">RÃ©f. ${o.id}</div>
      <div class="odp-menu-name">${o.menu}</div>
    </div>
    <div style="display:flex;border-bottom:1px solid rgba(0,0,0,.07);background:white;overflow-x:auto">${tabHtml}</div>
    <div class="odp-body" id="orderDetailBody">${tabContent[activeTab] || detailContent}</div>`;

  // Store current order id for tab switching
  document.getElementById('orderDetailPanel').dataset.orderId = o.id;
}

function switchOrderTab(tab, orderId) {
  const o = sampleOrders.find(x => x.id === orderId);
  if (!o) return;
  renderOrderDetailPanel(o, tab);
}

function formatDateInput(ddmmyyyy) {
  if (!ddmmyyyy) return '';
  const [d, m, y] = ddmmyyyy.split('/');
  return `${y}-${m}-${d}`;
}

function saveOrderEdit(id) {
  const o = sampleOrders.find(x => x.id === id);
  if (!o) return;
  const persons = parseInt(document.getElementById('edit_persons').value, 10);
  const dateVal = document.getElementById('edit_event_date').value;
  const timeVal = document.getElementById('edit_event_time').value;
  const addr    = document.getElementById('edit_addr').value.trim();
  const notes   = document.getElementById('edit_notes').value.trim();
  if (!persons || persons < 1) { showToast('Nombre de personnes invalide.'); return; }
  if (!dateVal) { showToast('Veuillez sÃ©lectionner une date.'); return; }
  if (!addr) { showToast('Veuillez renseigner l\'adresse.'); return; }
  o.persons   = persons;
  o.event     = dateVal.split('-').reverse().join('/');
  o.eventTime = timeVal;
  o.addr      = addr;
  o.notes     = notes;
  o.total     = +(o.total); // unchanged â€” menu/price not editable
  closeOrderDetail();
  renderOrders();
  showToast('Commande ' + id + ' modifiÃ©e !');
}

// â”€â”€â”€ STAR RATING â”€â”€â”€
let _selectedStars = 0;
const starLabels = ['', 'Mauvais', 'Passable', 'Bien', 'TrÃ¨s bien', 'Excellent'];

function selectStar(n) {
  _selectedStars = n;
  document.getElementById('starRating').dataset.selected = n;
  updateStarDisplay(n);
  const lbl = document.getElementById('starLabel');
  if (lbl) { lbl.textContent = starLabels[n]; lbl.style.color = 'var(--gold)'; }
}

function hoverStars(n) { updateStarDisplay(n, true); }
function resetStarsHover() { updateStarDisplay(_selectedStars); }

function updateStarDisplay(n, isHover) {
  const stars = document.querySelectorAll('#starRating .star');
  stars.forEach((s, i) => {
    s.classList.remove('active', 'hovered');
    if (i < n) s.classList.add(isHover ? 'hovered' : 'active');
  });
}

function submitReview(id) {
  const o = sampleOrders.find(x => x.id === id);
  if (!o) return;
  if (!_selectedStars) { showToast('Veuillez sÃ©lectionner une note.'); return; }
  const comment = document.getElementById('reviewComment').value.trim();
  if (!comment) { showToast('Veuillez Ã©crire un commentaire.'); return; }
  o.review = { stars: _selectedStars, comment, date: nowDateTime() };
  _selectedStars = 0;
  // Also add to public reviews
  reviews.unshift({ name: currentUser ? (currentUser.prenom + ' ' + (currentUser.nom || '')[0] + '.') : 'Client', date: new Date().toLocaleDateString('fr-FR'), stars: o.review.stars, text: comment });
  renderReviews();
  closeOrderDetail();
  renderOrders();
  showToast('Merci pour votre avis !');
}

// Profile
function saveProfile() {
  currentUser.prenom   = document.getElementById('prof_prenom').value.trim();
  currentUser.nom      = document.getElementById('prof_nom').value.trim();
  currentUser.email    = document.getElementById('prof_email').value.trim();
  currentUser.tel      = document.getElementById('prof_tel').value.trim();
  currentUser.birth    = document.getElementById('prof_birth').value;
  currentUser.diet     = document.getElementById('prof_diet').value;
  currentUser.allergies = document.getElementById('prof_allergies').value.trim();
  document.getElementById('dashName').textContent = currentUser.prenom + ' ' + currentUser.nom;
  document.getElementById('dashEmail').textContent = currentUser.email;
  document.getElementById('dashAvatar').textContent = (currentUser.prenom || '?')[0].toUpperCase();
  document.getElementById('navUserName').textContent = currentUser.prenom;
  showToast('Profil mis Ã  jour avec succÃ¨s !');
}

// Addresses
function renderAddresses() {
  const list = document.getElementById('addressesList');
  if (userAddresses.length === 0) {
    list.innerHTML = '<div class="dash-empty"><div class="icon">ðŸ“</div><p>Aucune adresse enregistrÃ©e.</p></div>';
    return;
  }
  list.innerHTML = userAddresses.map((a, i) => `
    <div class="address-card">
      <div>
        <span class="address-badge">${a.label}</span>
        <div class="address-text">
          ${a.street}<br>
          ${a.zip} ${a.city}
          ${a.extra ? '<br><span style="color:var(--text-light);font-size:.8rem">' + a.extra + '</span>' : ''}
        </div>
      </div>
      <div class="address-actions">
        <button class="btn-icon" onclick="editAddress(${a.id})">âœï¸ Modifier</button>
        <button class="btn-icon danger" onclick="deleteAddress(${a.id})">ðŸ—‘ Supprimer</button>
      </div>
    </div>`).join('');
}

function showAddAddressForm() {
  document.getElementById('addr_label').value = '';
  document.getElementById('addr_street').value = '';
  document.getElementById('addr_zip').value = '';
  document.getElementById('addr_city').value = '';
  document.getElementById('addr_extra').value = '';
  document.getElementById('addAddressForm').style.display = 'block';
}

function saveAddress() {
  const label  = document.getElementById('addr_label').value.trim() || 'Adresse';
  const street = document.getElementById('addr_street').value.trim();
  const zip    = document.getElementById('addr_zip').value.trim();
  const city   = document.getElementById('addr_city').value.trim();
  const extra  = document.getElementById('addr_extra').value.trim();
  if (!street || !zip || !city) { showToast('Veuillez remplir les champs obligatoires.'); return; }
  const newId = Date.now();
  userAddresses.push({ id: newId, label, street, zip, city, extra });
  document.getElementById('addAddressForm').style.display = 'none';
  renderAddresses();
  showToast('Adresse ajoutÃ©e !');
}

function editAddress(id) {
  const a = userAddresses.find(x => x.id === id);
  if (!a) return;
  document.getElementById('addr_label').value  = a.label;
  document.getElementById('addr_street').value = a.street;
  document.getElementById('addr_zip').value    = a.zip;
  document.getElementById('addr_city').value   = a.city;
  document.getElementById('addr_extra').value  = a.extra;
  document.getElementById('addAddressForm').style.display = 'block';
  // Remove old and re-save
  userAddresses = userAddresses.filter(x => x.id !== id);
  renderAddresses();
}

function deleteAddress(id) {
  userAddresses = userAddresses.filter(x => x.id !== id);
  renderAddresses();
  showToast('Adresse supprimÃ©e.');
}

// Security
function updateSecPasswordUI() {
  const pwd = document.getElementById('sec_new').value;
  const score = checkPasswordStrength(pwd);
  const bar = document.getElementById('secPwdBar');
  const rules = { srule_len: pwd.length >= 10, srule_upper: /[A-Z]/.test(pwd), srule_lower: /[a-z]/.test(pwd), srule_digit: /[0-9]/.test(pwd), srule_special: /[^A-Za-z0-9]/.test(pwd) };
  Object.entries(rules).forEach(([id, ok]) => {
    const el = document.getElementById(id);
    if (el) { el.style.color = ok ? '#2d7a3a' : 'var(--text-light)'; el.querySelector('.rule-icon').textContent = ok ? 'âœ“' : 'â—‹'; }
  });
  const colors = ['#e0e0e0','#e53935','#ff9800','#fdd835','#66bb6a','#2e7d32'];
  if (bar) { bar.style.width = (score * 20) + '%'; bar.style.background = colors[score]; }
}

function changePassword() {
  const current = document.getElementById('sec_current').value;
  const newPwd  = document.getElementById('sec_new').value;
  const confirm = document.getElementById('sec_confirm').value;
  if (!current) { showToast('Veuillez saisir votre mot de passe actuel.'); return; }
  const err = validatePassword(newPwd);
  if (err) { showToast(err); return; }
  if (newPwd !== confirm) { showToast('Les mots de passe ne correspondent pas.'); return; }
  document.getElementById('sec_current').value = '';
  document.getElementById('sec_new').value = '';
  document.getElementById('sec_confirm').value = '';
  updateSecPasswordUI();
  showToast('Mot de passe mis Ã  jour avec succÃ¨s !');
}

function confirmDeleteAccount() {
  if (confirm('ÃŠtes-vous sÃ»r(e) de vouloir supprimer votre compte ? Cette action est irrÃ©versible.')) {
    closeDashboard();
    handleLogout();
    showToast('Compte supprimÃ©. Ã€ bientÃ´t !');
  }
}

// Prefs
function savePrefs() {
  showToast('PrÃ©fÃ©rences enregistrÃ©es !');
}

// Override logout to close dashboard too
function handleLogout() {
  isLoggedIn = false;
  currentUser = null;
  cart = [];
  updateCart();
  updateNavAuth();
  closeDashboard();
  showToast('Vous Ãªtes dÃ©connectÃ©(e).');
}


let _resetCode = null;
let _resetEmail = null;

function showForgotPassword(e) {
  if (e) e.preventDefault();
  // Hide tabs
  document.getElementById('tabLogin').closest('div').style.display = 'none';
  document.getElementById('authModalTitle').textContent = 'Mot de passe oubliÃ©';
  document.getElementById('formLogin').style.display = 'none';
  document.getElementById('formRegister').style.display = 'none';
  showForgotStep(1);
}

function showForgotStep(step) {
  ['formForgot1','formForgot2','formForgot3'].forEach((id, i) => {
    const el = document.getElementById(id);
    el.style.display = (i + 1 === step) ? 'flex' : 'none';
  });
}

function sendResetCode() {
  const email = document.getElementById('forgot_email').value.trim();
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
    showToast('Veuillez saisir une adresse email valide.'); return;
  }
  _resetEmail = email;
  // GÃ©nÃ¨re un code simulÃ© Ã  6 chiffres
  _resetCode = String(Math.floor(100000 + Math.random() * 900000));
  document.getElementById('forgot_email_display').textContent = email;
  // Affiche le code dans l'indice (en prod, il serait envoyÃ© par email)
  const hint = document.getElementById('forgot_code_hint');
  hint.textContent = 'ðŸ’¡ Code de dÃ©monstration : ' + _resetCode;
  hint.style.display = 'block';
  showForgotStep(2);
  showToast('Code envoyÃ© Ã  ' + email + ' !');
}

function resendCode(e) {
  e.preventDefault();
  _resetCode = String(Math.floor(100000 + Math.random() * 900000));
  const hint = document.getElementById('forgot_code_hint');
  hint.textContent = 'ðŸ’¡ Nouveau code de dÃ©monstration : ' + _resetCode;
  hint.style.display = 'block';
  document.getElementById('forgot_code').value = '';
  showToast('Nouveau code envoyÃ© !');
}

function verifyResetCode() {
  const entered = document.getElementById('forgot_code').value.trim();
  if (!entered || entered.length !== 6) {
    showToast('Veuillez saisir le code Ã  6 chiffres.'); return;
  }
  if (entered !== _resetCode) {
    showToast('Code incorrect. Veuillez rÃ©essayer.'); return;
  }
  document.getElementById('authModalTitle').textContent = 'Nouveau mot de passe';
  showForgotStep(3);
}

function updateNewPasswordUI() {
  const pwd = document.getElementById('new_password').value;
  const score = checkPasswordStrength(pwd);
  const bar = document.getElementById('newPwdStrengthBar');
  const label = document.getElementById('newPwdStrengthLabel');
  const rules = {
    nrule_len:     pwd.length >= 10,
    nrule_upper:   /[A-Z]/.test(pwd),
    nrule_lower:   /[a-z]/.test(pwd),
    nrule_digit:   /[0-9]/.test(pwd),
    nrule_special: /[^A-Za-z0-9]/.test(pwd),
  };
  Object.entries(rules).forEach(([id, ok]) => {
    const el = document.getElementById(id);
    if (el) { el.style.color = ok ? '#2d7a3a' : 'var(--text-light)'; el.querySelector('.rule-icon').textContent = ok ? 'âœ“' : 'â—‹'; }
  });
  const colors = ['#e0e0e0','#e53935','#ff9800','#fdd835','#66bb6a','#2e7d32'];
  const labels = ['','TrÃ¨s faible','Faible','Moyen','Fort','TrÃ¨s fort'];
  if (bar) { bar.style.width = (score * 20) + '%'; bar.style.background = colors[score]; }
  if (label) { label.textContent = pwd.length ? labels[score] : ''; label.style.color = colors[score]; }
}

function resetPassword() {
  const pwd = document.getElementById('new_password').value;
  const pwd2 = document.getElementById('new_password2').value;
  if (!pwd) { showToast('Veuillez saisir un nouveau mot de passe.'); return; }
  const err = validatePassword(pwd);
  if (err) { showToast(err); return; }
  if (pwd !== pwd2) { showToast('Les mots de passe ne correspondent pas.'); return; }
  // RÃ©initialisation rÃ©ussie
  closeLogin();
  showToast('Mot de passe rÃ©initialisÃ© avec succÃ¨s ! Vous pouvez vous connecter.');
  // RÃ©affiche les onglets pour la prochaine ouverture
  _resetCode = null; _resetEmail = null;
}

// Restore tabs when closing modal
const _origCloseLogin = closeLogin;
function closeLogin() {
  _origCloseLogin();
  const tabsDiv = document.getElementById('tabLogin');
  if (tabsDiv) tabsDiv.closest('div').style.display = 'flex';
  document.getElementById('authModalTitle').textContent = 'Connexion';
}

function switchAuthTab(tab) {
  const isLogin = tab === 'login';
  // Restore tabs visibility
  document.getElementById('tabLogin').closest('div').style.display = 'flex';
  document.getElementById('formForgot1').style.display = 'none';
  document.getElementById('formForgot2').style.display = 'none';
  document.getElementById('formForgot3').style.display = 'none';
  document.getElementById('formLogin').style.display = isLogin ? 'flex' : 'none';
  document.getElementById('formRegister').style.display = isLogin ? 'none' : 'flex';
  document.getElementById('tabLogin').style.borderBottomColor = isLogin ? 'var(--burgundy)' : 'transparent';
  document.getElementById('tabLogin').style.color = isLogin ? 'var(--burgundy)' : 'var(--text-light)';
  document.getElementById('tabRegister').style.borderBottomColor = isLogin ? 'transparent' : 'var(--burgundy)';
  document.getElementById('tabRegister').style.color = isLogin ? 'var(--text-light)' : 'var(--burgundy)';
  document.getElementById('authModalTitle').textContent = isLogin ? 'Connexion' : 'CrÃ©er un compte';
}

// â”€â”€â”€ LOGIN MODAL â”€â”€â”€
function showLogin(tab = 'login') {
  switchAuthTab(tab);
  document.getElementById('loginOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeLogin() {
  document.getElementById('loginOverlay').classList.remove('open');
  document.body.style.overflow = '';
}
function closeLoginOutside(e) {
  if (e.target === document.getElementById('loginOverlay')) closeLogin();
}

// â”€â”€â”€ CONTACT â”€â”€â”€
function submitContact(e) {
  e.preventDefault();
  showToast('Votre message a Ã©tÃ© envoyÃ© !');
  e.target.reset();
}

// â”€â”€â”€ TOAST â”€â”€â”€
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = 'âœ“  ' + msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

// â”€â”€â”€ REVIEWS â”€â”€â”€
function renderReviews() {
  document.getElementById('reviewsGrid').innerHTML = reviews.map(r => `
    <div class="review-card">
      <div class="stars">${'â˜…'.repeat(r.stars)}${'â˜†'.repeat(5 - r.stars)}</div>
      <p class="review-text">"${r.text}"</p>
      <div class="reviewer">
        <div class="reviewer-avatar">${r.name[0]}</div>
        <div>
          <div class="reviewer-name">${r.name}</div>
          <div class="reviewer-date">${r.date}</div>
        </div>
      </div>
    </div>
  `).join('');
}

// â”€â”€â”€ EMPLOYEE SPACE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// Employee credentials (demo)
const EMPLOYEE_EMAIL    = 'employe@vitegourmand.fr';
const EMPLOYEE_PASSWORD = 'Employe@2026';

// Pending reviews queue (orders with reviews not yet moderated)
let pendingReviews = [
  // Will be populated from sampleOrders that have reviews
];
let approvedReviews = [...reviews]; // already-approved = initial reviews array
let rejectedReviews = [];

// Horaires data
let scheduleData = [
  { day: 'Lundi',    closed: false, open: '09:00', close: '18:00' },
  { day: 'Mardi',    closed: false, open: '09:00', close: '18:00' },
  { day: 'Mercredi', closed: false, open: '09:00', close: '18:00' },
  { day: 'Jeudi',    closed: false, open: '09:00', close: '18:00' },
  { day: 'Vendredi', closed: false, open: '09:00', close: '18:00' },
  { day: 'Samedi',   closed: false, open: '10:00', close: '16:00' },
  { day: 'Dimanche', closed: true,  open: '',       close: ''      },
];

// All orders (shared with user space) â€“ also includes additional employee-visible ones
const allOrders = sampleOrders;

// Extended employee order statuses
const EMP_STATUS_MAP = {
  pending:         { label: 'En attente',             cls: 'emp-s-pending',         icon: 'â³', next: ['accepted', 'cancelled'] },
  accepted:        { label: 'AcceptÃ©e',               cls: 'emp-s-accepted',        icon: 'âœ…', next: ['in_preparation', 'cancelled'] },
  in_preparation:  { label: 'En prÃ©paration',         cls: 'emp-s-in_preparation',  icon: 'ðŸ‘¨â€ðŸ³', next: ['delivering'] },
  delivering:      { label: 'En cours de livraison',  cls: 'emp-s-delivering',      icon: 'ðŸš—', next: ['delivered'] },
  delivered:       { label: 'LivrÃ©e',                 cls: 'emp-s-delivered',       icon: 'ðŸ“¦', next: ['awaiting_return', 'completed'] },
  awaiting_return: { label: 'Retour matÃ©riel',        cls: 'emp-s-awaiting_return', icon: 'ðŸ“¦', next: ['completed'] },
  completed:       { label: 'TerminÃ©e',               cls: 'emp-s-completed',       icon: 'ðŸŽ‰', next: [] },
  cancelled:       { label: 'AnnulÃ©e',                cls: 'emp-s-cancelled',       icon: 'âœ•',  next: [] },
};

const EMP_STATUS_LABELS = {
  pending:         'En attente',
  accepted:        'AcceptÃ©e',
  in_preparation:  'En prÃ©paration',
  delivering:      'En cours de livraison',
  delivered:       'LivrÃ©e',
  awaiting_return: 'Retour matÃ©riel en attente',
  completed:       'TerminÃ©e',
  cancelled:       'AnnulÃ©e',
};

let empCurrentRevTab = 'pending';
let empEditingOrderId = null;

// â”€â”€â”€ Open / Close â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function openEmployeeSpace() {
  // Check if logged in as employee
  if (!isLoggedIn || !currentUser || !currentUser.isEmployee) {
    showToast('AccÃ¨s rÃ©servÃ© aux employÃ©s.');
    return;
  }
  empInit();
  document.getElementById('empOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeEmployeeSpace() {
  document.getElementById('empOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

function empInit() {
  document.getElementById('empUserLabel').textContent = currentUser.prenom + ' ' + (currentUser.nom || '');
  empUpdateBadges();
  empRenderDashboard();
  empRenderOrders();
  empRenderMenus();
  empRenderSchedule();
  empRenderReviews();
}

function empUpdateBadges() {
  const pending = allOrders.filter(o => o.status === 'pending').length;
  document.getElementById('empBadgeOrders').textContent = pending;
  const pr = pendingReviews.length;
  document.getElementById('empBadgeReviews').textContent = pr;
}

// â”€â”€â”€ Tab switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function empSwitchTab(name, btn) {
  document.querySelectorAll('.emp-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.emp-nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('emp-' + name).classList.add('active');
  if (btn) btn.classList.add('active');
}

// â”€â”€â”€ Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function empRenderDashboard() {
  const total = allOrders.length;
  const pending = allOrders.filter(o => o.status === 'pending').length;
  const inProgress = allOrders.filter(o => ['accepted','in_preparation','delivering'].includes(o.status)).length;
  const completed = allOrders.filter(o => o.status === 'completed' || o.status === 'delivered').length;

  document.getElementById('empStatsRow').innerHTML = `
    <div class="emp-stat-card"><div class="emp-stat-num">${total}</div><div class="emp-stat-label">Total commandes</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#c9a84c">${pending}</div><div class="emp-stat-label">En attente</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#64b5f6">${inProgress}</div><div class="emp-stat-label">En cours</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#81c784">${completed}</div><div class="emp-stat-label">TerminÃ©es</div></div>
  `;

  const urgent = allOrders.filter(o => ['pending','accepted','in_preparation','delivering','awaiting_return'].includes(o.status));
  if (urgent.length === 0) {
    document.getElementById('empUrgentOrders').innerHTML = '<div style="color:rgba(255,255,255,.3);font-size:.875rem;padding:1rem 0">Aucune commande urgente.</div>';
    return;
  }
  document.getElementById('empUrgentOrders').innerHTML = urgent.map(o => empOrderCardHTML(o, true)).join('');
}

// â”€â”€â”€ Orders â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function empFilterOrders() {
  const status = document.getElementById('empFilterStatus').value;
  const client = document.getElementById('empFilterClient').value.toLowerCase();
  const menu   = document.getElementById('empFilterMenu').value.toLowerCase();

  const filtered = allOrders.filter(o => {
    if (status && o.status !== status) return false;
    if (client && !o.id.toLowerCase().includes(client) &&
        !(o.clientName || '').toLowerCase().includes(client) &&
        !(o.clientEmail || '').toLowerCase().includes(client)) return false;
    if (menu && !o.menu.toLowerCase().includes(menu)) return false;
    return true;
  });

  document.getElementById('empOrdersList').innerHTML =
    filtered.length ? filtered.map(o => empOrderCardHTML(o, false)).join('') :
    '<div style="color:rgba(255,255,255,.3);padding:2rem;text-align:center">Aucune commande trouvÃ©e.</div>';
}

function empResetFilters() {
  document.getElementById('empFilterStatus').value = '';
  document.getElementById('empFilterClient').value = '';
  document.getElementById('empFilterMenu').value = '';
  empFilterOrders();
}

function empRenderOrders() {
  document.getElementById('empOrdersList').innerHTML = allOrders.map(o => empOrderCardHTML(o, false)).join('');
}

function empOrderCardHTML(o, compact) {
  const s = EMP_STATUS_MAP[o.status] || EMP_STATUS_MAP.pending;
  const canCancel = !['cancelled','completed'].includes(o.status);
  const nextStatuses = s.next || [];

  return `
    <div class="emp-card">
      <div class="emp-card-header">
        <div>
          <div style="font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.3);margin-bottom:.2rem">RÃ©f. ${o.id} Â· ${o.clientName || 'Client'} Â· ${o.clientEmail || ''}</div>
          <div class="emp-card-title">${o.menu}</div>
          <div class="emp-card-sub">ðŸ‘¥ ${o.persons} pers. Â· ðŸ“… ${o.event} ${o.eventTime ? 'Ã  ' + o.eventTime : ''} Â· ðŸ’¶ ${o.total.toFixed(2).replace('.',',')} â‚¬</div>
          <div class="emp-card-sub" style="margin-top:.2rem">ðŸ“ ${o.addr || 'â€”'}</div>
        </div>
        <span class="emp-status ${s.cls}">${s.icon} ${s.label}</span>
      </div>
      ${o.cancelReason ? `<div class="emp-warning" style="margin-bottom:.5rem">âš ï¸ Annulation â€” Contact : ${o.cancelContact} Â· Motif : ${o.cancelReason}</div>` : ''}
      <div class="emp-card-actions">
        ${nextStatuses.filter(ns => ns !== 'cancelled').map(ns => `
          <button class="emp-btn emp-btn-success emp-btn-sm" onclick="empUpdateStatus('${o.id}','${ns}')">
            â†’ ${EMP_STATUS_LABELS[ns]}
          </button>`).join('')}
        ${o.status === 'delivered' ? `
          <button class="emp-btn emp-btn-outline emp-btn-sm" onclick="empUpdateStatus('${o.id}','awaiting_return')">ðŸ“¦ Retour matÃ©riel</button>
          <button class="emp-btn emp-btn-success emp-btn-sm" onclick="empUpdateStatus('${o.id}','completed')">ðŸŽ‰ Terminer</button>` : ''}
        <button class="emp-btn emp-btn-outline emp-btn-sm" onclick="empOpenOrderDetail('${o.id}')">ðŸ” DÃ©tail / Suivi</button>
        ${canCancel ? `<button class="emp-btn emp-btn-danger emp-btn-sm" onclick="empOpenCancelModal('${o.id}')">âœ• Annuler</button>` : ''}
      </div>
    </div>`;
}

function empUpdateStatus(id, newStatus) {
  const o = allOrders.find(x => x.id === id);
  if (!o) return;

  const statusLabel = EMP_STATUS_LABELS[newStatus];
  o.status = newStatus;

  // Add to history
  const histLabel = {
    accepted:        'Commande acceptÃ©e par l\'Ã©quipe',
    in_preparation:  'Mise en prÃ©paration',
    delivering:      'Prise en charge par la livraison',
    delivered:       'LivrÃ©e au client',
    awaiting_return: 'En attente de retour matÃ©riel',
    completed:       'Commande terminÃ©e',
  }[newStatus] || statusLabel;

  o.history.push({ status: newStatus, label: histLabel, date: nowDateTime() });

  // Special: awaiting_return â†’ simulate email to client
  if (newStatus === 'awaiting_return') {
    showToast('ðŸ“§ Email envoyÃ© au client : retour matÃ©riel requis sous 10 jours ouvrÃ©s.');
  } else if (newStatus === 'completed') {
    showToast('ðŸŽ‰ Commande ' + id + ' marquÃ©e comme terminÃ©e. Email envoyÃ© au client pour avis.');
  } else {
    showToast('âœ… Statut mis Ã  jour : ' + statusLabel);
  }

  empUpdateBadges();
  empRenderDashboard();
  empRenderOrders();
  renderOrders(); // refresh user space too
}

// Order detail for employee
function empOpenOrderDetail(id) {
  const o = allOrders.find(x => x.id === id);
  if (!o) return;
  const s = EMP_STATUS_MAP[o.status] || EMP_STATUS_MAP.pending;

  const allStatuses = ['pending','accepted','in_preparation','delivering','delivered','awaiting_return','completed'];
  const currentIdx = allStatuses.indexOf(o.status);

  const timelineHTML = allStatuses.map((st, i) => {
    const histEntry = o.history.find(h => h.status === st);
    const isDone = histEntry && i < currentIdx;
    const isCurrent = o.status === st;
    const sm = EMP_STATUS_MAP[st];
    return `
      <div class="emp-tl-step">
        <div class="emp-tl-dot ${isDone ? 'done' : (isCurrent ? 'current' : '')}">
          ${isDone ? 'âœ“' : (isCurrent ? sm.icon : '')}
        </div>
        <div>
          <div class="emp-tl-label" style="color:${isCurrent ? 'var(--gold)' : ''}">${histEntry ? histEntry.label : sm.label}</div>
          <div class="emp-tl-date">${histEntry ? histEntry.date : 'En attenteâ€¦'}</div>
        </div>
      </div>`;
  }).join('');

  document.getElementById('empOrderModalTitle').textContent = 'Suivi Â· ' + o.id;
  document.getElementById('empOrderModalBody').innerHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:.7rem;margin-bottom:1.4rem">
      <div style="background:#0f0f0f;border-radius:4px;padding:.8rem"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Menu</div><div style="color:white;font-size:.875rem;font-weight:600">${o.menu}</div></div>
      <div style="background:#0f0f0f;border-radius:4px;padding:.8rem"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Statut actuel</div><div><span class="emp-status ${s.cls}">${s.icon} ${s.label}</span></div></div>
      <div style="background:#0f0f0f;border-radius:4px;padding:.8rem"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Client</div><div style="color:white;font-size:.875rem">${o.clientName || 'â€”'}<br><span style="color:rgba(255,255,255,.4);font-size:.78rem">${o.clientEmail || ''}</span></div></div>
      <div style="background:#0f0f0f;border-radius:4px;padding:.8rem"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Ã‰vÃ©nement</div><div style="color:white;font-size:.875rem">${o.event} Ã  ${o.eventTime || 'â€”'}</div></div>
      <div style="background:#0f0f0f;border-radius:4px;padding:.8rem;grid-column:1/-1"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Adresse</div><div style="color:white;font-size:.875rem">${o.addr}</div></div>
      ${o.notes ? `<div style="background:#0f0f0f;border-radius:4px;padding:.8rem;grid-column:1/-1"><div style="font-size:.62rem;text-transform:uppercase;letter-spacing:.08em;color:rgba(255,255,255,.3);margin-bottom:.2rem">Notes</div><div style="color:rgba(255,255,255,.6);font-size:.84rem">${o.notes}</div></div>` : ''}
    </div>
    <div style="font-size:.75rem;text-transform:uppercase;letter-spacing:.1em;color:rgba(255,255,255,.3);margin-bottom:.8rem;font-weight:600">Historique</div>
    <div class="emp-timeline">${timelineHTML}</div>
    ${o.cancelReason ? `<div class="emp-warning" style="margin-top:1rem">âš ï¸ AnnulÃ©e Â· Contact : ${o.cancelContact} Â· Motif : ${o.cancelReason}</div>` : ''}
  `;
  document.getElementById('empOrderModal').classList.add('open');
}

// Cancel order (requires contact + reason)
function empOpenCancelModal(id) {
  empEditingOrderId = id;
  const o = allOrders.find(x => x.id === id);
  if (!o) return;

  document.getElementById('empOrderModalTitle').textContent = 'Annuler la commande Â· ' + id;
  document.getElementById('empOrderModalBody').innerHTML = `
    <div class="emp-warning">âš ï¸ Pour annuler une commande, vous devez d'abord contacter le client par appel tÃ©lÃ©phonique ou email, puis prÃ©ciser le mode de contact et le motif ci-dessous.</div>
    <div class="emp-form-group">
      <label>Mode de contact utilisÃ© *</label>
      <select id="empCancelContact">
        <option value="">-- Choisir --</option>
        <option value="Appel GSM">Appel GSM</option>
        <option value="Email">Email</option>
        <option value="Appel GSM + Email">Appel GSM + Email</option>
      </select>
    </div>
    <div class="emp-form-group">
      <label>Motif d'annulation *</label>
      <textarea id="empCancelReason" placeholder="DÃ©crivez le motif de l'annulation..." style="min-height:100px"></textarea>
    </div>
    <div style="display:flex;gap:.7rem;margin-top:1rem">
      <button class="emp-btn emp-btn-danger" style="flex:1;padding:.7rem" onclick="empConfirmCancel('${id}')">âœ• Confirmer l'annulation</button>
      <button class="emp-btn emp-btn-outline" style="flex:1;padding:.7rem" onclick="empCloseOrderModal()">Retour</button>
    </div>
  `;
  document.getElementById('empOrderModal').classList.add('open');
}

function empConfirmCancel(id) {
  const contact = document.getElementById('empCancelContact').value;
  const reason  = document.getElementById('empCancelReason').value.trim();
  if (!contact) { showToast('Veuillez sÃ©lectionner un mode de contact.'); return; }
  if (!reason)  { showToast('Veuillez saisir un motif d\'annulation.'); return; }

  const o = allOrders.find(x => x.id === id);
  if (!o) return;
  o.status = 'cancelled';
  o.cancelContact = contact;
  o.cancelReason  = reason;
  o.history.push({ status: 'cancelled', label: 'AnnulÃ©e par l\'Ã©quipe (' + contact + ')', date: nowDateTime() });

  empCloseOrderModal();
  empUpdateBadges();
  empRenderDashboard();
  empRenderOrders();
  renderOrders();
  showToast('Commande ' + id + ' annulÃ©e et motif enregistrÃ©.');
}

function empCloseOrderModal() {
  document.getElementById('empOrderModal').classList.remove('open');
}
function empCloseOrderModalOutside(e) {
  if (e.target === document.getElementById('empOrderModal')) empCloseOrderModal();
}

// â”€â”€â”€ Menus â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function empRenderMenus() {
  document.getElementById('empMenusGrid').innerHTML = menus.map(m => `
    <div class="emp-menu-card">
      <img src="${m.img}" alt="${m.name}" loading="lazy">
      <div class="emp-menu-card-body">
        <div class="emp-menu-card-name">${m.name}</div>
        <div class="emp-menu-card-meta">${m.type} Â· ${m.theme} Â· ${m.price.toFixed(2).replace('.',',')} â‚¬/pers. Â· min. ${m.minPersons} pers.</div>
        <div class="emp-menu-card-actions">
          <button class="emp-btn emp-btn-outline emp-btn-sm" onclick="empOpenMenuModal(${m.id})">âœï¸ Modifier</button>
          <button class="emp-btn emp-btn-danger emp-btn-sm" onclick="empDeleteMenu(${m.id})">ðŸ—‘ Supprimer</button>
        </div>
      </div>
    </div>
  `).join('');
}

function empOpenMenuModal(id) {
  const m = id ? menus.find(x => x.id === id) : null;
  document.getElementById('empMenuModalTitle').textContent = m ? 'Modifier le menu' : 'Nouveau menu';
  document.getElementById('empMenuId').value = m ? m.id : '';
  document.getElementById('empMenuName').value = m ? m.name : '';
  document.getElementById('empMenuType').value = m ? m.type : 'classique';
  document.getElementById('empMenuTheme').value = m ? m.theme : '';
  document.getElementById('empMenuPrice').value = m ? m.price : '';
  document.getElementById('empMenuMinPersons').value = m ? m.minPersons : '';
  document.getElementById('empMenuImg').value = m ? m.img : '';
  document.getElementById('empMenuDesc').value = m ? m.desc : '';
  document.getElementById('empMenuFullDesc').value = m ? m.fullDesc : '';
  document.getElementById('empMenuComposition').value = m ? m.composition.join('\n') : '';
  document.getElementById('empMenuAllergens').value = m ? m.allergens : '';
  document.getElementById('empMenuModal').classList.add('open');
}

function empSaveMenu() {
  const id    = document.getElementById('empMenuId').value;
  const name  = document.getElementById('empMenuName').value.trim();
  const type  = document.getElementById('empMenuType').value;
  const theme = document.getElementById('empMenuTheme').value.trim();
  const price = parseFloat(document.getElementById('empMenuPrice').value);
  const minP  = parseInt(document.getElementById('empMenuMinPersons').value, 10);
  const img   = document.getElementById('empMenuImg').value.trim();
  const desc  = document.getElementById('empMenuDesc').value.trim();
  const fdesc = document.getElementById('empMenuFullDesc').value.trim();
  const comp  = document.getElementById('empMenuComposition').value.split('\n').map(s => s.trim()).filter(Boolean);
  const allrg = document.getElementById('empMenuAllergens').value.trim();

  if (!name || !price || !minP) { showToast('Veuillez remplir tous les champs obligatoires.'); return; }

  if (id) {
    const m = menus.find(x => x.id == id);
    if (m) { m.name = name; m.type = type; m.theme = theme; m.price = price; m.minPersons = minP; m.img = img; m.desc = desc; m.fullDesc = fdesc; m.composition = comp; m.allergens = allrg; }
    showToast('Menu mis Ã  jour !');
  } else {
    const newId = Math.max(...menus.map(x => x.id)) + 1;
    menus.push({ id: newId, name, type, theme, price, minPersons: minP, img: img || 'https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=700&q=80', desc, fullDesc: fdesc, composition: comp, allergens: allrg });
    showToast('Nouveau menu ajoutÃ© !');
  }
  empCloseMenuModal();
  empRenderMenus();
  renderMenus(menus);
}

function empDeleteMenu(id) {
  if (!confirm('Supprimer ce menu dÃ©finitivement ?')) return;
  const idx = menus.findIndex(x => x.id === id);
  if (idx !== -1) menus.splice(idx, 1);
  empRenderMenus();
  renderMenus(menus);
  showToast('Menu supprimÃ©.');
}

function empCloseMenuModal() { document.getElementById('empMenuModal').classList.remove('open'); }
function empCloseMenuModalOutside(e) { if (e.target === document.getElementById('empMenuModal')) empCloseMenuModal(); }

// â”€â”€â”€ Schedule â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function empRenderSchedule() {
  document.getElementById('empScheduleGrid').innerHTML = scheduleData.map((s, i) => `
    <div class="emp-schedule-card">
      <div class="emp-schedule-day">${s.day}</div>
      <div class="emp-schedule-hours ${s.closed ? 'emp-schedule-closed' : ''}">
        ${s.closed ? 'FermÃ©' : s.open + ' â€” ' + s.close}
      </div>
      <button class="emp-btn emp-btn-outline emp-btn-sm" style="margin-top:.8rem" onclick="empOpenScheduleModal(${i})">âœï¸ Modifier</button>
    </div>
  `).join('');
}

function empOpenScheduleModal(idx) {
  const s = scheduleData[idx];
  document.getElementById('empScheduleModalTitle').textContent = 'Horaires Â· ' + s.day;
  document.getElementById('empScheduleIdx').value = idx;
  document.getElementById('empScheduleDay').value = s.day;
  document.getElementById('empScheduleClosed').value = s.closed ? '1' : '0';
  document.getElementById('empScheduleOpen').value = s.open || '09:00';
  document.getElementById('empScheduleClose').value = s.close || '18:00';
  empToggleScheduleHours();
  document.getElementById('empScheduleModal').classList.add('open');
}

function empToggleScheduleHours() {
  const closed = document.getElementById('empScheduleClosed').value === '1';
  document.getElementById('empScheduleHoursFields').style.display = closed ? 'none' : 'block';
}

function empSaveSchedule() {
  const idx    = parseInt(document.getElementById('empScheduleIdx').value, 10);
  const closed = document.getElementById('empScheduleClosed').value === '1';
  const open   = document.getElementById('empScheduleOpen').value;
  const close  = document.getElementById('empScheduleClose').value;
  if (!closed && (!open || !close)) { showToast('Veuillez saisir les heures d\'ouverture et de fermeture.'); return; }
  scheduleData[idx].closed = closed;
  scheduleData[idx].open   = open;
  scheduleData[idx].close  = close;
  empCloseScheduleModal();
  empRenderSchedule();
  showToast('Horaires mis Ã  jour !');
}

function empCloseScheduleModal() { document.getElementById('empScheduleModal').classList.remove('open'); }
function empCloseScheduleModalOutside(e) { if (e.target === document.getElementById('empScheduleModal')) empCloseScheduleModal(); }

// â”€â”€â”€ Reviews moderation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Move reviews from orders with status='delivered'/'completed' that have a review into pending queue
function empSyncPendingReviews() {
  allOrders.forEach(o => {
    if (o.review && !o.review.moderated) {
      const already = pendingReviews.find(r => r._orderId === o.id) ||
                      approvedReviews.find(r => r._orderId === o.id) ||
                      rejectedReviews.find(r => r._orderId === o.id);
      if (!already) {
        pendingReviews.push({
          _orderId: o.id, name: o.clientName || 'Client',
          date: o.review.date, stars: o.review.stars,
          text: o.review.comment, menu: o.menu, moderated: false,
        });
      }
    }
  });
  empUpdateBadges();
}

function empSwitchRevTab(tab) {
  empCurrentRevTab = tab;
  ['pending','approved','rejected'].forEach(t => {
    const btn = document.getElementById('empRevTab' + t.charAt(0).toUpperCase() + t.slice(1));
    if (btn) { btn.style.borderColor = t === tab ? 'var(--gold)' : 'rgba(255,255,255,.2)'; btn.style.color = t === tab ? 'var(--gold)' : 'rgba(255,255,255,.7)'; }
  });
  empRenderReviews();
}

function empRenderReviews() {
  empSyncPendingReviews();
  const lists = { pending: pendingReviews, approved: approvedReviews, rejected: rejectedReviews };
  const list = lists[empCurrentRevTab] || [];
  document.getElementById('empRevPendingCount').textContent = pendingReviews.length ? '(' + pendingReviews.length + ')' : '';

  if (list.length === 0) {
    document.getElementById('empReviewsList').innerHTML = '<div style="color:rgba(255,255,255,.3);padding:2rem;text-align:center">Aucun avis dans cette catÃ©gorie.</div>';
    return;
  }

  document.getElementById('empReviewsList').innerHTML = list.map((r, i) => `
    <div class="emp-review-card">
      <div>
        <div class="emp-review-stars">${'â˜…'.repeat(r.stars)}${'â˜†'.repeat(5 - r.stars)}</div>
      </div>
      <div class="emp-review-content">
        <div class="emp-review-author">${r.name} <span class="emp-review-date">Â· ${r.date}</span></div>
        ${r.menu ? `<div class="emp-review-order">ðŸ“¦ ${r.menu}</div>` : ''}
        <div class="emp-review-text">"${r.text}"</div>
        <div style="display:flex;gap:.5rem;flex-wrap:wrap">
          ${empCurrentRevTab === 'pending' ? `
            <button class="emp-btn emp-btn-success emp-btn-sm" onclick="empApproveReview(${i})">âœ… Approuver</button>
            <button class="emp-btn emp-btn-danger emp-btn-sm" onclick="empRejectReview(${i})">âŒ Refuser</button>
          ` : ''}
          ${empCurrentRevTab === 'approved' ? `<button class="emp-btn emp-btn-danger emp-btn-sm" onclick="empRevokeReview(${i})">â†© RÃ©voquer</button>` : ''}
          ${empCurrentRevTab === 'rejected' ? `<button class="emp-btn emp-btn-success emp-btn-sm" onclick="empRestoreReview(${i})">â†© Restaurer</button>` : ''}
        </div>
      </div>
    </div>
  `).join('');
}

function empApproveReview(i) {
  const r = pendingReviews.splice(i, 1)[0];
  r.moderated = true;
  approvedReviews.unshift(r);
  // Add to public reviews array
  reviews.unshift({ name: r.name, date: r.date, stars: r.stars, text: r.text });
  renderReviews();
  empUpdateBadges();
  empRenderReviews();
  showToast('Avis approuvÃ© et publiÃ© !');
}

function empRejectReview(i) {
  const r = pendingReviews.splice(i, 1)[0];
  r.moderated = true;
  rejectedReviews.unshift(r);
  empUpdateBadges();
  empRenderReviews();
  showToast('Avis refusÃ©.');
}

function empRevokeReview(i) {
  const r = approvedReviews.splice(i, 1)[0];
  rejectedReviews.unshift(r);
  // Remove from public reviews
  const idx = reviews.findIndex(x => x.text === r.text && x.name === r.name);
  if (idx !== -1) reviews.splice(idx, 1);
  renderReviews();
  empRenderReviews();
  showToast('Avis retirÃ© de la page publique.');
}

function empRestoreReview(i) {
  const r = rejectedReviews.splice(i, 1)[0];
  pendingReviews.unshift(r);
  r.moderated = false;
  empUpdateBadges();
  empRenderReviews();
  showToast('Avis remis en file de modÃ©ration.');
}

// â”€â”€â”€ Auth: handle employee login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Patch handleLogin to detect employee credentials
const _origHandleLogin = handleLogin;
function handleLogin() {
  const email    = document.getElementById('login_email').value.trim();
  const password = document.getElementById('login_password').value;
  if (!email || !password) { showToast('Veuillez remplir tous les champs.'); return; }

  if (email === EMPLOYEE_EMAIL && password === EMPLOYEE_PASSWORD) {
    isLoggedIn = true;
    currentUser = { prenom: 'Julie', nom: 'Lebon', email, isEmployee: true };
    closeLogin();
    updateNavAuth();
    showToast('Bienvenue Julie ! AccÃ¨s employÃ© activÃ©.');
    if (pendingAction) { pendingAction(); pendingAction = null; }
    return;
  }
  // Regular user login
  isLoggedIn = true;
  currentUser = { prenom: email.split('@')[0], email };
  closeLogin();
  updateNavAuth();
  showToast('Bienvenue ' + currentUser.prenom + ' !');
  if (pendingAction) { pendingAction(); pendingAction = null; }
}

// Patch updateNavAuth to show employee button
const _origUpdateNavAuth = updateNavAuth;
function updateNavAuth() {
  const btnLogin    = document.getElementById('navConnexion');
  const btnRegister = document.getElementById('navInscrire');
  const btnUser     = document.getElementById('navUser');
  const btnEmp      = document.getElementById('navEmployee');
  if (isLoggedIn && currentUser) {
    btnLogin.style.display    = 'none';
    btnRegister.style.display = 'none';
    if (currentUser.isEmployee) {
      btnUser.style.display = 'none';
      btnEmp.style.display  = 'inline-flex';
    } else {
      btnUser.style.display = 'flex';
      btnEmp.style.display  = 'none';
      document.getElementById('navUserName').textContent = currentUser.prenom;
    }
  } else {
    btnLogin.style.display    = '';
    btnRegister.style.display = '';
    btnUser.style.display     = 'none';
    btnEmp.style.display      = 'none';
  }
}

// Patch handleLogout to also close employee space
const _origHandleLogout2 = handleLogout;
function handleLogout() {
  isLoggedIn = false;
  currentUser = null;
  cart = [];
  updateCart();
  updateNavAuth();
  closeDashboard();
  closeEmployeeSpace();
  showToast('Vous Ãªtes dÃ©connectÃ©(e).');
}

// Enrich sampleOrders with client info for demo
sampleOrders.forEach((o, i) => {
  if (!o.clientName) {
    const names = ['Sophie Martin', 'Pierre Dupont', 'Claire Bernard', 'FranÃ§ois Leroy', 'Isabelle Thomas'];
    const emails = ['sophie.m@email.fr', 'pierre.d@email.fr', 'claire.b@email.fr', 'francois.l@email.fr', 'isabelle.t@email.fr'];
    o.clientName  = names[i % names.length];
    o.clientEmail = emails[i % emails.length];
  }
});


// â”€â”€â”€ ADMIN SPACE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const ADMIN_EMAIL    = 'admin@vitegourmand.fr';
const ADMIN_PASSWORD = 'Admin@VG2026!';

// â”€â”€ NoSQL "database" simulation (MongoDB-style documents) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Each order document mirrors sampleOrders but is stored as JSON in a flat store
const noSqlOrdersDB = {
  _store: {},
  _init() {
    sampleOrders.forEach(o => {
      // Parse event date as a JS Date for filtering
      const parts = (o.event || '01/01/2026').split('/');
      const dateObj = parts.length === 3
        ? new Date(+parts[2], +parts[1] - 1, +parts[0])
        : new Date();
      this._store[o.id] = { ...o, _date: dateObj };
    });
    // Add extra orders for analytics richness
    const extraOrders = [
      { id:'VG-2026-006', menu:'Menu Buffet Festif',      menuId:1, persons:20, event:'05/01/2026', total:760,  status:'completed', clientName:'Marc Bernard' },
      { id:'VG-2026-007', menu:'Menu RÃ©ception Chic',     menuId:2, persons:12, event:'08/01/2026', total:600,  status:'completed', clientName:'Lucie Martin' },
      { id:'VG-2026-008', menu:'Menu Gastronomique',      menuId:6, persons:8,  event:'10/01/2026', total:680,  status:'completed', clientName:'David Petit' },
      { id:'VG-2026-009', menu:'Menu Buffet Festif',      menuId:1, persons:30, event:'12/01/2026', total:1140, status:'completed', clientName:'Emma Leroy' },
      { id:'VG-2026-010', menu:'Menu Cocktail Prestige',  menuId:3, persons:25, event:'15/01/2026', total:1050, status:'completed', clientName:'Paul Simon' },
      { id:'VG-2026-011', menu:'Menu Vegan Gourmand',     menuId:4, persons:10, event:'17/01/2026', total:340,  status:'completed', clientName:'Alice Moreau' },
      { id:'VG-2026-012', menu:'Menu RÃ©ception Chic',     menuId:2, persons:16, event:'20/01/2026', total:800,  status:'completed', clientName:'Thomas Garcia' },
      { id:'VG-2026-013', menu:'Menu NoÃ«l Prestige',      menuId:7, persons:10, event:'22/01/2026', total:850,  status:'completed', clientName:'Sophie Blanc' },
      { id:'VG-2026-014', menu:'Menu Buffet Festif',      menuId:1, persons:18, event:'25/01/2026', total:684,  status:'completed', clientName:'Julie Durand' },
      { id:'VG-2026-015', menu:'Menu Mariage Prestige',   menuId:5, persons:60, event:'28/01/2026', total:5100, status:'completed', clientName:'Pierre Dupont' },
      { id:'VG-2026-016', menu:'Menu Gastronomique',      menuId:6, persons:12, event:'01/02/2026', total:1020, status:'completed', clientName:'Claire Robert' },
      { id:'VG-2026-017', menu:'Menu Cocktail Prestige',  menuId:3, persons:40, event:'03/02/2026', total:1680, status:'completed', clientName:'FranÃ§ois Michel' },
      { id:'VG-2026-018', menu:'Menu Buffet Festif',      menuId:1, persons:25, event:'05/02/2026', total:950,  status:'completed', clientName:'Isabelle Thomas' },
      { id:'VG-2026-019', menu:'Menu Vegan Gourmand',     menuId:4, persons:15, event:'07/02/2026', total:510,  status:'completed', clientName:'Antoine Lefevre' },
      { id:'VG-2026-020', menu:'Menu RÃ©ception Chic',     menuId:2, persons:20, event:'10/02/2026', total:1000, status:'completed', clientName:'Camille Roux' },
    ];
    extraOrders.forEach(o => {
      const parts = (o.event || '01/01/2026').split('/');
      const dateObj = new Date(+parts[2], +parts[1] - 1, +parts[0]);
      this._store[o.id] = { ...o, _date: dateObj, history: [], addr: 'â€”', notes: '', eventTime: '12:00' };
    });
  },
  find(query) {
    return Object.values(this._store).filter(doc => {
      for (const [k, v] of Object.entries(query)) {
        if (k === '$gte') continue;
        if (k === '$lte') continue;
        if (v && typeof v === 'object' && v.$gte !== undefined) {
          if (doc[k.replace('$','')] < v.$gte) return false;
        } else if (doc[k] !== v) return false;
      }
      return true;
    });
  },
  findAll() { return Object.values(this._store); },
  findByDateRange(from, to) {
    return Object.values(this._store).filter(d => {
      if (from && d._date < from) return false;
      if (to   && d._date > to)   return false;
      return true;
    });
  },
};

// Employee accounts store
let employeeAccounts = [
  { id: 'emp-001', prenom: 'Julie', nom: 'Lebon', email: EMPLOYEE_EMAIL, password: EMPLOYEE_PASSWORD, role: 'employee', active: true, createdAt: '15/01/2026' },
];

let admChartInstance = null;

// â”€â”€ Open / Close â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openAdminSpace() {
  if (!isLoggedIn || !currentUser || !currentUser.isAdmin) {
    showToast('AccÃ¨s rÃ©servÃ© aux administrateurs.');
    return;
  }
  noSqlOrdersDB._init();
  admInit();
  document.getElementById('admOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}

function closeAdminSpace() {
  document.getElementById('admOverlay').classList.remove('open');
  document.body.style.overflow = '';
}

function admInit() {
  admRenderDashboard();
  admRenderEmployees();
  admRenderAnalytics();
  admPopulateRevMenus();
  admRenderRevenue();
}

// â”€â”€ Tab switching â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admSwitchTab(name, btn) {
  document.querySelectorAll('.adm-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.adm-nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('adm-' + name).classList.add('active');
  if (btn) btn.classList.add('active');
  if (name === 'analytics') setTimeout(admRenderAnalytics, 50);
  if (name === 'revenue')   admRenderRevenue();
}

// Admin opens employee section by proxying to employee space
function admOpenEmployeeSection(section) {
  // Employee overlay shares the same data, just show it
  if (!document.getElementById('empOverlay').classList.contains('open')) {
    // Make sure emp is initialized
    empInit();
    document.getElementById('empOverlay').classList.add('open');
  }
  // Switch to the right tab
  const sectionMap = { orders: 'orders', menus: 'menus', schedule: 'schedule', reviews: 'reviews' };
  const tabName = sectionMap[section];
  if (tabName) {
    document.querySelectorAll('.emp-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.emp-nav-btn').forEach(b => b.classList.remove('active'));
    const sec = document.getElementById('emp-' + tabName);
    if (sec) sec.classList.add('active');
    if (tabName === 'orders') empRenderOrders();
    if (tabName === 'menus')  empRenderMenus();
    if (tabName === 'schedule') empRenderSchedule();
    if (tabName === 'reviews')  empRenderReviews();
  }
}

// â”€â”€ Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admRenderDashboard() {
  noSqlOrdersDB._init();
  const all = noSqlOrdersDB.findAll();
  const totalRevenue = all.filter(o => ['completed','delivered'].includes(o.status)).reduce((s, o) => s + (o.total || 0), 0);
  const activeEmps = employeeAccounts.filter(e => e.active).length;

  document.getElementById('admStatsRow').innerHTML = `
    <div class="emp-stat-card"><div class="emp-stat-num">${all.length}</div><div class="emp-stat-label">Commandes totales</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#ef5350">${employeeAccounts.length}</div><div class="emp-stat-label">Comptes employÃ©s</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#66bb6a">${activeEmps}</div><div class="emp-stat-label">EmployÃ©s actifs</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="font-size:1.3rem">${totalRevenue.toLocaleString('fr-FR',{minimumFractionDigits:0})} â‚¬</div><div class="emp-stat-label">CA rÃ©alisÃ©</div></div>
  `;

  document.getElementById('admDashEmployees').innerHTML = employeeAccounts.map(e => `
    <div class="adm-emp-card ${!e.active ? 'adm-emp-disabled' : ''}" style="padding:.8rem 1rem;margin-bottom:.5rem">
      <div class="adm-emp-avatar" style="width:36px;height:36px;font-size:.9rem">${(e.prenom[0]+e.nom[0]).toUpperCase()}</div>
      <div class="adm-emp-info">
        <div class="adm-emp-name" style="font-size:.84rem">${e.prenom} ${e.nom}</div>
        <div class="adm-emp-email">${e.email}</div>
      </div>
      <span class="emp-status ${e.active ? 'adm-badge-active' : 'adm-badge-disabled'}" style="font-size:.62rem">${e.active ? 'Actif' : 'DÃ©sactivÃ©'}</span>
    </div>`).join('');

  const recentOrders = all.slice(-5).reverse();
  document.getElementById('admDashOrders').innerHTML = recentOrders.map(o => {
    const s = EMP_STATUS_MAP[o.status] || EMP_STATUS_MAP.pending;
    return `<div style="background:#161616;border-radius:4px;padding:.7rem .9rem;margin-bottom:.4rem;display:flex;align-items:center;gap:.8rem">
      <span class="emp-status ${s.cls}" style="font-size:.62rem;white-space:nowrap">${s.icon} ${s.label}</span>
      <div style="flex:1;min-width:0"><div style="font-size:.8rem;font-weight:600;color:white;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${o.menu}</div><div style="font-size:.7rem;color:rgba(255,255,255,.3)">${o.clientName || 'â€”'} Â· ${o.event}</div></div>
      <div style="font-size:.8rem;color:var(--gold);font-weight:600;white-space:nowrap">${(o.total||0).toLocaleString('fr-FR')} â‚¬</div>
    </div>`;
  }).join('');
}

// â”€â”€ Employees â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admRenderEmployees() {
  const container = document.getElementById('admEmployeeList');
  if (employeeAccounts.length === 0) {
    container.innerHTML = '<div style="color:rgba(255,255,255,.3);padding:2rem;text-align:center">Aucun compte employÃ© crÃ©Ã©.</div>';
    return;
  }
  container.innerHTML = employeeAccounts.map(e => `
    <div class="adm-emp-card ${!e.active ? 'adm-emp-disabled' : ''}">
      <div class="adm-emp-avatar">${(e.prenom[0]+e.nom[0]).toUpperCase()}</div>
      <div class="adm-emp-info">
        <div class="adm-emp-name">${e.prenom} ${e.nom} <span class="emp-status ${e.active ? 'adm-badge-active' : 'adm-badge-disabled'}" style="font-size:.6rem;margin-left:.4rem">${e.active ? 'Actif' : 'DÃ©sactivÃ©'}</span></div>
        <div class="adm-emp-email">${e.email}</div>
        <div class="adm-emp-meta">RÃ´le : ${e.role === 'manager' ? 'Manager' : 'EmployÃ©(e)'} Â· CrÃ©Ã© le ${e.createdAt}</div>
      </div>
      <div class="emp-card-actions">
        ${e.active
          ? `<button class="emp-btn emp-btn-danger emp-btn-sm" onclick="admToggleEmployee('${e.id}', false)">ðŸ”’ DÃ©sactiver</button>`
          : `<button class="emp-btn emp-btn-success emp-btn-sm" onclick="admToggleEmployee('${e.id}', true)">ðŸ”“ RÃ©activer</button>`
        }
        <button class="emp-btn emp-btn-outline emp-btn-sm" onclick="admDeleteEmployee('${e.id}')">ðŸ—‘</button>
      </div>
    </div>`).join('');
}

function admOpenCreateEmployee() {
  document.getElementById('admEmpPrenom').value  = '';
  document.getElementById('admEmpNom').value     = '';
  document.getElementById('admEmpEmail').value   = '';
  document.getElementById('admEmpPassword').value= '';
  document.getElementById('admEmpRole').value    = 'employee';
  document.getElementById('admEmailPreview').style.display = 'none';

  // Live preview on email/prenom input
  ['admEmpPrenom','admEmpNom','admEmpEmail'].forEach(id => {
    document.getElementById(id).addEventListener('input', admUpdateEmailPreview);
  });

  document.getElementById('admEmpModal').classList.add('open');
}

function admUpdateEmailPreview() {
  const prenom = document.getElementById('admEmpPrenom').value.trim();
  const email  = document.getElementById('admEmpEmail').value.trim();
  const box    = document.getElementById('admEmailPreview');
  if (!prenom || !email) { box.style.display = 'none'; return; }
  box.style.display = 'block';
  document.getElementById('admEmailContent').innerHTML =
    `<strong>Ã€ :</strong> ${email}<br>
     <strong>Objet :</strong> Vite &amp; Gourmand â€“ Votre compte employÃ© a Ã©tÃ© crÃ©Ã©<br><br>
     Bonjour ${prenom},<br><br>
     Un compte employÃ© vient d'Ãªtre crÃ©Ã© pour vous sur la plateforme Vite &amp; Gourmand.<br>
     <strong>Identifiant :</strong> ${email}<br>
     <strong>Mot de passe :</strong> <em>Non communiquÃ© par email â€” veuillez contacter l'administrateur.</em><br><br>
     Cordialement,<br>
     L'Ã©quipe Vite &amp; Gourmand`;
}

function admCreateEmployee() {
  const prenom   = document.getElementById('admEmpPrenom').value.trim();
  const nom      = document.getElementById('admEmpNom').value.trim();
  const email    = document.getElementById('admEmpEmail').value.trim();
  const password = document.getElementById('admEmpPassword').value;
  const role     = document.getElementById('admEmpRole').value;

  if (!prenom || !nom || !email || !password) { showToast('Veuillez remplir tous les champs.'); return; }
  if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showToast('Adresse email invalide.'); return; }
  const pwdErr = validatePassword(password);
  if (pwdErr) { showToast(pwdErr); return; }
  if (employeeAccounts.find(e => e.email === email)) { showToast('Un compte avec cet email existe dÃ©jÃ .'); return; }

  const newEmp = {
    id: 'emp-' + String(employeeAccounts.length + 1).padStart(3, '0'),
    prenom, nom, email, password, role, active: true,
    createdAt: new Date().toLocaleDateString('fr-FR'),
  };
  employeeAccounts.push(newEmp);

  admCloseEmpModal();
  admRenderEmployees();
  admRenderDashboard();
  showToast('âœ… Compte crÃ©Ã© pour ' + prenom + ' ' + nom + '. Email de notification envoyÃ© !');
}

function admToggleEmployee(id, active) {
  const e = employeeAccounts.find(x => x.id === id);
  if (!e) return;
  e.active = active;
  admRenderEmployees();
  admRenderDashboard();
  showToast(active ? 'ðŸ”“ Compte rÃ©activÃ© : ' + e.prenom : 'ðŸ”’ Compte dÃ©sactivÃ© : ' + e.prenom);
}

function admDeleteEmployee(id) {
  if (!confirm('Supprimer dÃ©finitivement ce compte employÃ© ?')) return;
  const idx = employeeAccounts.findIndex(x => x.id === id);
  if (idx !== -1) employeeAccounts.splice(idx, 1);
  admRenderEmployees();
  admRenderDashboard();
  showToast('Compte supprimÃ©.');
}

function admCloseEmpModal() { document.getElementById('admEmpModal').classList.remove('open'); }
function admCloseEmpModalOutside(e) { if (e.target === document.getElementById('admEmpModal')) admCloseEmpModal(); }

// â”€â”€ Analytics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admGetFilteredOrders() {
  noSqlOrdersDB._init();
  const period = document.getElementById('admAnalyticsPeriod').value;
  let from = null;
  if (period !== 'all') {
    from = new Date();
    from.setDate(from.getDate() - parseInt(period, 10));
  }
  return from ? noSqlOrdersDB.findByDateRange(from, null) : noSqlOrdersDB.findAll();
}

// Chart.js CDN colors palette
const CHART_COLORS = [
  'rgba(196,154,60,.85)', 'rgba(239,83,80,.8)', 'rgba(100,181,246,.8)',
  'rgba(206,147,216,.8)', 'rgba(129,199,132,.8)', 'rgba(255,183,77,.8)',
  'rgba(77,208,225,.8)',  'rgba(240,98,146,.8)',  'rgba(174,213,129,.8)', 'rgba(255,138,101,.8)'
];

function admRenderAnalytics() {
  const orders = admGetFilteredOrders();
  const chartType = document.getElementById('admChartType').value;

  // Aggregate by menu
  const menuCounts = {};
  orders.forEach(o => {
    if (o.status === 'cancelled') return;
    menuCounts[o.menu] = (menuCounts[o.menu] || 0) + 1;
  });
  const sorted = Object.entries(menuCounts).sort((a, b) => b[1] - a[1]);
  const labels = sorted.map(([k]) => k);
  const data   = sorted.map(([, v]) => v);
  const total  = data.reduce((s, v) => s + v, 0);

  // Destroy old chart
  if (admChartInstance) { admChartInstance.destroy(); admChartInstance = null; }

  const canvas = document.getElementById('admChart');
  const ctx = canvas.getContext('2d');

  const isPie = chartType === 'pie';
  const isHBar = chartType === 'horizontalBar';

  admChartInstance = new Chart(ctx, {
    type: isPie ? 'pie' : 'bar',
    data: {
      labels,
      datasets: [{
        label: 'Commandes',
        data,
        backgroundColor: CHART_COLORS.slice(0, labels.length),
        borderColor: isPie ? 'rgba(10,10,10,.5)' : CHART_COLORS.slice(0, labels.length).map(c => c.replace('.8','1').replace('.85','1')),
        borderWidth: isPie ? 2 : 1,
        borderRadius: isPie ? 0 : 3,
      }]
    },
    options: {
      indexAxis: isHBar ? 'y' : 'x',
      responsive: true,
      plugins: {
        legend: { display: isPie, labels: { color: 'rgba(255,255,255,.6)', font: { family: 'DM Sans' } } },
        tooltip: { callbacks: {
          label: ctx2 => ` ${ctx2.parsed.y ?? ctx2.parsed} commande${(ctx2.parsed.y ?? ctx2.parsed) > 1 ? 's' : ''} (${Math.round(((ctx2.parsed.y ?? ctx2.parsed)/total)*100)}%)`,
        }}
      },
      scales: isPie ? {} : {
        x: { ticks: { color: 'rgba(255,255,255,.45)', maxRotation: isHBar ? 0 : 35, font:{size:11,family:'DM Sans'} }, grid: { color: 'rgba(255,255,255,.05)' } },
        y: { ticks: { color: 'rgba(255,255,255,.45)', font:{size:11,family:'DM Sans'} }, grid: { color: 'rgba(255,255,255,.05)' }, beginAtZero: true },
      }
    }
  });

  // Bar chart legend
  const max = data[0] || 1;
  document.getElementById('admBarChart').innerHTML = sorted.map(([name, count], i) => `
    <div class="adm-bar-row">
      <div class="adm-bar-label" title="${name}">${i+1}. ${name}</div>
      <div class="adm-bar-track"><div class="adm-bar-fill" style="width:${Math.round((count/max)*100)}%;background:${CHART_COLORS[i%CHART_COLORS.length]}"></div></div>
      <div class="adm-bar-count">${count}</div>
    </div>`).join('');
}

// â”€â”€ Revenue â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function admPopulateRevMenus() {
  const sel = document.getElementById('admRevMenu');
  sel.innerHTML = '<option value="">Tous les menus</option>';
  menus.forEach(m => {
    const opt = document.createElement('option');
    opt.value = m.id; opt.textContent = m.name;
    sel.appendChild(opt);
  });
}

function admResetRevFilters() {
  document.getElementById('admRevMenu').value     = '';
  document.getElementById('admRevStatus').value   = '';
  document.getElementById('admRevDateFrom').value = '';
  document.getElementById('admRevDateTo').value   = '';
  admRenderRevenue();
}

function admRenderRevenue() {
  noSqlOrdersDB._init();
  const menuFilter   = document.getElementById('admRevMenu').value;
  const statusFilter = document.getElementById('admRevStatus').value;
  const dateFromStr  = document.getElementById('admRevDateFrom').value;
  const dateToStr    = document.getElementById('admRevDateTo').value;

  const dateFrom = dateFromStr ? new Date(dateFromStr) : null;
  const dateTo   = dateToStr   ? new Date(dateToStr + 'T23:59:59') : null;

  let orders = noSqlOrdersDB.findAll();

  if (statusFilter) orders = orders.filter(o => o.status === statusFilter);
  else              orders = orders.filter(o => !['cancelled','pending'].includes(o.status));
  if (menuFilter)   orders = orders.filter(o => o.menuId == menuFilter);
  if (dateFrom)     orders = orders.filter(o => o._date >= dateFrom);
  if (dateTo)       orders = orders.filter(o => o._date <= dateTo);

  // Aggregate by menu
  const agg = {};
  orders.forEach(o => {
    if (!agg[o.menu]) agg[o.menu] = { count: 0, revenue: 0, persons: 0 };
    agg[o.menu].count++;
    agg[o.menu].revenue += (o.total || 0);
    agg[o.menu].persons += (o.persons || 0);
  });

  const sorted = Object.entries(agg).sort((a, b) => b[1].revenue - a[1].revenue);
  const totalRevenue = sorted.reduce((s, [, v]) => s + v.revenue, 0);
  const totalOrders  = sorted.reduce((s, [, v]) => s + v.count, 0);
  const totalPersons = sorted.reduce((s, [, v]) => s + v.persons, 0);

  document.getElementById('admRevStatsRow').innerHTML = `
    <div class="emp-stat-card"><div class="emp-stat-num">${totalRevenue.toLocaleString('fr-FR',{minimumFractionDigits:0})} â‚¬</div><div class="emp-stat-label">CA total filtrÃ©</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#64b5f6">${totalOrders}</div><div class="emp-stat-label">Commandes incluses</div></div>
    <div class="emp-stat-card"><div class="emp-stat-num" style="color:#66bb6a">${totalPersons}</div><div class="emp-stat-label">Couverts total</div></div>
  `;

  if (sorted.length === 0) {
    document.getElementById('admRevenueTable').innerHTML = '<tr><td colspan="5" style="text-align:center;color:rgba(255,255,255,.3);padding:2rem">Aucune commande dans cette sÃ©lection.</td></tr>';
    return;
  }

  document.getElementById('admRevenueTable').innerHTML = `
    <thead><tr>
      <th>Menu</th><th>Nb commandes</th><th>Couverts</th><th>CA HT</th><th>% du CA</th>
    </tr></thead>
    <tbody>
      ${sorted.map(([name, v]) => `
        <tr>
          <td style="color:white;font-weight:500">${name}</td>
          <td>${v.count}</td>
          <td>${v.persons}</td>
          <td class="adm-rev-total">${v.revenue.toLocaleString('fr-FR',{minimumFractionDigits:2})} â‚¬</td>
          <td>
            <div style="display:flex;align-items:center;gap:.5rem">
              <div style="flex:1;height:6px;background:rgba(255,255,255,.07);border-radius:100px;overflow:hidden">
                <div style="height:100%;width:${Math.round((v.revenue/totalRevenue)*100)}%;background:var(--gold);border-radius:100px"></div>
              </div>
              <span style="font-size:.75rem;color:rgba(255,255,255,.5);width:32px;text-align:right">${Math.round((v.revenue/totalRevenue)*100)}%</span>
            </div>
          </td>
        </tr>`).join('')}
      <tr style="border-top:2px solid rgba(196,154,60,.3)">
        <td style="color:var(--gold);font-weight:700">TOTAL</td>
        <td style="color:var(--gold);font-weight:700">${totalOrders}</td>
        <td style="color:var(--gold);font-weight:700">${totalPersons}</td>
        <td class="adm-rev-total">${totalRevenue.toLocaleString('fr-FR',{minimumFractionDigits:2})} â‚¬</td>
        <td></td>
      </tr>
    </tbody>`;
}

// â”€â”€ Auth patches for admin â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const _origHandleLoginPrev = handleLogin;

handleLogin = function () {
  const email    = document.getElementById('login_email').value.trim();
  const password = document.getElementById('login_password').value;

  if (!email || !password) { showToast('Veuillez remplir tous les champs.'); return; }

  // Admin
  if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
    isLoggedIn = true;
    currentUser = { prenom: 'Admin', nom: '', email, isAdmin: true };
    closeLogin();
    updateNavAuth();
    showToast('Bienvenue Administrateur !');
    if (pendingAction) { pendingAction(); pendingAction = null; }
    return;
  }

  // Sinon on laisse la logique originale faire (employÃ© / client)
  return _origHandleLoginPrev();
};

function updateNavAuth() {
  const btnLogin    = document.getElementById('navConnexion');
  const btnRegister = document.getElementById('navInscrire');
  const btnUser     = document.getElementById('navUser');
  const btnEmp      = document.getElementById('navEmployee');
  const btnAdm      = document.getElementById('navAdmin');

  if (isLoggedIn && currentUser) {
    btnLogin.style.display    = 'none';
    btnRegister.style.display = 'none';

    btnUser.style.display = 'none';
    btnEmp.style.display  = 'none';
    btnAdm.style.display  = 'none';

    if (currentUser.isAdmin) {
      btnAdm.style.display = 'inline-flex';
    } else if (currentUser.isEmployee) {
      btnEmp.style.display = 'inline-flex';
    } else {
      btnUser.style.display = 'flex';
      document.getElementById('navUserName').textContent = currentUser.prenom || '';
    }
  } else {
    btnLogin.style.display    = 'inline-flex';
    btnRegister.style.display = 'inline-flex';
    btnUser.style.display     = 'none';
    btnEmp.style.display      = 'none';
    btnAdm.style.display      = 'none';
  }
}


const _origHandleLogoutAdmin = handleLogout;
function handleLogout() {
  isLoggedIn = false; currentUser = null; cart = [];
  updateCart(); updateNavAuth(); closeDashboard();
  closeEmployeeSpace(); closeAdminSpace();
  showToast('Vous Ãªtes dÃ©connectÃ©(e).');
}

// Load Chart.js if not present
(function loadChartJS() {
  if (typeof Chart !== 'undefined') return;
  const s = document.createElement('script');
  s.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js';
  s.onload = () => { /* ready */ };
  document.head.appendChild(s);
})();


// â”€â”€â”€ CGV â”€â”€â”€
function openCGV(e) {
  e.preventDefault();
  document.getElementById('cgvOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeCGV() {
  document.getElementById('cgvOverlay').classList.remove('open');
  document.body.style.overflow = '';
}
function closeCGVOutside(e) {
  if (e.target === document.getElementById('cgvOverlay')) closeCGV();
}

// â”€â”€â”€ MENTIONS LÃ‰GALES â”€â”€â”€
function openMentions(e) {
  e.preventDefault();
  document.getElementById('mentionsOverlay').classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeMentions() {
  document.getElementById('mentionsOverlay').classList.remove('open');
  document.body.style.overflow = '';
}
function closeMentionsOutside(e) {
  if (e.target === document.getElementById('mentionsOverlay')) closeMentions();
}

// â”€â”€â”€ INIT â”€â”€â”€
document.addEventListener('DOMContentLoaded', () => {
  renderMenus(menus);
  renderReviews();

  // Nav scroll shadow
  window.addEventListener('scroll', () => {
    document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 10);
  });

  // Filters already wired via onchange/oninput in HTML
});

</script>
</body>
</html>
